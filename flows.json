[
    {
        "id": "820881f1dd95ae42",
        "type": "tab",
        "label": "Report",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "a3c57608d925b9e0",
        "type": "tab",
        "label": "egaue test",
        "disabled": true,
        "info": "",
        "env": []
    },
    {
        "id": "73492fdabf88703a",
        "type": "tab",
        "label": "data scrape",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "0df0424932598fd5",
        "type": "tab",
        "label": "egauge meter ajax",
        "disabled": true,
        "info": "",
        "env": []
    },
    {
        "id": "b12a97c9e23a7df8",
        "type": "tab",
        "label": "egauge meter",
        "disabled": true,
        "info": "",
        "env": []
    },
    {
        "id": "266079b93877e06e",
        "type": "tab",
        "label": "Final egauge",
        "disabled": true,
        "info": "",
        "env": []
    },
    {
        "id": "c13a53cc905942bf",
        "type": "tab",
        "label": "GCP_Egauge",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "a54fb0c3c40c3190",
        "type": "tab",
        "label": "Flow 1",
        "disabled": true,
        "info": "",
        "env": []
    },
    {
        "id": "7e607c0a98d5e138",
        "type": "tab",
        "label": "Download csv",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "75028d37abb5aa92",
        "type": "tab",
        "label": "Portal user manual",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "b9b3963f10f4b55a",
        "type": "tab",
        "label": "iGOP",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "0c1b1859b9604edf",
        "type": "tab",
        "label": "plants",
        "disabled": true,
        "info": "",
        "env": []
    },
    {
        "id": "3b83b93404c8b14f",
        "type": "tab",
        "label": "Flow 2",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "9def7eb5ccec2475",
        "type": "tab",
        "label": "Flow 4",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "a2e6272886e0a355",
        "type": "tab",
        "label": "Flow 8",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "7c1a1b3ec858efce",
        "type": "tab",
        "label": "ezee_ben",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "226efa8990661b8c",
        "type": "tab",
        "label": "Flow 3",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "6c057ca0253f7c60",
        "type": "tab",
        "label": "SENEC (Data fetching)",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "f718a3471b76fac6",
        "type": "tab",
        "label": "Foxess",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "17c2d49957000dc0",
        "type": "tab",
        "label": "Flow 5",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "b880533a6a0c82df",
        "type": "tab",
        "label": "Flow 6",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "398f438ada7d94cc",
        "type": "tab",
        "label": "AP_12MW MQTT",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "7bf61b142c5e7182",
        "type": "tab",
        "label": "Flow 7",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "a4e15eb8.7e05b8",
        "type": "influxdb",
        "hostname": "localhost",
        "port": "8086",
        "protocol": "http",
        "database": "my_database",
        "name": "InfluxDB",
        "usetls": false,
        "tls": "",
        "influxdbVersion": "2.0",
        "url": "http://localhost:8087",
        "rejectUnauthorized": false
    },
    {
        "id": "bd932ff2.1cb77",
        "type": "influxdb",
        "hostname": "localhost",
        "port": "8086",
        "protocol": "http",
        "database": "mydb",
        "name": "",
        "usetls": false,
        "tls": "",
        "influxdbVersion": "2.0",
        "url": "http://localhost:8087",
        "rejectUnauthorized": false
    },
    {
        "id": "dd04d92d3d5b3211",
        "type": "influxdb",
        "hostname": "http://34.93.63.75",
        "port": "8086",
        "protocol": "http",
        "database": "database",
        "name": "egauge",
        "usetls": false,
        "tls": "",
        "influxdbVersion": "2.0",
        "url": "http://localhost:8087/",
        "rejectUnauthorized": false
    },
    {
        "id": "74084a2821e07143",
        "type": "influxdb",
        "hostname": "localhost",
        "port": "8086",
        "protocol": "http",
        "database": "history",
        "name": "",
        "usetls": false,
        "tls": "c563e3c6072c32be",
        "influxdbVersion": "1.x",
        "url": "http://localhost:8086",
        "rejectUnauthorized": true
    },
    {
        "id": "c563e3c6072c32be",
        "type": "tls-config",
        "name": "",
        "cert": "",
        "key": "",
        "ca": "",
        "certname": "",
        "keyname": "",
        "caname": "",
        "servername": "",
        "verifyservercert": false,
        "alpnprotocol": ""
    },
    {
        "id": "3bca187f56a227bf",
        "type": "influxdb",
        "hostname": "iplon-pvindia.com",
        "port": "30086",
        "protocol": "http",
        "database": "EDC",
        "name": "",
        "usetls": false,
        "tls": "",
        "influxdbVersion": "1.x",
        "url": "http://localhost:8086",
        "rejectUnauthorized": true
    },
    {
        "id": "705b30eaab2edcd3",
        "type": "influxdb",
        "hostname": "iplon-pvindia.com",
        "port": "30086",
        "protocol": "http",
        "database": "SIRICILLA_30MW",
        "name": "",
        "usetls": false,
        "tls": "",
        "influxdbVersion": "1.x",
        "url": "http://localhost:8086",
        "rejectUnauthorized": true
    },
    {
        "id": "ccc431de9f0d8ff2",
        "type": "influxdb",
        "hostname": "iplon-pvindia.com",
        "port": "30086",
        "protocol": "http",
        "database": "EDC",
        "name": "",
        "usetls": false,
        "tls": "",
        "influxdbVersion": "1.x",
        "url": "http://localhost:8086",
        "rejectUnauthorized": true
    },
    {
        "id": "a26a60a1b0efa0e4",
        "type": "influxdb",
        "hostname": "iplon-pvindia.com",
        "port": "30086",
        "protocol": "http",
        "database": "EDC",
        "name": "",
        "usetls": false,
        "tls": "",
        "influxdbVersion": "1.x",
        "url": "http://localhost:8086",
        "rejectUnauthorized": true
    },
    {
        "id": "7c33df7798517679",
        "type": "influxdb",
        "hostname": "iplon-pvindia.com",
        "port": "30086",
        "protocol": "http",
        "database": "EDC",
        "name": "",
        "usetls": false,
        "tls": "",
        "influxdbVersion": "1.x",
        "url": "http://localhost:8086",
        "rejectUnauthorized": true
    },
    {
        "id": "a1fa8edf964cb6b3",
        "type": "mqtt-broker",
        "name": "",
        "broker": "foxesscloud.com",
        "port": "1883",
        "clientid": "",
        "autoConnect": true,
        "usetls": false,
        "protocolVersion": "4",
        "keepalive": "60",
        "cleansession": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willPayload": "",
        "willMsg": {},
        "userProps": "",
        "sessionExpiry": ""
    },
    {
        "id": "4a6a4ac55c60a4cc",
        "type": "influxdb",
        "hostname": "localhost",
        "port": "8086",
        "protocol": "http",
        "database": "mydb",
        "name": "",
        "usetls": false,
        "tls": "",
        "influxdbVersion": "2.0",
        "url": "https://influx-europe.iplon.co.in/",
        "rejectUnauthorized": false
    },
    {
        "id": "25287a352362ae63",
        "type": "mqtt-broker",
        "name": "",
        "broker": "iplon-pvindia.com",
        "port": "1883",
        "clientid": "",
        "autoConnect": true,
        "usetls": false,
        "protocolVersion": "4",
        "keepalive": "60",
        "cleansession": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willPayload": "",
        "willMsg": {},
        "userProps": "",
        "sessionExpiry": ""
    },
    {
        "id": "5b3dccc565744020",
        "type": "postgresdb",
        "cfgname": "",
        "hostname": "34.100.221.11",
        "port": "5432",
        "db": "postgres",
        "ssl": false
    },
    {
        "id": "f1b5a1b6.543fd8",
        "type": "ui_tab",
        "name": "File Upload",
        "icon": "dashboard",
        "order": 4
    },
    {
        "id": "4178bf61.05d97",
        "type": "ui_group",
        "name": "File upload",
        "tab": "f1b5a1b6.543fd8",
        "order": 4,
        "disp": true,
        "width": "6",
        "collapse": false
    },
    {
        "id": "64e9c3da1f8eb583",
        "type": "ui_base",
        "theme": {
            "name": "theme-light",
            "lightTheme": {
                "default": "#0094CE",
                "baseColor": "#375967",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif",
                "edited": true,
                "reset": false
            },
            "darkTheme": {
                "default": "#097479",
                "baseColor": "#097479",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif",
                "edited": false
            },
            "customTheme": {
                "name": "Untitled Theme 1",
                "default": "#4B7930",
                "baseColor": "#4B7930",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"
            },
            "themeState": {
                "base-color": {
                    "default": "#0094CE",
                    "value": "#375967",
                    "edited": true
                },
                "page-titlebar-backgroundColor": {
                    "value": "#375967",
                    "edited": false
                },
                "page-backgroundColor": {
                    "value": "#fafafa",
                    "edited": false
                },
                "page-sidebar-backgroundColor": {
                    "value": "#333333",
                    "edited": false
                },
                "group-textColor": {
                    "value": "#528499",
                    "edited": false
                },
                "group-borderColor": {
                    "value": "#ffffff",
                    "edited": false
                },
                "group-backgroundColor": {
                    "value": "#ffffff",
                    "edited": false
                },
                "widget-textColor": {
                    "value": "#111111",
                    "edited": false
                },
                "widget-backgroundColor": {
                    "value": "#375967",
                    "edited": false
                },
                "widget-borderColor": {
                    "value": "#ffffff",
                    "edited": false
                },
                "base-font": {
                    "value": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"
                }
            },
            "angularTheme": {
                "primary": "indigo",
                "accents": "blue",
                "warn": "red",
                "background": "grey",
                "palette": "light"
            }
        },
        "site": {
            "name": "Node-RED Dashboard",
            "hideToolbar": "false",
            "allowSwipe": "false",
            "lockMenu": "false",
            "allowTempTheme": "true",
            "dateFormat": "DD/MM/YYYY",
            "sizes": {
                "sx": 68,
                "sy": 68,
                "gx": 6,
                "gy": 6,
                "cx": 26,
                "cy": 6,
                "px": 0,
                "py": 0
            }
        }
    },
    {
        "id": "c93aba308e8054ee",
        "type": "debug",
        "z": "820881f1dd95ae42",
        "name": "debug 95",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1060,
        "y": 120,
        "wires": []
    },
    {
        "id": "6e0a379557740ea1",
        "type": "html-to-pdf",
        "z": "820881f1dd95ae42",
        "name": "",
        "format": "A4",
        "zoom": 100,
        "orientation": "Portrait",
        "width": "",
        "height": "",
        "marginTop": 1,
        "marginLeft": 1,
        "marginBottom": 1,
        "marginRight": 1,
        "marginTopUnits": "cm",
        "marginLeftUnits": "cm",
        "marginBottomUnits": "cm",
        "marginRightUnits": "cm",
        "omitBackground": false,
        "printGraphics": true,
        "x": 410,
        "y": 120,
        "wires": [
            [
                "3e7fe285c48f021c"
            ]
        ]
    },
    {
        "id": "1ca5cfa063b2eeba",
        "type": "template",
        "z": "820881f1dd95ae42",
        "name": "",
        "field": "payload",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "<!DOCTYPE html>\n<html>\n\n<head>\n    <style>\n        * {\n            box-sizing: border-box;\n            margin: 0;\n            font-family: Arial;\n        }\n\n        .main {\n            height: 100%;\n            width: 100%;\n            border: 1px solid black;\n            position: fixed;\n            background-color: #E5E4E2;\n        }\n\n        .side {\n            border: 1px solid black;\n            text-align: center;\n            height: 75%;\n            width: 45%;\n            float: right;\n            margin-top: 50px;\n            margin-right: 70px;\n            background-color: white;\n        }\n\n        .block {\n            border: 1px solid black;\n            height: 50%;\n            width: 90%;\n            margin-top: 15px;\n            margin-left: 15px;\n            background-color: #09035E;\n        }\n\n        .hello {\n            position: fixed;\n            height: auto;\n            padding: 10px 10px 10px 10px;\n        }\n    </style>\n</head>\n\n<body>\n    <div class=\"main\"><img src=\"data:image/png;base64,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\" class=\"hello\" width=\"300\" height=\"150\" >\n        <div class=\"side\">\n            <div class=\"block\"></div>\n            <br /><br /><br />\n            <h2 style=\"color:black;\">Technique_solar</h2>\n            <h2 style=\"color:black;\">5.5MW_27MW_30MW</h2>\n            <br /><br /><br />\n            <h3 style=\"color:black;\">Portal User Manual</h3>\n            <br />\n            <hr style=\"width:90%;height:2px;color:darkblue;background-color:#09035E;margin-left: 15px\">\n            <br /><br /><br /><br />\n            <hr style=\"width:90%;height:15px;color:darkblue;background-color:#09035E;margin-left: 15px\">\n            <br />\n            <h4 style=\"float: right;margin-right: 15px;color:black;\">Nivethika</h4>\n            <h4 style=\"float: left;margin-left:15px;color:black;\">\n                <script>\n                    document.write(new Date().toLocaleDateString()); \n                </script>\n            </h4>\n        </div>\n    </div>\n</body>\n\n</html>",
        "output": "str",
        "x": 220,
        "y": 120,
        "wires": [
            [
                "6e0a379557740ea1"
            ]
        ]
    },
    {
        "id": "3e7fe285c48f021c",
        "type": "file",
        "z": "820881f1dd95ae42",
        "name": "write",
        "filename": "/home/iplon/grafana-generate-pdf-nodejs-main/output/Frontpage.pdf",
        "filenameType": "str",
        "appendNewline": true,
        "createDir": false,
        "overwriteFile": "true",
        "encoding": "none",
        "x": 570,
        "y": 120,
        "wires": [
            [
                "59098c7b2dc98aa4"
            ]
        ]
    },
    {
        "id": "33c146d241e22868",
        "type": "comment",
        "z": "820881f1dd95ae42",
        "name": "Front page",
        "info": "",
        "x": 60,
        "y": 120,
        "wires": []
    },
    {
        "id": "17591f2391493e25",
        "type": "comment",
        "z": "820881f1dd95ae42",
        "name": "Content",
        "info": "",
        "x": 50,
        "y": 240,
        "wires": []
    },
    {
        "id": "b5349b81123edf7a",
        "type": "file in",
        "z": "820881f1dd95ae42",
        "name": "2",
        "filename": "/home/iplon/grafana-generate-pdf-nodejs-main/output/2.png",
        "filenameType": "str",
        "format": "",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 670,
        "y": 300,
        "wires": [
            [
                "a975f8f87051f5c7"
            ]
        ]
    },
    {
        "id": "443bf8080dcef41e",
        "type": "file in",
        "z": "820881f1dd95ae42",
        "name": "3",
        "filename": "/home/iplon/grafana-generate-pdf-nodejs-main/output/3.png",
        "filenameType": "str",
        "format": "",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 670,
        "y": 360,
        "wires": [
            [
                "430c4470dffdacd2"
            ]
        ]
    },
    {
        "id": "a975f8f87051f5c7",
        "type": "base64",
        "z": "820881f1dd95ae42",
        "name": "",
        "action": "str",
        "property": "payload",
        "x": 860,
        "y": 300,
        "wires": [
            [
                "bf6a28ec1175f2ad"
            ]
        ]
    },
    {
        "id": "430c4470dffdacd2",
        "type": "base64",
        "z": "820881f1dd95ae42",
        "name": "",
        "action": "str",
        "property": "payload",
        "x": 860,
        "y": 360,
        "wires": [
            [
                "e88bf88968098303"
            ]
        ]
    },
    {
        "id": "5a5e94b275c69b6e",
        "type": "file in",
        "z": "820881f1dd95ae42",
        "name": "4",
        "filename": "/home/iplon/grafana-generate-pdf-nodejs-main/output/4.png",
        "filenameType": "str",
        "format": "",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 670,
        "y": 420,
        "wires": [
            [
                "7d643243353acf8f"
            ]
        ]
    },
    {
        "id": "f5458df8a0ee2141",
        "type": "file in",
        "z": "820881f1dd95ae42",
        "name": "5",
        "filename": "/home/iplon/grafana-generate-pdf-nodejs-main/output/5.png",
        "filenameType": "str",
        "format": "",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 670,
        "y": 480,
        "wires": [
            [
                "377e89cd8105c7f4"
            ]
        ]
    },
    {
        "id": "7d643243353acf8f",
        "type": "base64",
        "z": "820881f1dd95ae42",
        "name": "",
        "action": "str",
        "property": "payload",
        "x": 860,
        "y": 420,
        "wires": [
            [
                "d11caa08211354d4"
            ]
        ]
    },
    {
        "id": "377e89cd8105c7f4",
        "type": "base64",
        "z": "820881f1dd95ae42",
        "name": "",
        "action": "str",
        "property": "payload",
        "x": 860,
        "y": 480,
        "wires": [
            [
                "e69835e8e7beaef3"
            ]
        ]
    },
    {
        "id": "fd3bec59dd22c59b",
        "type": "exec",
        "z": "820881f1dd95ae42",
        "command": "cd /home/iplon/grafana-generate-pdf-nodejs-main/ && node grafana_screenshot.js \"https://igrafana.iplon.co.in/d/MJtBOCEMz/2-portfolio-dashboard?orgId=6\" Tq_solar:Tq_solar1@ output/2.png",
        "addpay": "",
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "2",
        "x": 490,
        "y": 320,
        "wires": [
            [
                "b5349b81123edf7a"
            ],
            [],
            []
        ]
    },
    {
        "id": "6cf9e4f2ab3e904c",
        "type": "exec",
        "z": "820881f1dd95ae42",
        "command": "cd /home/iplon/grafana-generate-pdf-nodejs-main/ && node grafana_screenshot.js \"https://igrafana.iplon.co.in/d/ScQO69EGz/3-communication-table?orgId=6\" Tq_solar:Tq_solar1@ output/3.png",
        "addpay": "",
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "3",
        "x": 490,
        "y": 380,
        "wires": [
            [
                "443bf8080dcef41e"
            ],
            [],
            []
        ]
    },
    {
        "id": "411b6b8f94524557",
        "type": "exec",
        "z": "820881f1dd95ae42",
        "command": "cd /home/iplon/grafana-generate-pdf-nodejs-main/ && node grafana_screenshot.js \"https://igrafana.iplon.co.in/d/jCN2E5L7k44/4-monthly-yearly-report?orgId=6\" Tq_solar:Tq_solar1@ output/4.png",
        "addpay": "",
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "4",
        "x": 490,
        "y": 440,
        "wires": [
            [
                "5a5e94b275c69b6e"
            ],
            [],
            []
        ]
    },
    {
        "id": "c06ee712290d4bf1",
        "type": "exec",
        "z": "820881f1dd95ae42",
        "command": "cd /home/iplon/grafana-generate-pdf-nodejs-main/ && node grafana_screenshot.js \"https://igrafana.iplon.co.in/d/YHodbNuGkL/5-a-plant-active-power-status?orgId=6\" Tq_solar:Tq_solar1@ output/5.png",
        "addpay": "",
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "5",
        "x": 490,
        "y": 500,
        "wires": [
            [
                "f5458df8a0ee2141"
            ],
            [],
            []
        ]
    },
    {
        "id": "bc88a7b9cc915487",
        "type": "file in",
        "z": "820881f1dd95ae42",
        "name": "6",
        "filename": "/home/iplon/grafana-generate-pdf-nodejs-main/output/6.png",
        "filenameType": "str",
        "format": "",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 670,
        "y": 540,
        "wires": [
            [
                "fcb7009c3f34e5df"
            ]
        ]
    },
    {
        "id": "fcb7009c3f34e5df",
        "type": "base64",
        "z": "820881f1dd95ae42",
        "name": "",
        "action": "str",
        "property": "payload",
        "x": 860,
        "y": 540,
        "wires": [
            [
                "31b3c4455066c3f8"
            ]
        ]
    },
    {
        "id": "5a903f4704980ea3",
        "type": "exec",
        "z": "820881f1dd95ae42",
        "command": "cd /home/iplon/grafana-generate-pdf-nodejs-main/ && node grafana_screenshot.js \"https://igrafana.iplon.co.in/d/YHodbNuGskL/5-b-inverter-active-power-status?orgId=6\" Tq_solar:Tq_solar1@ output/6.png",
        "addpay": "",
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "6",
        "x": 490,
        "y": 560,
        "wires": [
            [
                "bc88a7b9cc915487"
            ],
            [],
            []
        ]
    },
    {
        "id": "9debe84e0ccea828",
        "type": "file in",
        "z": "820881f1dd95ae42",
        "name": "7",
        "filename": "/home/iplon/grafana-generate-pdf-nodejs-main/output/7.png",
        "filenameType": "str",
        "format": "",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 670,
        "y": 600,
        "wires": [
            [
                "d41067c91bb4c05e"
            ]
        ]
    },
    {
        "id": "d41067c91bb4c05e",
        "type": "base64",
        "z": "820881f1dd95ae42",
        "name": "",
        "action": "str",
        "property": "payload",
        "x": 860,
        "y": 600,
        "wires": [
            [
                "16ed8b284c083745"
            ]
        ]
    },
    {
        "id": "b1dd3b7b3866bbf1",
        "type": "exec",
        "z": "820881f1dd95ae42",
        "command": "cd /home/iplon/grafana-generate-pdf-nodejs-main/ && node grafana_screenshot.js \"https://igrafana.iplon.co.in/d/YHodbNuGk22/6-plant-performance-status-screen?orgId=6\" Tq_solar:Tq_solar1@ output/7.png",
        "addpay": "",
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "7",
        "x": 490,
        "y": 620,
        "wires": [
            [
                "9debe84e0ccea828"
            ],
            [],
            []
        ]
    },
    {
        "id": "6f9fe93f11715aa3",
        "type": "file in",
        "z": "820881f1dd95ae42",
        "name": "8",
        "filename": "/home/iplon/grafana-generate-pdf-nodejs-main/output/8.png",
        "filenameType": "str",
        "format": "",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 670,
        "y": 660,
        "wires": [
            [
                "2bda6760bba6749f"
            ]
        ]
    },
    {
        "id": "2bda6760bba6749f",
        "type": "base64",
        "z": "820881f1dd95ae42",
        "name": "",
        "action": "str",
        "property": "payload",
        "x": 860,
        "y": 660,
        "wires": [
            [
                "2f3e6e32f25291eb"
            ]
        ]
    },
    {
        "id": "d4a55108f9b9f6df",
        "type": "exec",
        "z": "820881f1dd95ae42",
        "command": "cd /home/iplon/grafana-generate-pdf-nodejs-main/ && node grafana_screenshot.js \"https://igrafana.iplon.co.in/d/l6edO1xVk/7-inverter-overview?orgId=6\" Tq_solar:Tq_solar1@ output/8.png",
        "addpay": "",
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "8",
        "x": 490,
        "y": 680,
        "wires": [
            [
                "6f9fe93f11715aa3"
            ],
            [],
            []
        ]
    },
    {
        "id": "a6a7030b94f7f9d5",
        "type": "file in",
        "z": "820881f1dd95ae42",
        "name": "1",
        "filename": "/home/iplon/grafana-generate-pdf-nodejs-main/output/1.png",
        "filenameType": "str",
        "format": "",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 670,
        "y": 240,
        "wires": [
            [
                "024ca850bde66f2d"
            ]
        ]
    },
    {
        "id": "024ca850bde66f2d",
        "type": "base64",
        "z": "820881f1dd95ae42",
        "name": "",
        "action": "str",
        "property": "payload",
        "x": 860,
        "y": 240,
        "wires": [
            [
                "6d3a1fc6fdf21a2f"
            ]
        ]
    },
    {
        "id": "feed7130155ef673",
        "type": "exec",
        "z": "820881f1dd95ae42",
        "command": "cd /home/iplon/grafana-generate-pdf-nodejs-main/ && node grafana_screenshot.js \"https://igrafana.iplon.co.in/d/PMgYtLjMz11/1-cms-plant-overview?orgId=6\" Tq_solar:Tq_solar1@ output/1.png",
        "addpay": "",
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "1",
        "x": 490,
        "y": 260,
        "wires": [
            [
                "a6a7030b94f7f9d5"
            ],
            [],
            []
        ]
    },
    {
        "id": "7037496ba051ffe8",
        "type": "file",
        "z": "820881f1dd95ae42",
        "name": "output in PDF",
        "filename": "/home/iplon/grafana-generate-pdf-nodejs-main/output/Tq_solar.pdf",
        "filenameType": "str",
        "appendNewline": true,
        "createDir": true,
        "overwriteFile": "false",
        "encoding": "none",
        "x": 1660,
        "y": 320,
        "wires": [
            [
                "59098c7b2dc98aa4"
            ]
        ]
    },
    {
        "id": "6d3a1fc6fdf21a2f",
        "type": "change",
        "z": "820881f1dd95ae42",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "a1",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1010,
        "y": 240,
        "wires": [
            [
                "b5ba89d952d30453"
            ]
        ]
    },
    {
        "id": "e88bf88968098303",
        "type": "change",
        "z": "820881f1dd95ae42",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "a3",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1010,
        "y": 360,
        "wires": [
            [
                "b5ba89d952d30453"
            ]
        ]
    },
    {
        "id": "b5ba89d952d30453",
        "type": "function",
        "z": "820881f1dd95ae42",
        "name": "combine",
        "func": "context.data = context.data || {};\nswitch (msg.topic) {\n    case \"a1\":\n        context.data.a1 = msg.payload;\n        msg = null;\n        break;\n    case \"a2\":\n        context.data.a2 = msg.payload;\n        msg = null;\n        break;\n    case \"a3\":\n        context.data.a3 = msg.payload;\n        msg = null;\n        break;\n    case \"a4\":\n        context.data.a4 = msg.payload;\n        msg = null;\n        break;\n    case \"a5\":\n        context.data.a5 = msg.payload;\n        msg = null;\n        break;\n    case \"a6\":\n        context.data.a6 = msg.payload;\n        msg = null;\n        break;\n    case \"a7\":\n        context.data.a7 = msg.payload;\n        msg = null;\n        break;\n    case \"a8\":\n        context.data.a8 = msg.payload;\n        msg = null;\n        break;\n    case \"a9\":\n        context.data.a9 = msg.payload;\n        msg = null;\n        break;\n}\nif (context.data.a1 != null && context.data.a2 != null && context.data.a3 != null && context.data.a4 != null && context.data.a5 != null && context.data.a6 != null && context.data.a7 != null && context.data.a8 != null && context.data.a9 != null) {\n    var data_combine = {\n        \"a1\": context.data.a1,\n        \"a2\": context.data.a2,\n        \"a3\": context.data.a3,\n        \"a4\": context.data.a4,\n        \"a5\": context.data.a5,\n        \"a6\": context.data.a6,\n        \"a7\": context.data.a7,\n        \"a8\": context.data.a8,\n        \"a9\": context.data.a9\n    }\n    context.data = null\n    return { payload: data_combine };\n}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1200,
        "y": 320,
        "wires": [
            [
                "1cc30c08ee32d73e"
            ]
        ]
    },
    {
        "id": "d11caa08211354d4",
        "type": "change",
        "z": "820881f1dd95ae42",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "a4",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1010,
        "y": 420,
        "wires": [
            [
                "b5ba89d952d30453"
            ]
        ]
    },
    {
        "id": "e69835e8e7beaef3",
        "type": "change",
        "z": "820881f1dd95ae42",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "a5",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1010,
        "y": 480,
        "wires": [
            [
                "b5ba89d952d30453"
            ]
        ]
    },
    {
        "id": "bf6a28ec1175f2ad",
        "type": "change",
        "z": "820881f1dd95ae42",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "a2",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1010,
        "y": 300,
        "wires": [
            [
                "b5ba89d952d30453"
            ]
        ]
    },
    {
        "id": "6b41c84e6a502839",
        "type": "html-to-pdf",
        "z": "820881f1dd95ae42",
        "name": "",
        "format": "A4",
        "zoom": 100,
        "orientation": "Portrait",
        "width": "",
        "height": "",
        "marginTop": 1,
        "marginLeft": 1,
        "marginBottom": 1,
        "marginRight": 1,
        "marginTopUnits": "cm",
        "marginLeftUnits": "cm",
        "marginBottomUnits": "cm",
        "marginRightUnits": "cm",
        "omitBackground": false,
        "printGraphics": true,
        "x": 1490,
        "y": 320,
        "wires": [
            [
                "7037496ba051ffe8"
            ]
        ]
    },
    {
        "id": "1cc30c08ee32d73e",
        "type": "template",
        "z": "820881f1dd95ae42",
        "name": "",
        "field": "payload",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "<!DOCTYPE html>\n<html lang=\"en\">\n\n<head>\n    <style type=\"text/css\">\n        @page {\n            size: A4;\n            margin: 0;\n        }\n\n        body {\n            margin: 0;\n        }\n    </style>\n    <style>\n        * {\n            box-sizing: border-box;\n            margin: 0;\n            font-family: Arial;\n        }\n\n        .main {\n            height: 100%;\n            width: 100%;\n        }\n\n        .header {\n            height: 10%;\n            width: 100%;\n            border: 1px solid black;\n            position: fixed;\n        }\n\n        .content {\n            width: 100%;\n            text-align: left;\n            height: 1600px;\n            padding-top: 200px;\n            padding-left: 50px;\n            padding-right: 50px;\n        }\n\n        .date {\n            height: 50%;\n            width: 50%;\n            border: 1px solid black;\n            text-align: center;\n            padding: 10px 10px 10px 10px;\n        }\n\n        .version {\n            height: 50%;\n            width: 50%;\n            border: 1px solid black;\n            text-align: center;\n            padding: 10px 10px 10px 10px;\n        }\n\n        .left {\n            float: left;\n            height: 100%;\n            width: 40%;\n            text-align: center;\n        }\n\n        .logo {\n            float: right;\n            padding: 5px 5px 5px 5px;\n        }\n    </style>\n\n</head>\n\n<body>\n    <script type=\"text/javascript\">\n        window.onload = addPageNumbers;\n            \n                      function addPageNumbers() {\n                        var totalPages = Math.ceil(document.body.scrollHeight / 1123);  //842px A4 pageheight for 72dpi, 1123px A4 pageheight for 96dpi, \n                        for (var i = 1; i <= 7; i++) {\n                          var pageNumberDiv = document.createElement(\"div\");\n                          var pageNumber = document.createTextNode(\"Page \" + i + \" of \" + 7);\n                          pageNumberDiv.style.position = \"absolute\";\n                          pageNumberDiv.style.top = \"calc((\" + i + \" * (297mm - 0.5px)) - 40px)\"; //297mm A4 pageheight; 0,5px unknown needed necessary correction value; additional wanted 40px margin from bottom(own element height included)\n                          pageNumberDiv.style.height = \"16px\";\n                          pageNumberDiv.appendChild(pageNumber);\n                          document.body.insertBefore(pageNumberDiv, document.getElementById(\"content\"));\n                          pageNumberDiv.style.left = \"calc(100% - (\" + pageNumberDiv.offsetWidth + \"px + 20px))\";\n                        }\n                      }\n    </script>\n    <div class=\"main\">\n        <div class=\"header\">\n            <div class=\"logo\">\n                <h3><img src=\"data:image/png;base64,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\" class=\"hello\" width=\"200\" height=\"90\" >\n                </h3>\n            </div>\n            <div class=\"left\">\n                <div class=\"date\">\n                    <h3>\n                        <script>\n                            document.write(new Date().toLocaleDateString());\n                        </script>\n                    </h3>\n                </div>\n                <div class=\"version\">\n                    <h3>version 1.0</h3>\n                </div>\n            </div>\n        </div>\n        <p style=\"page-break-after: always\"></p>\n        <div class=\"content\">\n            <style>\n                table,\n                th,\n                td {\n                    text-align: center;\n                    border: 1px solid black;\n                }\n            </style>\n            <h2>VERSION HISTORY</h2>\n            <br />\n            <table style=\"width:100%\">\n                <tr>\n                    <th>VERSION</th>\n                    <th>IMPLEMENTED BY</th>\n                    <th>REVISION DATE</th>\n                    <th>REASON</th>\n                </tr>\n                <tr>\n                    <td>1.0</td>\n                    <td>Nivethika</td>\n                    <td>\n                        <script>\n                            document.write(new Date().toLocaleDateString()); \n                        </script>\n                    </td>\n                    <td>REPORT</td>\n                </tr>\n            </table>\n            <p style=\"page-break-after: always\"></p>\n            <br /></br /><br /><br /><br /><br /><br /><br />\n            <h2>Table of Contents</h2>\n            <br /><br />\n            <table style=\"width:100%\">\n                <tr>\n                    <th>S.NO</th>\n                    <th>TITLE</th>\n                    <th>PAGE NO</th>\n                </tr>\n                <tr>\n                    <td>01</td>\n                    <td style=\"text-align:left\">Aim</td>\n                    <td>3</td>\n                </tr>\n                <tr>\n                    <td>02</td>\n                    <td style=\"text-align:left\">Summary</td>\n                    <td>3</td>\n                </tr>\n                <tr>\n                    <td>03</td>\n                    <td style=\"text-align:left\">Navigation & Visualization</td>\n                    <td>3</td>\n                </tr>\n                <tr>\n                    <td>04</td>\n                    <td style=\"text-align:left\">CMS Plant Overview </td>\n                    <td>4</td>\n                </tr>\n                <tr>\n                    <td>05</td>\n                    <td style=\"text-align:left\">Portolio Dashboard</td>\n                    <td>4</td>\n                </tr>\n                <tr>\n                    <td>06</td>\n                    <td style=\"text-align:left\">Communication Table</td>\n                    <td>5</td>\n                </tr>\n                <tr>\n                    <td>07</td>\n                    <td style=\"text-align:left\">Monthly/Yearly Report</td>\n                    <td>5</td>\n                </tr>\n                <tr>\n                    <td>08</td>\n                    <td style=\"text-align:left\">a.Plant Active Power status</td>\n                    <td>6</td>\n                </tr>\n                <tr>\n                    <td>09</td>\n                    <td style=\"text-align:left\">b.Inverter Active Power satuts</td>\n                    <td>6</td>\n                </tr>\n                <tr>\n                    <td>10</td>\n                    <td style=\"text-align:left\">Plant perforamance status screen</td>\n                    <td>7</td>\n                </tr>\n                <tr>\n                    <td>11</td>\n                    <td style=\"text-align:left\">Inverter overview</td>\n                    <td>7</td>\n                </tr>\n                <tr>\n                    <td>12</td>\n                    <td style=\"text-align:left\">Overall Genertion Report</td>\n                    <td>8</td>\n                </tr>\n                </tr>\n            </table>\n            <p style=\"page-break-after: always\"></p>\n            <br /></br /><br /><br /><br /><br /><br /><br />\n            <h3>01. Aim</h3>\n            <br />\n            <p>This document gives an overview of iPLON IoT 6.0 SCADA navigation and visualization for 50 MW solar PV\n                power plant.</p>\n            <br />\n            <h3>2. Summary</h3>\n            <br />\n            <p>Overview of all SCADA screens along with Visualization of HMI screens like Inverter Rooms, Control Rooms,\n                and Weather station etc. Visualizing the real time data on all the available screens with HMI interface.\n                The Screens are flexible and it is developed according to the requirement from customer.</p>\n            <br />\n            <h3>3. Navigation & Visualization</h3>\n            <br />\n            <p>Background color for all screens: Black. In the top of Plant Overview Screen, navigation buttons to all\n                the folders like Plant Overview, SLD, PV block, Plant Generation, Trends, Energy meter, Reports, Alarms,\n                Power control, Plant DI & DO and Inverter overview is given. Once click on the folder it will be\n                navigating to the respective dashboards under that folder shown in fig below. Also in the top line,\n                Screen selection, Share Dashboard, Date selection & Refresh for each 1 min are displayed.</p>\n            <br />\n            <h3>4.CMS  Plant Overview </h3>\n            <br />\n            <p>CMS Plant Overview screen shows the Installed capacity of the plant, and location. It also shows the current\n                date and time in IST and the performance ratio displayed in the meter. The plant data are shows as total\n                energy generation from the date of commissioning, energy yield today and yesterday with solar radiation,\n                Ambient Temperature & Peak power.\n                <br />\n            Also it shows the plant details in left corner with version. All the parameters are displayed in such a manner that\n                <br />\n            DC instantaneous value  Light Green colour & DC Cumulative value  Dark Green.\n                <br />\n            AC instantaneous value  Light Orange color & AC Cumulative value  Dark Green.\n            </p>\n            <br />\n            <div style=\"text-align: center;\">\n                <img src=\"data:image/jpeg;base64,{{{payload.a1}}}\"width=\"600\" height=\"300\">\n            </div>\n            <br />\n            <p style=\"page-break-after: always\"></p>\n            <br /></br /><br /><br /><br /><br /><br /><br />\n            <h3>5. Portfolio Dashboard</h3>\n            <br />\n            <p>Click on the Navigation Energy meter overviewprovided on right top corner of the Home screen. Under\n                this Energy meter readings are displayed. This screen shows the Active Power, EAE, EAE DAY values of all\n                blocks (From B01 to B13) and for Control rooms.</p>\n            <br />\n            <div style=\"text-align: center;\">\n                <img src=\"data:image/jpeg;base64,{{{payload.a2}}}\"width=\"600\" height=\"300\">\n            </div>\n            <br />\n            <h3>6. Communication Table</h3>\n            <br />\n            <p>This screen shows the DC Power(kW), Active power(kW), Reactive Power(kVAR), Energy Day(MWh),Temperature\n                in Deg C & real time PR (%) of each inverter of all blocks (From B01 to B13).</p>\n            <br />\n            <div style=\"text-align: center;\">\n                <img src=\"data:image/jpeg;base64,{{{payload.a3}}}\"width=\"600\" height=\"300\">\n            </div>\n            <br />\n            <p style=\"page-break-after: always\"></p>\n            <br /></br /><br /><br /><br /><br /><br /><br />\n            <h3>7. Monthly/Yearly Report</h3>\n            <br />\n            <p>This screen shows complete plant structure of a Plot. It represents the energy flow from solar PV to\n                Blocks and there to control room and to the feeder. SLD gives the clear picture of the system with\n                energy in each stage</p>\n            <br />\n            <div style=\"text-align: center;\">\n                <img src=\"data:image/jpeg;base64,{{{payload.a4}}}\"width=\"600\" height=\"300\">\n            </div>\n            <br />\n            <h3>8. a.Plant Active Power</h3>\n            <br />\n            <p>This screen shows the current generation of each Block(B01-B08,B10-B13), Energy export per day and\n                cumulative,Performance ration and capacity utilisation factor.</p>\n            <br />\n            <div style=\"text-align: center;\">\n                <img src=\"data:image/jpeg;base64,{{{payload.a5}}}\"width=\"600\" height=\"300\">\n            </div>\n            <br />\n            <p style=\"page-break-after: always\"></p>\n            <br /></br /><br /><br /><br /><br /><br /><br />\n            <h3>8. b.Inverter Active POwer status</h3>\n            <br />\n            <p>This screen shows the current generation of Block-09, Energy export per day and cumulative,Performance\n                ration and capacity utilisation factor.</p>\n            <br />\n            <div style=\"text-align: center;\">\n                <img src=\"data:image/jpeg;base64,{{{payload.a6}}}\"width=\"600\" height=\"300\">\n            </div>\n            <br />\n            <h3>9. Plant Performanace status screen</h3>\n            <br />\n            <p>The Report dashboard has below reports which comprises of 1 min, 15 min, day, monthly & yearly reports\n                and can be extracted as excel.\n                <br />\n            -- Block Per Min Report\n                <br />\n            -- Incomer/Outgoing Feeder MFM Report\n                <br />\n            -- Monthly Report\n                <br />\n            -- WMS One Min Report\n                <br />\n            -- Plant Generation Report\n                <br />\n            -- DGR Report\n            </p>\n            <br />\n            <div style=\"text-align: center;\">\n                <img src=\"data:image/jpeg;base64,{{{payload.a7}}}\"width=\"600\" height=\"300\">\n            </div>\n            <br />\n            <p style=\"page-break-after: always\"></p>\n            <br /></br /><br /><br /><br /><br /><br /><br />\n            <h3>10. Inverter Overview</h3>\n            <br />\n            <p>This screen shows the Block wise Inverter parameters like active power, generation & Inverter IGBT\n                temeprature and plant level trends in different dashboards.</p>\n            <br />\n            <div style=\"text-align: center;\">\n                <img src=\"data:image/jpeg;base64,{{{payload.a8}}}\"width=\"600\" height=\"300\">\n            </div>\n            <br />\n            <h3>11. Overall Generation Report</h3>\n            <br />\n            <p>This screen shows the Block wise Inverter parameters like active power, generation & Inverter IGBT\n                temperature and plant level trends in different dashboards.</p>\n            <br />\n            <div style=\"text-align: center;\">\n                <img src=\"data:image/jpeg;base64,{{{payload.a9}}}\"width=\"600\" height=\"300\">\n            </div>\n            <br />\n        </div>\n    </div>\n</body>\n\n</html>",
        "output": "str",
        "x": 1340,
        "y": 320,
        "wires": [
            [
                "6b41c84e6a502839"
            ]
        ]
    },
    {
        "id": "31b3c4455066c3f8",
        "type": "change",
        "z": "820881f1dd95ae42",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "a6",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1010,
        "y": 540,
        "wires": [
            [
                "b5ba89d952d30453"
            ]
        ]
    },
    {
        "id": "16ed8b284c083745",
        "type": "change",
        "z": "820881f1dd95ae42",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "a7",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1010,
        "y": 600,
        "wires": [
            [
                "b5ba89d952d30453"
            ]
        ]
    },
    {
        "id": "2f3e6e32f25291eb",
        "type": "change",
        "z": "820881f1dd95ae42",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "a8",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1010,
        "y": 660,
        "wires": [
            [
                "b5ba89d952d30453"
            ]
        ]
    },
    {
        "id": "35a5c8359a7b125a",
        "type": "function",
        "z": "820881f1dd95ae42",
        "name": "merge",
        "func": "const merger = new pdfMergerJs();\n\n(async () => {\n    await merger.add('/home/iplon/grafana-generate-pdf-nodejs-main/output/Frontpage.pdf');  //merge all pages. parameter is the path to file and filename.\n    await merger.add('/home/iplon/grafana-generate-pdf-nodejs-main/output/Tq_solar.pdf');\n\n    await merger.save('/home/iplon/grafana-generate-pdf-nodejs-main/output/CMS Tq_solar.pdf'); //save under given name and reset the internal document\n})();\nreturn msg\n\n\n\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [
            {
                "var": "pdfMergerJs",
                "module": "pdf-merger-js"
            },
            {
                "var": "pdfLib",
                "module": "pdf-lib"
            },
            {
                "var": "path",
                "module": "path"
            }
        ],
        "x": 910,
        "y": 120,
        "wires": [
            [
                "c93aba308e8054ee"
            ]
        ]
    },
    {
        "id": "e67e3c4add4a5643",
        "type": "inject",
        "z": "820881f1dd95ae42",
        "name": "",
        "props": [],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 210,
        "y": 340,
        "wires": [
            [
                "feed7130155ef673",
                "fd3bec59dd22c59b",
                "6cf9e4f2ab3e904c",
                "411b6b8f94524557",
                "fcdecb32f1d76cae",
                "1ca5cfa063b2eeba"
            ]
        ]
    },
    {
        "id": "fcdecb32f1d76cae",
        "type": "delay",
        "z": "820881f1dd95ae42",
        "name": "",
        "pauseType": "delay",
        "timeout": "1",
        "timeoutUnits": "minutes",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 220,
        "y": 520,
        "wires": [
            [
                "5a903f4704980ea3",
                "b1dd3b7b3866bbf1",
                "d4a55108f9b9f6df",
                "c06ee712290d4bf1",
                "5bfd0fbf890d0248"
            ]
        ]
    },
    {
        "id": "5bfd0fbf890d0248",
        "type": "exec",
        "z": "820881f1dd95ae42",
        "command": "cd /home/iplon/grafana-generate-pdf-nodejs-main/ && node grafana_screenshot.js \"https://igrafana.iplon.co.in/d/YuPR71t4wz1/8-overall-generation-report?orgId=6\" Tq_solar:Tq_solar1@ output/9.png",
        "addpay": "",
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "9",
        "x": 490,
        "y": 740,
        "wires": [
            [
                "95bbfabcb6160d09"
            ],
            [],
            []
        ]
    },
    {
        "id": "95bbfabcb6160d09",
        "type": "file in",
        "z": "820881f1dd95ae42",
        "name": "9",
        "filename": "/home/iplon/grafana-generate-pdf-nodejs-main/output/9.png",
        "filenameType": "str",
        "format": "",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 670,
        "y": 720,
        "wires": [
            [
                "098ba1002f393174"
            ]
        ]
    },
    {
        "id": "098ba1002f393174",
        "type": "base64",
        "z": "820881f1dd95ae42",
        "name": "",
        "action": "str",
        "property": "payload",
        "x": 860,
        "y": 720,
        "wires": [
            [
                "85e61678c6c0d165"
            ]
        ]
    },
    {
        "id": "85e61678c6c0d165",
        "type": "change",
        "z": "820881f1dd95ae42",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "a9",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1010,
        "y": 720,
        "wires": [
            [
                "b5ba89d952d30453"
            ]
        ]
    },
    {
        "id": "59098c7b2dc98aa4",
        "type": "delay",
        "z": "820881f1dd95ae42",
        "name": "",
        "pauseType": "delay",
        "timeout": "10",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 740,
        "y": 120,
        "wires": [
            [
                "35a5c8359a7b125a"
            ]
        ]
    },
    {
        "id": "a8c4eeef5e728cc9",
        "type": "inject",
        "z": "a3c57608d925b9e0",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "00 00 * * *",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 190,
        "y": 220,
        "wires": [
            [
                "94fdaed8bf65075c"
            ]
        ]
    },
    {
        "id": "94fdaed8bf65075c",
        "type": "http request",
        "z": "a3c57608d925b9e0",
        "name": "egauge meter API",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://egauge75568.egaug.es/cgi-bin/egauge-show?m&n=10",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 370,
        "y": 220,
        "wires": [
            [
                "f381a0ed9c50af1b"
            ]
        ]
    },
    {
        "id": "736339b61e763886",
        "type": "file",
        "z": "a3c57608d925b9e0",
        "name": "egaugemeter",
        "filename": "/home/iplon/Desktop/poornima/egaugemeter.csv",
        "filenameType": "str",
        "appendNewline": true,
        "createDir": true,
        "overwriteFile": "true",
        "encoding": "none",
        "x": 990,
        "y": 220,
        "wires": [
            [
                "1259333970d8be48"
            ]
        ]
    },
    {
        "id": "5f2646c3b1633a0e",
        "type": "csv",
        "z": "a3c57608d925b9e0",
        "name": "",
        "sep": ",",
        "hdrin": true,
        "hdrout": "once",
        "multi": "mult",
        "ret": "\\n",
        "temp": "",
        "skip": "0",
        "strings": true,
        "include_empty_strings": true,
        "include_null_values": true,
        "x": 850,
        "y": 220,
        "wires": [
            [
                "736339b61e763886"
            ]
        ]
    },
    {
        "id": "1259333970d8be48",
        "type": "debug",
        "z": "a3c57608d925b9e0",
        "name": "debug 36",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1160,
        "y": 220,
        "wires": []
    },
    {
        "id": "f381a0ed9c50af1b",
        "type": "xml",
        "z": "a3c57608d925b9e0",
        "name": "",
        "property": "payload",
        "attr": "",
        "chr": "",
        "x": 550,
        "y": 220,
        "wires": [
            [
                "18b292afa6bc61c5"
            ]
        ]
    },
    {
        "id": "db3bd1b646b65525",
        "type": "debug",
        "z": "a3c57608d925b9e0",
        "name": "debug 96",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 480,
        "y": 320,
        "wires": []
    },
    {
        "id": "18b292afa6bc61c5",
        "type": "function",
        "z": "a3c57608d925b9e0",
        "name": "function 1",
        "func": "let plantObj\n\nplantObj = []\n\nfor (var i = 0; i <= 10; i++) {\n    var time = msg.payload.group.data[i].time_stamp\n    var t = msg.payload.group.data[i].cname[i].t\n    var c = msg.payload.group.data[i].r[i].c[i]\n\n    var obj = {\n        time,\n        t,\n        c\n    }\n\n    plantObj.push(obj)\n}\n\nmsg.payload = plantObj\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 700,
        "y": 220,
        "wires": [
            [
                "db3bd1b646b65525"
            ]
        ]
    },
    {
        "id": "58b51f98.bbc954",
        "type": "inject",
        "z": "a3c57608d925b9e0",
        "name": "",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{}",
        "payloadType": "json",
        "x": 350,
        "y": 480,
        "wires": [
            [
                "f5533d52.9c8f38"
            ]
        ]
    },
    {
        "id": "f5533d52.9c8f38",
        "type": "http request",
        "z": "a3c57608d925b9e0",
        "name": "",
        "method": "GET",
        "ret": "xml",
        "paytoqs": "ignore",
        "url": "https://egauge75568.egaug.es/616DC/cgi-bin/egauge-show?reg=Total%20Energy%20Generated&start=1682879400&stop=1685557800&title=Total%20Energy%20Generated%20for%20May%202023&t",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "basic",
        "senderr": false,
        "headers": [],
        "x": 510,
        "y": 480,
        "wires": [
            [
                "3cf0357d.cbf0ba"
            ]
        ]
    },
    {
        "id": "3cf0357d.cbf0ba",
        "type": "xml",
        "z": "a3c57608d925b9e0",
        "name": "",
        "property": "payload",
        "attr": "",
        "chr": "",
        "x": 670,
        "y": 480,
        "wires": [
            [
                "5cc4bebd78e56f29"
            ]
        ]
    },
    {
        "id": "d399e10f.c2df8",
        "type": "debug",
        "z": "a3c57608d925b9e0",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1150,
        "y": 480,
        "wires": []
    },
    {
        "id": "7f1d2e98.7caed8",
        "type": "inject",
        "z": "a3c57608d925b9e0",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 240,
        "y": 660,
        "wires": [
            [
                "e290d57a.9dbb"
            ]
        ]
    },
    {
        "id": "e290d57a.9dbb",
        "type": "http request",
        "z": "a3c57608d925b9e0",
        "name": "",
        "method": "GET",
        "ret": "xml",
        "paytoqs": "ignore",
        "url": "https://egauge75568.egaug.es/cgi-bin/egauge-show?m&n=20",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "basic",
        "senderr": false,
        "headers": [],
        "x": 400,
        "y": 660,
        "wires": [
            [
                "cc84d0e8.7f8d78"
            ]
        ]
    },
    {
        "id": "cc84d0e8.7f8d78",
        "type": "xml",
        "z": "a3c57608d925b9e0",
        "name": "",
        "property": "payload",
        "attr": "",
        "chr": "",
        "x": 560,
        "y": 660,
        "wires": [
            [
                "4cf7917b.4bc3f"
            ]
        ]
    },
    {
        "id": "4cf7917b.4bc3f",
        "type": "function",
        "z": "a3c57608d925b9e0",
        "name": "Extract Data",
        "func": "var data = msg.payload;\nvar result = [];\n\ntry {\n    data.rootNode.childNodes.forEach(function (node) {\n        var obj = {};\n        node.childNodes.forEach(function (childNode) {\n            obj[childNode.nodeName] = childNode.textContent;\n        });\n        result.push(obj);\n    });\n    msg.payload = result;\n    return msg;\n} catch (error) {\n    node.error(\"Error parsing XML data: \" + error.message);\n    return null;\n}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 710,
        "y": 660,
        "wires": [
            [
                "87c53a496e43d204"
            ]
        ]
    },
    {
        "id": "eb15ddcb.6ed1c8",
        "type": "file",
        "z": "a3c57608d925b9e0",
        "name": "Write to CSV",
        "filename": "/home/iplon/file.csv",
        "filenameType": "str",
        "appendNewline": true,
        "createDir": false,
        "overwriteFile": "false",
        "encoding": "none",
        "x": 1010,
        "y": 660,
        "wires": [
            [
                "b91b33723d66a48b"
            ]
        ]
    },
    {
        "id": "b91b33723d66a48b",
        "type": "debug",
        "z": "a3c57608d925b9e0",
        "name": "debug 97",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1200,
        "y": 660,
        "wires": []
    },
    {
        "id": "5cc4bebd78e56f29",
        "type": "csv",
        "z": "a3c57608d925b9e0",
        "name": "",
        "sep": ",",
        "hdrin": true,
        "hdrout": "once",
        "multi": "mult",
        "ret": "\\n",
        "temp": "",
        "skip": "0",
        "strings": true,
        "include_empty_strings": true,
        "include_null_values": true,
        "x": 810,
        "y": 480,
        "wires": [
            [
                "760796231adfa955"
            ]
        ]
    },
    {
        "id": "760796231adfa955",
        "type": "file",
        "z": "a3c57608d925b9e0",
        "name": "egaugemeter",
        "filename": "/home/iplon/Desktop/poornima/egaugemeter.csv",
        "filenameType": "str",
        "appendNewline": true,
        "createDir": true,
        "overwriteFile": "true",
        "encoding": "none",
        "x": 970,
        "y": 480,
        "wires": [
            [
                "d399e10f.c2df8"
            ]
        ]
    },
    {
        "id": "511f3691.973764",
        "type": "http in",
        "z": "a3c57608d925b9e0",
        "name": "XML",
        "url": "/egauge75568.egaug.es/cgi-bin/egauge-show?t=900&m=5&n=10",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 330,
        "y": 840,
        "wires": [
            [
                "e5a5d718.d5c1f8"
            ]
        ]
    },
    {
        "id": "e5a5d718.d5c1f8",
        "type": "xml",
        "z": "a3c57608d925b9e0",
        "name": "",
        "property": "payload",
        "attr": "",
        "chr": "",
        "x": 510,
        "y": 840,
        "wires": [
            [
                "cfe26a78.e4957"
            ]
        ]
    },
    {
        "id": "cfe26a78.e4957",
        "type": "function",
        "z": "a3c57608d925b9e0",
        "name": "Convert XML to CSV",
        "func": "var data = msg.payload;\nvar result = [];\n\ndata.rootNode.childNodes.forEach(function(node) {\n  var obj = {};\n  node.childNodes.forEach(function(childNode) {\n    obj[childNode.nodeName] = childNode.textContent;\n  });\n  result.push(obj);\n});\n\nmsg.payload = result;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 700,
        "y": 840,
        "wires": [
            [
                "cfe4b4a4.277ad"
            ]
        ]
    },
    {
        "id": "cfe4b4a4.277ad",
        "type": "csv",
        "z": "a3c57608d925b9e0",
        "name": "",
        "sep": ",",
        "hdrin": "",
        "hdrout": "",
        "multi": "one",
        "ret": "\\n",
        "temp": "",
        "skip": "0",
        "strings": true,
        "include_empty_strings": "",
        "include_null_values": "",
        "x": 870,
        "y": 840,
        "wires": [
            [
                "e59f7c2c.95e3a",
                "cb15ea15d1d7783c"
            ]
        ]
    },
    {
        "id": "e59f7c2c.95e3a",
        "type": "http response",
        "z": "a3c57608d925b9e0",
        "name": "",
        "statusCode": "",
        "headers": {
            "Content-Disposition": "attachment; filename=\"data.csv\""
        },
        "x": 1030,
        "y": 840,
        "wires": []
    },
    {
        "id": "cb15ea15d1d7783c",
        "type": "debug",
        "z": "a3c57608d925b9e0",
        "name": "debug 98",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1020,
        "y": 980,
        "wires": []
    },
    {
        "id": "1624a4bfc02c6378",
        "type": "http in",
        "z": "a3c57608d925b9e0",
        "name": "",
        "url": "/xml-api",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 370,
        "y": 1180,
        "wires": [
            [
                "ee9cc1ac14f6a7a5"
            ]
        ]
    },
    {
        "id": "ee9cc1ac14f6a7a5",
        "type": "xml",
        "z": "a3c57608d925b9e0",
        "name": "",
        "property": "payload",
        "attr": "",
        "chr": "",
        "x": 530,
        "y": 1180,
        "wires": [
            [
                "48b7e465bab96f30"
            ]
        ]
    },
    {
        "id": "48b7e465bab96f30",
        "type": "function",
        "z": "a3c57608d925b9e0",
        "name": "Convert XML to CSV",
        "func": "var data = msg.payload;\nvar result = [];\n\ndata.rootNode.childNodes.forEach(function(node) {\n  var obj = {};\n  node.childNodes.forEach(function(childNode) {\n    obj[childNode.nodeName] = childNode.textContent;\n  });\n  result.push(obj);\n});\n\nmsg.payload = result;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 720,
        "y": 1180,
        "wires": [
            [
                "4af43fc401dbf1ef"
            ]
        ]
    },
    {
        "id": "4af43fc401dbf1ef",
        "type": "csv",
        "z": "a3c57608d925b9e0",
        "name": "",
        "sep": ",",
        "hdrin": "",
        "hdrout": "",
        "multi": "one",
        "ret": "\\n",
        "temp": "",
        "skip": "0",
        "strings": true,
        "include_empty_strings": "",
        "include_null_values": "",
        "x": 890,
        "y": 1180,
        "wires": [
            [
                "3e9ca66d58c49703"
            ]
        ]
    },
    {
        "id": "3e9ca66d58c49703",
        "type": "http response",
        "z": "a3c57608d925b9e0",
        "name": "",
        "statusCode": "",
        "headers": {
            "Content-Disposition": "attachment; filename=\"data.csv\""
        },
        "x": 1050,
        "y": 1180,
        "wires": []
    },
    {
        "id": "87c53a496e43d204",
        "type": "csv",
        "z": "a3c57608d925b9e0",
        "name": "",
        "sep": ",",
        "hdrin": true,
        "hdrout": "",
        "multi": "one",
        "ret": "\\n",
        "temp": "",
        "skip": "0",
        "strings": true,
        "include_empty_strings": true,
        "include_null_values": true,
        "x": 870,
        "y": 660,
        "wires": [
            [
                "eb15ddcb.6ed1c8"
            ]
        ]
    },
    {
        "id": "6ee68ebc92669aa4",
        "type": "http request",
        "z": "a3c57608d925b9e0",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://egauge75568.d.egauge.net/cgi-bin/egauge-show?m&s=14&a&c",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 550,
        "y": 40,
        "wires": [
            [
                "da6a6d50efb902c3"
            ]
        ]
    },
    {
        "id": "965fb349fd6490a3",
        "type": "inject",
        "z": "a3c57608d925b9e0",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 380,
        "y": 40,
        "wires": [
            [
                "6ee68ebc92669aa4"
            ]
        ]
    },
    {
        "id": "cbba4d84.1a8ef8",
        "type": "inject",
        "z": "a3c57608d925b9e0",
        "name": "Object 1",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"name\":\"John\",\"age\":30}",
        "payloadType": "json",
        "x": 360,
        "y": 1300,
        "wires": [
            [
                "a41e0feb833bb021"
            ]
        ]
    },
    {
        "id": "cd938d07.e7a368",
        "type": "inject",
        "z": "a3c57608d925b9e0",
        "name": "Object 2",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"name\":\"Jane\",\"age\":25}",
        "payloadType": "json",
        "x": 360,
        "y": 1360,
        "wires": [
            [
                "ad4403a7.a28c28"
            ]
        ]
    },
    {
        "id": "ad4403a7.a28c28",
        "type": "function",
        "z": "a3c57608d925b9e0",
        "name": "Create Array",
        "func": "if (context.hasOwnProperty('objectsArray')) {\n    context.objectsArray.push(msg.payload);\n} else {\n    context.objectsArray = [msg.payload];\n}\n\nmsg.payload = context.objectsArray;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 570,
        "y": 1330,
        "wires": [
            [
                "61d56a95.8d9868"
            ]
        ]
    },
    {
        "id": "61d56a95.8d9868",
        "type": "debug",
        "z": "a3c57608d925b9e0",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 740,
        "y": 1330,
        "wires": []
    },
    {
        "id": "a41e0feb833bb021",
        "type": "debug",
        "z": "a3c57608d925b9e0",
        "name": "debug 105",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 570,
        "y": 1420,
        "wires": []
    },
    {
        "id": "d61a5a25f1b132a6",
        "type": "csv",
        "z": "a3c57608d925b9e0",
        "name": "Read CSV",
        "sep": ",",
        "hdrin": true,
        "hdrout": "",
        "multi": "one",
        "ret": "\\n",
        "temp": "",
        "skip": "0",
        "strings": true,
        "x": 470,
        "y": 1540,
        "wires": [
            [
                "8e0497e8b94d006d"
            ]
        ]
    },
    {
        "id": "8e0497e8b94d006d",
        "type": "function",
        "z": "a3c57608d925b9e0",
        "name": "Format for InfluxDB",
        "func": "var lines = [];\n\nmsg.payload.forEach(function(row) {\n  var measurement = \"my_measurement\";\n  var tags = \"tag1=value1,tag2=value2\";\n  var fields = \"\";\n  Object.keys(row).forEach(function(key) {\n    if (key != \"timestamp\") { // assuming timestamp is in first column\n      fields += key + \"=\" + row[key] + \",\";\n    }\n  });\n  fields = fields.slice(0, -1); // remove trailing comma\n  var line = measurement + \",\" + tags + \" \" + fields + \" \" + row.timestamp;\n  lines.push(line);\n});\n\nmsg.payload = lines.join(\"\\n\");\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 700,
        "y": 1540,
        "wires": [
            [
                "d6a9c7a3c1ed5b96"
            ]
        ]
    },
    {
        "id": "d6a9c7a3c1ed5b96",
        "type": "influxdb out",
        "z": "a3c57608d925b9e0",
        "influxdb": "bd932ff2.1cb77",
        "name": "Write to InfluxDB",
        "measurement": "my_measurement",
        "precision": "",
        "retentionPolicy": "",
        "x": 930,
        "y": 1540,
        "wires": []
    },
    {
        "id": "afb1f44d43b3fca6",
        "type": "inject",
        "z": "a3c57608d925b9e0",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "timestamp,value1,value22023-05-16T12:00:00Z,10,202023-05-16T12:01:00Z,11,212023-05-16T12:02:00Z,12,222023-05-16T12:03:00Z,13,23",
        "payloadType": "str",
        "x": 330,
        "y": 1540,
        "wires": [
            [
                "d61a5a25f1b132a6"
            ]
        ]
    },
    {
        "id": "7845ef0e77196ee1",
        "type": "function",
        "z": "a3c57608d925b9e0",
        "name": "Datawork",
        "func": "var plantObj = []; // Create an empty array to hold the InfluxDB line protocol objects\n\nfor (var i = 0; i < msg.payload.length; i++) {\n    var dateUTC = new Date(msg.payload[i][\"Date & Time\"]).getTime();\n    var obj = {\n        measurement: \"report\",\n        fields: {\n            value: msg.payload[i][\"Generation [kWh]\"],\n            text: \"0\",\n            qu: \"0\"\n        },\n        tags: {\n            METER: \"egauge75568\",\n            USAGE: msg.payload[i][\"Usage [kWh]\"],\n            GENERATION: msg.payload[i][\"Generation [kWh]\"],\n            SOLAR: msg.payload[i][\"Solar  [kWh]\"]\n        },\n        timestamp: dateUTC\n    };\n    plantObj.push(obj); // Push the InfluxDB line protocol object to the plantObj array\n}\n\nnode.send({ payload: plantObj }); // Send the array as a single message\n\nreturn msg; // End the function node execution\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 120,
        "y": 100,
        "wires": [
            []
        ]
    },
    {
        "id": "cd6d253128381291",
        "type": "function",
        "z": "a3c57608d925b9e0",
        "name": "Transform Data",
        "func": "//var plantObj = [];\n\n//var text = msg.payload\n\n//var dateUTC1 = new Date(text).toISOString().slice(0, 19);\n//var dateUTC = dateUTC1 + 'Z';\n\n//var dateUTC = new Date(msg.payload).getTime();\n\nfor (var i = 0; i < msg.payload.length; i++) {\n    var dateUTC = new Date(msg.payload[i][\"Date & Time\"]).getTime();\n    var obj = {};\n    obj.payload = [{\n        measurement: \"report\",\n        fields: {\n            value: msg.payload[i][\"Generation [kWh]\"],\n            text: \"0\",\n            qu: \"0\"\n        },\n        tags: {\n            METER: \"egauge75568\",\n            USAGE: msg.payload[i][\"Usage [kWh]\"],\n            GENERATION: msg.payload[i][\"Generation [kWh]\"],\n            SOLAR: msg.payload[i][\"Solar  [kWh]\"]\n        },\n        timestamp: dateUTC\n    }];\n    //plantObj.push(obj)\n    node.send(obj);\n}\nreturn null;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 300,
        "y": 120,
        "wires": [
            []
        ]
    },
    {
        "id": "c48702b5.12e6e8",
        "type": "function",
        "z": "a3c57608d925b9e0",
        "name": "Datawork",
        "func": "var plantObj = []; // Create an empty array to hold the InfluxDB line protocol objects\n\nfor (var i = (msg.payload.length-1); i < msg.payload.length; i++) {\n    var dateUTC = new Date(msg.payload[i][\"Date & Time\"]).getTime();\n    var obj = {\n        measurement: \"report\",\n        fields: {\n            value: msg.payload[i][\"Generation [kWh]\"],\n            text: \"0\",\n            qu: \"0\"\n        },\n        tags: {\n            METER: \"egauge75568\",\n            USAGE: msg.payload[i][\"Usage [kWh]\"],\n            GENERATION: msg.payload[i][\"Generation [kWh]\"],\n            SOLAR: msg.payload[i][\"Solar  [kWh]\"]\n        },\n        timestamp: dateUTC\n    };\n    plantObj.push(obj); // Push the InfluxDB line protocol object to the plantObj array\n}\n\nnode.send({ payload: plantObj }); // Send the array as a single message\n\nreturn msg; // End the function node execution\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 540,
        "y": 140,
        "wires": [
            []
        ]
    },
    {
        "id": "b6f1f14b.bf2a4",
        "type": "influxdb out",
        "z": "a3c57608d925b9e0",
        "influxdb": "a4e15eb8.7e05b8",
        "name": "Write to InfluxDB",
        "measurement": "report",
        "precision": "",
        "retentionPolicy": "",
        "database": "",
        "precisionV18FluxV20": "ms",
        "retentionPolicyV18Flux": "",
        "org": "Test",
        "bucket": "meter",
        "x": 990,
        "y": 1840,
        "wires": []
    },
    {
        "id": "576ca545a89cb431",
        "type": "http request",
        "z": "a3c57608d925b9e0",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://egauge75568.d.egauge.net/cgi-bin/egauge-show?m&n=10&a&c",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 390,
        "y": 1660,
        "wires": [
            [
                "4cc9f3b7d6e42f93"
            ]
        ]
    },
    {
        "id": "4cc9f3b7d6e42f93",
        "type": "csv",
        "z": "a3c57608d925b9e0",
        "name": "",
        "sep": ",",
        "hdrin": true,
        "hdrout": "",
        "multi": "mult",
        "ret": "\\n",
        "temp": "",
        "skip": "0",
        "strings": false,
        "include_empty_strings": false,
        "include_null_values": true,
        "x": 550,
        "y": 1660,
        "wires": [
            [
                "a504acfaba982971",
                "b7b8388b8d79b197"
            ]
        ]
    },
    {
        "id": "a504acfaba982971",
        "type": "function",
        "z": "a3c57608d925b9e0",
        "name": "Data",
        "func": "var plantObj = []; // Create an empty array to hold the InfluxDB line protocol objects\n\nfor (var i = 0; i < msg.payload.length; i++) {\n    var dateUTC = new Date(msg.payload[i][\"Date & Time\"]).getTime();\n    var obj = {\n        measurement: \"report\",\n        fields: {\n            value: msg.payload[i][\"Generation [kWh]\"],\n            text: \"0\",\n            qu: \"0\"\n        },\n        tags: {\n            METER: \"egauge75568\",\n            USAGE: msg.payload[i][\"Usage [kWh]\"],\n            GENERATION: msg.payload[i][\"Generation [kWh]\"],\n            SOLAR: msg.payload[i][\"Solar  [kWh]\"]\n        },\n        timestamp: dateUTC\n    };\n    plantObj.push(obj); // Push the InfluxDB line protocol object to the plantObj array\n}\n\nnode.send({ payload: plantObj }); // Send the array as a single message\n\nreturn msg; // End the function node execution\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 730,
        "y": 1660,
        "wires": [
            [
                "0329d07d6bb1013b",
                "79d0c008fe187738"
            ]
        ]
    },
    {
        "id": "79d0c008fe187738",
        "type": "influxdb out",
        "z": "a3c57608d925b9e0",
        "influxdb": "a4e15eb8.7e05b8",
        "name": "Write to InfluxDB",
        "measurement": "report",
        "precision": "",
        "retentionPolicy": "",
        "database": "",
        "precisionV18FluxV20": "ms",
        "retentionPolicyV18Flux": "",
        "org": "Test",
        "bucket": "meter",
        "x": 1010,
        "y": 1660,
        "wires": []
    },
    {
        "id": "6b07817831560589",
        "type": "inject",
        "z": "a3c57608d925b9e0",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 220,
        "y": 1660,
        "wires": [
            [
                "576ca545a89cb431"
            ]
        ]
    },
    {
        "id": "0329d07d6bb1013b",
        "type": "debug",
        "z": "a3c57608d925b9e0",
        "name": "debug 107",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 870,
        "y": 1760,
        "wires": []
    },
    {
        "id": "b7b8388b8d79b197",
        "type": "debug",
        "z": "a3c57608d925b9e0",
        "name": "debug 108",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 610,
        "y": 1760,
        "wires": []
    },
    {
        "id": "c78b231b316f64ac",
        "type": "csv",
        "z": "a3c57608d925b9e0",
        "name": "",
        "sep": ",",
        "hdrin": true,
        "hdrout": "once",
        "multi": "mult",
        "ret": "\\n",
        "temp": "",
        "skip": "0",
        "strings": true,
        "include_empty_strings": true,
        "include_null_values": true,
        "x": 710,
        "y": 40,
        "wires": [
            []
        ]
    },
    {
        "id": "da6a6d50efb902c3",
        "type": "csv",
        "z": "a3c57608d925b9e0",
        "name": "",
        "sep": ",",
        "hdrin": true,
        "hdrout": "once",
        "multi": "mult",
        "ret": "\\n",
        "temp": "",
        "skip": "0",
        "strings": true,
        "include_empty_strings": true,
        "include_null_values": true,
        "x": 710,
        "y": 40,
        "wires": [
            [
                "059de693937fba80"
            ]
        ]
    },
    {
        "id": "059de693937fba80",
        "type": "debug",
        "z": "a3c57608d925b9e0",
        "name": "debug 132",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 770,
        "y": 100,
        "wires": []
    },
    {
        "id": "ce5ef9d9697a1f49",
        "type": "inject",
        "z": "73492fdabf88703a",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 140,
        "y": 20,
        "wires": [
            [
                "f0e16e1fc56efb37"
            ]
        ]
    },
    {
        "id": "f0e16e1fc56efb37",
        "type": "http request",
        "z": "73492fdabf88703a",
        "name": "UV forcaste",
        "method": "GET",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "https://tides4fishing.com/as/india/chennai/forecast/uv-exposure-level",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 310,
        "y": 20,
        "wires": [
            [
                "f1ed4c502738d16c"
            ]
        ]
    },
    {
        "id": "f1ed4c502738d16c",
        "type": "html",
        "z": "73492fdabf88703a",
        "name": "",
        "property": "payload",
        "outproperty": "payload",
        "tag": "div.f_cont",
        "ret": "text",
        "as": "single",
        "x": 480,
        "y": 20,
        "wires": [
            [
                "e95f3da8ed7a9a3d"
            ]
        ]
    },
    {
        "id": "e95f3da8ed7a9a3d",
        "type": "debug",
        "z": "73492fdabf88703a",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 730,
        "y": 20,
        "wires": []
    },
    {
        "id": "f6903c823278471f",
        "type": "inject",
        "z": "73492fdabf88703a",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 140,
        "y": 440,
        "wires": [
            [
                "7093ad191c57e5e6"
            ]
        ]
    },
    {
        "id": "7093ad191c57e5e6",
        "type": "http request",
        "z": "73492fdabf88703a",
        "name": "bitcoin",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://www.worldcoinindex.com/coin/bitcoin",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 270,
        "y": 440,
        "wires": [
            [
                "f1da980ded26074c",
                "63f240b41c7a9b2e"
            ]
        ]
    },
    {
        "id": "63f240b41c7a9b2e",
        "type": "html",
        "z": "73492fdabf88703a",
        "name": "",
        "property": "payload",
        "outproperty": "payload",
        "tag": "div.col-md-3",
        "ret": "text",
        "as": "single",
        "x": 470,
        "y": 520,
        "wires": [
            [
                "59ab6fbdfdf5f98a"
            ]
        ]
    },
    {
        "id": "f1da980ded26074c",
        "type": "html",
        "z": "73492fdabf88703a",
        "name": "",
        "property": "payload",
        "outproperty": "payload",
        "tag": "table.coin-markets-table",
        "ret": "text",
        "as": "single",
        "x": 470,
        "y": 420,
        "wires": [
            [
                "f95fdb516aad95ad"
            ]
        ]
    },
    {
        "id": "59ab6fbdfdf5f98a",
        "type": "debug",
        "z": "73492fdabf88703a",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 710,
        "y": 520,
        "wires": []
    },
    {
        "id": "9944d1252a9d72c7",
        "type": "inject",
        "z": "73492fdabf88703a",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 300,
        "y": 680,
        "wires": [
            [
                "7a88c4081e19511c"
            ]
        ]
    },
    {
        "id": "7a88c4081e19511c",
        "type": "http request",
        "z": "73492fdabf88703a",
        "name": "cae dashboard",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://cea.nic.in/dashboard/?lang=en",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "senderr": false,
        "x": 460,
        "y": 680,
        "wires": [
            [
                "797416938ada2b62"
            ]
        ]
    },
    {
        "id": "797416938ada2b62",
        "type": "html",
        "z": "73492fdabf88703a",
        "name": "",
        "property": "payload",
        "outproperty": "payload",
        "tag": "table.highcharts-data-table-0",
        "ret": "text",
        "as": "single",
        "x": 700,
        "y": 680,
        "wires": [
            [
                "ec526026551d6727"
            ]
        ]
    },
    {
        "id": "ec526026551d6727",
        "type": "debug",
        "z": "73492fdabf88703a",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 930,
        "y": 680,
        "wires": []
    },
    {
        "id": "f95fdb516aad95ad",
        "type": "csv",
        "z": "73492fdabf88703a",
        "name": "",
        "sep": ",",
        "hdrin": "",
        "hdrout": "none",
        "multi": "mult",
        "ret": "\\n",
        "temp": "",
        "skip": "0",
        "strings": true,
        "include_empty_strings": "",
        "include_null_values": "",
        "x": 690,
        "y": 420,
        "wires": [
            [
                "8a56450f921139c7"
            ]
        ]
    },
    {
        "id": "4c6adeaec26b4b79",
        "type": "comment",
        "z": "73492fdabf88703a",
        "name": "data scraping of kongu",
        "info": "",
        "x": 160,
        "y": 120,
        "wires": []
    },
    {
        "id": "8a56450f921139c7",
        "type": "debug",
        "z": "73492fdabf88703a",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 830,
        "y": 420,
        "wires": []
    },
    {
        "id": "88528dc40674a08b",
        "type": "comment",
        "z": "73492fdabf88703a",
        "name": "data scraping from worldcoinindex.com",
        "info": "",
        "x": 230,
        "y": 380,
        "wires": []
    },
    {
        "id": "5ae78923f19dcd9a",
        "type": "inject",
        "z": "73492fdabf88703a",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 140,
        "y": 200,
        "wires": [
            [
                "10d4b6c81444ffed"
            ]
        ]
    },
    {
        "id": "10d4b6c81444ffed",
        "type": "http request",
        "z": "73492fdabf88703a",
        "name": "URL",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://mein-senec.de/installateur/#!customers",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "basic",
        "senderr": false,
        "headers": [],
        "x": 290,
        "y": 200,
        "wires": [
            [
                "1221672edc962f28"
            ]
        ]
    },
    {
        "id": "93487562129b76c6",
        "type": "html",
        "z": "73492fdabf88703a",
        "name": "",
        "property": "payload",
        "outproperty": "payload",
        "tag": "div.v-slot.v-slot-meinsenec-table.v-slot-meinsenec-table-wda",
        "ret": "text",
        "as": "single",
        "x": 620,
        "y": 200,
        "wires": [
            []
        ]
    },
    {
        "id": "708ced9c8cd4bad9",
        "type": "debug",
        "z": "73492fdabf88703a",
        "name": "debug 197",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1130,
        "y": 80,
        "wires": []
    },
    {
        "id": "c6d1598f996fa173",
        "type": "split",
        "z": "73492fdabf88703a",
        "name": "",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": "1",
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 830,
        "y": 80,
        "wires": [
            [
                "30795cfb74f9c778"
            ]
        ]
    },
    {
        "id": "30795cfb74f9c778",
        "type": "function",
        "z": "73492fdabf88703a",
        "name": "function 117",
        "func": "// Assuming msg.payload contains a single line of text\nvar lines = msg.payload.split('\\n');\nvar data = [];\n\nvar company = '';\nvar address = '';\n\nlines.forEach(function (line) {\n    if (line.trim() === '') {\n        if (company !== '' && address !== '') {\n            var obj = {\n                Company: company,\n                Address: address\n            };\n            data.push(obj);\n\n            // Reset company and address for the next entry\n            company = '';\n            address = '';\n        }\n    } else if (line.includes('Contact Address:')) {\n        address = line.replace('Contact Address:', '').trim();\n    } else {\n        company = line.trim();\n    }\n});\n\n// Push the last entry if exists\nif (company !== '' && address !== '') {\n    var obj = {\n        Company: company,\n        Address: address\n    };\n    data.push(obj);\n}\n\nmsg.payload = data;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 970,
        "y": 80,
        "wires": [
            [
                "708ced9c8cd4bad9"
            ]
        ]
    },
    {
        "id": "1221672edc962f28",
        "type": "debug",
        "z": "73492fdabf88703a",
        "name": "debug 198",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 490,
        "y": 240,
        "wires": []
    },
    {
        "id": "898db255dfe6318d",
        "type": "mqtt in",
        "z": "73492fdabf88703a",
        "name": "",
        "topic": "f987f477r95fcj48b9ib80br5e601cf3bc95/realdata/603T80202AKH054/json",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "a1fa8edf964cb6b3",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 300,
        "y": 320,
        "wires": [
            [
                "42ed538e24efdae3"
            ]
        ]
    },
    {
        "id": "42ed538e24efdae3",
        "type": "debug",
        "z": "73492fdabf88703a",
        "name": "debug 200",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 670,
        "y": 320,
        "wires": []
    },
    {
        "id": "14f8472a904e319b",
        "type": "http request",
        "z": "0df0424932598fd5",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://egauge75568.d.egauge.net/cgi-bin/egauge-show?m&n=3&a&c",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 390,
        "y": 140,
        "wires": [
            [
                "67f5a88c.0746f"
            ]
        ]
    },
    {
        "id": "67f5a88c.0746f",
        "type": "csv",
        "z": "0df0424932598fd5",
        "name": "",
        "sep": ",",
        "hdrin": true,
        "hdrout": "",
        "multi": "one",
        "ret": "\\n",
        "temp": "",
        "skip": "0",
        "strings": true,
        "include_empty_strings": false,
        "include_null_values": true,
        "x": 550,
        "y": 140,
        "wires": [
            [
                "d18119ee4f18493f",
                "b9ecaf5cd1f65923"
            ]
        ]
    },
    {
        "id": "d7f647f234685d9d",
        "type": "debug",
        "z": "0df0424932598fd5",
        "name": "debug 104",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 990,
        "y": 260,
        "wires": []
    },
    {
        "id": "b9ecaf5cd1f65923",
        "type": "debug",
        "z": "0df0424932598fd5",
        "name": "debug 106",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 550,
        "y": 260,
        "wires": []
    },
    {
        "id": "7a275ed4b0d6d543",
        "type": "function",
        "z": "0df0424932598fd5",
        "name": "function 2",
        "func": "//var plantObj = []; // Create an empty array to hold the InfluxDB line protocol objects\nfor (var i = 0; i < msg.payload.length; i++) {\n    var dateUTC = new Date(msg.payload[i][\"Date & Time\"]).getTime();\n    var obj = {};\n    obj.payload = [{\n        measurement: \"v\",\n        fields: {\n            value: msg.payload[i][\"Generation [kWh]\"],\n            text: \"0\",\n            qu: \"0\"\n        },\n        tags: {\n            meter_id: \"75568\",\n            plant: \"egauge75568\",\n            device:\"EM\",\n            field: \"EAE\"\n        },\n        timestamp: dateUTC\n    }];\n    node.send(obj);\n}\nreturn null;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 880,
        "y": 140,
        "wires": [
            [
                "d7f647f234685d9d",
                "5f85c4050c6421c4"
            ]
        ]
    },
    {
        "id": "5f85c4050c6421c4",
        "type": "influxdb batch",
        "z": "0df0424932598fd5",
        "influxdb": "bd932ff2.1cb77",
        "precision": "",
        "retentionPolicy": "",
        "name": "",
        "database": "database",
        "precisionV18FluxV20": "s",
        "retentionPolicyV18Flux": "",
        "org": "Test",
        "bucket": "egaugemeter",
        "x": 1190,
        "y": 140,
        "wires": []
    },
    {
        "id": "d18119ee4f18493f",
        "type": "join",
        "z": "0df0424932598fd5",
        "name": "",
        "mode": "auto",
        "build": "object",
        "property": "payload",
        "propertyType": "msg",
        "key": "topic",
        "joiner": "\\n",
        "joinerType": "str",
        "accumulate": true,
        "timeout": "",
        "count": "",
        "reduceRight": false,
        "reduceExp": "",
        "reduceInit": "",
        "reduceInitType": "",
        "reduceFixup": "",
        "x": 710,
        "y": 140,
        "wires": [
            [
                "7a275ed4b0d6d543",
                "bc5f88494e4bf10a"
            ]
        ]
    },
    {
        "id": "bc5f88494e4bf10a",
        "type": "debug",
        "z": "0df0424932598fd5",
        "name": "debug 109",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 770,
        "y": 260,
        "wires": []
    },
    {
        "id": "42b057b45c8ed2c7",
        "type": "cronplus",
        "z": "0df0424932598fd5",
        "name": "",
        "outputField": "payload",
        "timeZone": "",
        "persistDynamic": false,
        "commandResponseMsgOutput": "output1",
        "outputs": 1,
        "options": [
            {
                "name": "schedule1",
                "topic": "topic1",
                "payloadType": "default",
                "payload": "",
                "expressionType": "cron",
                "expression": "0 * * * * * *",
                "location": "",
                "offset": "0",
                "solarType": "all",
                "solarEvents": "sunrise,sunset"
            }
        ],
        "x": 200,
        "y": 140,
        "wires": [
            []
        ]
    },
    {
        "id": "a3e7dd853c843b92",
        "type": "comment",
        "z": "0df0424932598fd5",
        "name": "EAE_DAY Calculation",
        "info": "",
        "x": 220,
        "y": 320,
        "wires": []
    },
    {
        "id": "0d0cac11fd0648bb",
        "type": "function",
        "z": "0df0424932598fd5",
        "name": "cum_edc",
        "func": "var q1 = 'from(bucket: \"egaugemeter\")|> range(start: -1d)|> filter(fn: (r) => r[\"_measurement\"] == \"v\") |>filter(fn: (r) => r[\"plant\"] == \"egauge75568\")|> filter(fn: (r) => r[\"device\"] == \"EM\") |> filter(fn: (r) => r[\"field\"] == \"EAE\")|> filter(fn: (r) => r[\"_field\"] == \"value\")|> aggregateWindow(every: 1d, fn: last, createEmpty: false)|> yield(name: \"EAEMIN\")'\nvar q2 = 'from(bucket: \"egaugemeter\")|> range(start: -1m)  |> filter(fn: (r) => r[\"_measurement\"] == \"v\")  |>filter(fn: (r) => r[\"plant\"] == \"egauge75568\")|> filter(fn: (r) => r[\"device\"] == \"EM\") |> filter(fn: (r) => r[\"field\"] == \"EAE\")|> filter(fn: (r) => r[\"_field\"] == \"value\")|> yield(name: \"EAE\")'\nmsg.query = q1 + q2\nreturn msg;\n \n \n \n ",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 360,
        "y": 400,
        "wires": [
            [
                "375c132f9fa1a712"
            ]
        ]
    },
    {
        "id": "375c132f9fa1a712",
        "type": "influxdb in",
        "z": "0df0424932598fd5",
        "influxdb": "dd04d92d3d5b3211",
        "name": "egauge",
        "query": "",
        "rawOutput": false,
        "precision": "",
        "retentionPolicy": "",
        "org": "Test",
        "x": 540,
        "y": 400,
        "wires": [
            [
                "c50173d8629b0dcf",
                "8b1c86d62dc772da"
            ]
        ]
    },
    {
        "id": "135c3227e05af902",
        "type": "cronplus",
        "z": "0df0424932598fd5",
        "name": "",
        "outputField": "payload",
        "timeZone": "",
        "persistDynamic": false,
        "commandResponseMsgOutput": "output1",
        "outputs": 1,
        "options": [
            {
                "name": "schedule1",
                "topic": "topic1",
                "payloadType": "date",
                "payload": "",
                "expressionType": "cron",
                "expression": "0 * * * * * *",
                "location": "",
                "offset": "0",
                "solarType": "all",
                "solarEvents": "sunrise,sunset"
            }
        ],
        "x": 200,
        "y": 400,
        "wires": [
            []
        ]
    },
    {
        "id": "ca24936ce77b40d0",
        "type": "debug",
        "z": "0df0424932598fd5",
        "name": "debug 111",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 990,
        "y": 520,
        "wires": []
    },
    {
        "id": "8b1c86d62dc772da",
        "type": "function",
        "z": "0df0424932598fd5",
        "name": "function 3",
        "func": "let plantObj\nplantObj = []\n{\n    var time = msg.payload[1]._time;\n    var eaemin = msg.payload[0]._value;\n    var eae = msg.payload[1]._value;\n    if (eae >= eaemin) {\n        var EAE_DAY = eae - eaemin\n    }\n    var obj =\n    {\n        time,\n        eaemin,\n        eae,\n        EAE_DAY\n    }\n    plantObj.push(obj)\n}\nmsg.payload = plantObj\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 740,
        "y": 400,
        "wires": [
            [
                "cafc901d14a49587",
                "6a080212bacacc2b"
            ]
        ]
    },
    {
        "id": "cafc901d14a49587",
        "type": "function",
        "z": "0df0424932598fd5",
        "name": "function 4",
        "func": "{\n    //var dateUTC = new Date(msg.payload[0].time).getTime();\n    var obj = {};\n    obj.payload = [{\n        measurement: \"v\",\n        fields: {\n            value: msg.payload[0].EAE_DAY,\n            text: \"0\",\n            qu: \"0\"\n        },\n        tags: {\n            meter_id: \"75568\",\n            plant: \"egauge75568\",\n            device: \"EM\",\n            field: \"EAE_DAY\"\n        },\n        //timestamp: dateUTC\n    }];\n    node.send(obj);\n}\nreturn null;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 920,
        "y": 400,
        "wires": [
            [
                "ca24936ce77b40d0",
                "b61ff315c35b803f"
            ]
        ]
    },
    {
        "id": "6a080212bacacc2b",
        "type": "debug",
        "z": "0df0424932598fd5",
        "name": "debug 112",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 770,
        "y": 520,
        "wires": []
    },
    {
        "id": "b61ff315c35b803f",
        "type": "influxdb batch",
        "z": "0df0424932598fd5",
        "influxdb": "bd932ff2.1cb77",
        "precision": "",
        "retentionPolicy": "",
        "name": "",
        "database": "database",
        "precisionV18FluxV20": "s",
        "retentionPolicyV18Flux": "",
        "org": "Test",
        "bucket": "egaugemeter",
        "x": 1190,
        "y": 400,
        "wires": []
    },
    {
        "id": "ee2a99c9cad08882",
        "type": "comment",
        "z": "0df0424932598fd5",
        "name": "EAE Data fetch",
        "info": "",
        "x": 200,
        "y": 80,
        "wires": []
    },
    {
        "id": "89a8824d1ce3b86d",
        "type": "template",
        "z": "0df0424932598fd5",
        "name": "EDAY_egauge",
        "field": "payload",
        "fieldType": "msg",
        "format": "python",
        "syntax": "mustache",
        "template": "import sys\nimport os\nimport time\nimport pytz\nimport calendar\nimport datetime\nimport pandas as pd\nfrom datetime import date\nfrom influxdb_client.client.write_api import SYNCHRONOUS, ASYNCHRONOUS\nfrom influxdb_client import InfluxDBClient, Point, WritePrecision, WriteOptions\n\ntoday = date.today()\np = (str(today))\nx = p.split('-')\nuniqueday = int(x[2])\nuniquemonth = int(x[1])\nuniqueyear = int(x[0])\nts = datetime.datetime(uniqueyear,uniquemonth,uniqueday, 00, 00,00).timestamp()\nc = int(ts)\nFrom = (c-19800)\nTo = calendar.timegm(time.gmtime())\n\ninflux_url=\"http://localhost:8087/\"\ninflux_token=\"pNNW_glBJ_PH_Elpft-l85BC570_MLlDJOo69DE5CERDSNovQI5z1GusUVL1qBadlMWRCHirPOWh92wdbk0vtg==\"\norganisation=\"Test\"\nsource_database=\"egaugemeter\"\ndest_database=\"egaugemeter\"\n\nclient = InfluxDBClient(url=influx_url, token=influx_token, org=organisation)\nwrite_api = client.write_api(write_options=SYNCHRONOUS, debug=True)\nquery_api = client.query_api()\n\nplant = \"egauge75568\"\niGate_id = \"75568\"\ndevice = ['EM']\nfield = \"EAE_DAY\"\n\ndef frame_influx_query(source_database, plant, device, field):\n    if source_database and device and field:\n       query = 'from(bucket: \\\"'+source_database+'\\\")  |> range(start: -30m)  |> filter(fn: (r) => r[\"_measurement\"] == \"v\") |> filter(fn: (r) => r[\"plant\"] == \\\"'+plant+'\\\") |> filter(fn: (r) => r[\"device\"] == \\\"'+device+'\\\") |> filter(fn: (r) => r[\"field\"] == \\\"'+field+'\\\") |> filter(fn: (r) => r[\"_field\"] == \"value\") |> yield(name: \"last\")'\n       \n    return query\n\ndef sending(df):\n   Year = int(df['Year'])\n   Month = int(df['Month'])\n   Day = int(df['Day'])\n   Device = str(df['Device'])\n   EAE_DAY = float(df['EAE_DAY'])\n   #print(EAE_DAY)\n   x = Device.split(' ')\n   y = x[4]\n   z = y.split('\\n')\n   Dev = z[0]\n   ts = datetime.datetime(Year,Month,Day, 00, 00,00).timestamp()\n   #ts = (calendar.timegm(Date_IST.timetuple()))\n   ns = int(ts)\n   string = str(ns) + \"000\"\n   liveepoch = time.strftime(\"%Y-%m-%dT%H:%M:%SZ\", time.gmtime(int(string)/1000.0))\n   data = [{\n       \"measurement\":\"report\",\n       \"tags\": {\n           \"plant\" : plant,\n           \"meter_id\": \"75568\",\n           \"device\" : Dev,\n           \"field\": \"EAE_DAY\"\n               },\n       \"time\" : liveepoch,\n       \"fields\": {\n           \"value\" : EAE_DAY\n           }\n       }]\n   print(data)\n   stat = os.system('influx bucket list --host '+influx_url+' --token '+influx_token+' --org '+organisation+' --name '+dest_database+' >> /dev/null')\n   if stat != 0:\n       stat = os.system('influx bucket create --host '+influx_url+' --token '+influx_token+' --org '+organisation+' --name '+dest_database+' >> /dev/null')\n   \n   write_api.write(dest_database, organisation, data)\n\n\nfor i in range(len(device)):\n    points_day = []\n    my_q_str = frame_influx_query(source_database, plant, device[i], field)\n    print(my_q_str)\n    result = query_api.query(query=my_q_str)\n    for table in result:\n        for record in table.records:\n            points_value = record.get_value()\n            points_time = time.strftime(\"%Y-%m-%dT%H:%M:%SZ\", time.gmtime(int(record.get_time().timestamp())))\n    points_day = [{\n        \"time\": points_time,\n        \"last\": points_value\n        }]\n    df = pd.DataFrame(points_day)\n    #print(df)\n    if len(df) != 0:\n        df[\"Date_IST\"] = pd.to_datetime(df[\"time\"]) + pd.DateOffset(hours=5, minutes=30)\n        df.Date_IST = pd.to_datetime(df.Date_IST)\n        #df[\"Date_IST\"] = df[\"Date_IST\"].to_pydatetime()\n        df['day'] = pd.to_datetime(df['Date_IST']).dt.day\n        df['month'] = pd.to_datetime(df['Date_IST']).dt.month\n        df['year'] = pd.to_datetime(df['Date_IST']).dt.year\n        df = df.dropna()\n   \n        Month = df['month'].tolist()\n        Year = df['year'].tolist()\n        Day =  df['day'].tolist()\n        EAE_DAY =  df['last'].tolist()\n        Date_IST =  df['Date_IST'].tolist()\n\n        df = pd.DataFrame({\n        'Month': Month,\n        'Year': Year,\n        'Day': Day,\n        'EAE_DAY': EAE_DAY,\n        'Date_IST': Date_IST,\n        'Device':  device[i]})\n        #print(df)\n        sending(df)",
        "output": "str",
        "x": 400,
        "y": 680,
        "wires": [
            [
                "3557626f737f975c"
            ]
        ]
    },
    {
        "id": "3557626f737f975c",
        "type": "file",
        "z": "0df0424932598fd5",
        "name": "write file",
        "filename": "/home/iplon/EDAY_egauge.py",
        "filenameType": "str",
        "appendNewline": false,
        "createDir": false,
        "overwriteFile": "true",
        "encoding": "none",
        "x": 560,
        "y": 680,
        "wires": [
            [
                "0afad01ae82a101b"
            ]
        ]
    },
    {
        "id": "0afad01ae82a101b",
        "type": "exec",
        "z": "0df0424932598fd5",
        "command": "python3 /home/iplon/EDAY_egauge.py",
        "addpay": "payload",
        "append": "",
        "useSpawn": "true",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "",
        "x": 790,
        "y": 680,
        "wires": [
            [],
            [
                "09375257ddbadef4"
            ],
            []
        ]
    },
    {
        "id": "8cd7d1973e540b9e",
        "type": "inject",
        "z": "0df0424932598fd5",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "300",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 210,
        "y": 680,
        "wires": [
            [
                "89a8824d1ce3b86d"
            ]
        ]
    },
    {
        "id": "75bce75df7df9941",
        "type": "comment",
        "z": "0df0424932598fd5",
        "name": "Daily value",
        "info": "",
        "x": 180,
        "y": 600,
        "wires": []
    },
    {
        "id": "9477e5a47c802e8b",
        "type": "comment",
        "z": "0df0424932598fd5",
        "name": "Monthly value",
        "info": "",
        "x": 190,
        "y": 760,
        "wires": []
    },
    {
        "id": "464067d59f7912b1",
        "type": "template",
        "z": "0df0424932598fd5",
        "name": "EDAY_Month_egauge",
        "field": "payload",
        "fieldType": "msg",
        "format": "python",
        "syntax": "mustache",
        "template": "import sys\nimport os\nimport time\nimport pytz\nimport calendar\nimport datetime\nimport pandas as pd\nfrom datetime import date\nfrom influxdb_client import InfluxDBClient, Point, WritePrecision, WriteOptions\nfrom influxdb_client.client.write_api import SYNCHRONOUS, ASYNCHRONOUS\n\ninflux_url=\"http://localhost:8087/\"\ninflux_token=\"pNNW_glBJ_PH_Elpft-l85BC570_MLlDJOo69DE5CERDSNovQI5z1GusUVL1qBadlMWRCHirPOWh92wdbk0vtg==\"\norganisation=\"Test\"\nsource_database=\"egaugemeter\"\nsource_database_table=\"report\"\ndest_database=\"egaugemeter\"\ndest_database_table=\"report\"\n\nclient = InfluxDBClient(url=influx_url, token=influx_token, org=organisation)\nwrite_api = client.write_api(write_options=SYNCHRONOUS)\nquery_api = client.query_api()\n\n#timestamp = (\"\"\"1640975400000 1767168792000\"\"\")\ntimestamp = (\"\"\"{{payload}}\"\"\")\nb = (timestamp.split())\nstart_time = time.strftime(\"%Y-%m-%dT%H:%M:%SZ\", time.gmtime(int(b[0])/1000.0))\nstop_time = time.strftime(\"%Y-%m-%dT%H:%M:%SZ\", time.gmtime(int(b[1])/1000.0))\n\ndef frame_influx_query(source_database, source_database_table, plant, device, field):\n    if source_database and source_database_table and plant and field:\n        query = ' from(bucket: \\\"'+source_database+'\\\")  |> range(start: '+start_time+', stop: '+stop_time+')  |> filter(fn: (r) => r[\"_measurement\"] == \\\"'+source_database_table+'\\\")  |> filter(fn: (r) => r[\"plant\"] == \\\"'+plant+'\\\")  |> filter(fn: (r) => r[\"device\"] == \\\"'+device+'\\\")  |> filter(fn: (r) => r[\"field\"] == \\\"'+field+'\\\")  |> filter(fn: (r) => r[\"_field\"] == \"value\")  |> yield(name: \"last\")'\n    return query\n\n\nplant = \"egauge75568\"\ndevice = ['EM']\nfield = \"EAE_DAY\"\n\npoints = []\noutvalue = []\noutyear = []\noutmonth = []\noutplant = []\n\nfor i in range(len(device)):\n    my_q_str = frame_influx_query(source_database, source_database_table, plant, device[i], field)\n    #print(my_q_str)\n    result = query_api.query(query=my_q_str)\n    points_day_array=[]\n    for table in result:\n        for record in table.records:\n            points_value = record.get_value()\n            points_time = time.strftime(\"%Y-%m-%dT%H:%M:%SZ\", time.gmtime(int(record.get_time().timestamp())))\n            points_day = {\n            \"time\": points_time,\n            \"last\": points_value\n            }\n            points_day_array.append(points_day)\n    df = pd.DataFrame(points_day_array)\n    #print(df)\n\n    pd.set_option('display.max_columns', None)  \n    pd.set_option('display.max_rows', None)  \n    df.time = pd.to_datetime(df.time)\n    df[\"Date_IST\"] = pd.to_datetime(df[\"time\"]) + pd.DateOffset(hours=5, minutes=30)\n    df['Date'] = pd.to_datetime(df['Date_IST']).dt.date\n    df['Time'] = pd.to_datetime(df['Date_IST']).dt.time\n    df.Date = pd.to_datetime(df.Date)\n    df = df.groupby('Date').sum('last')\n    df = df.groupby(df.index.to_period('m')).cumsum().reset_index()\n    df1 = df.groupby('Date').sum('last')\n    df1 = df1.groupby(df1.index.to_period('y')).cumsum().reset_index()\n    df['month'] = pd.to_datetime(df['Date']).dt.month\n    df['year'] = pd.to_datetime(df['Date']).dt.year\n \n    monthname = df['month'].iloc[0]\n    year = df['year'].iloc[0]   \n    l = len(df)\n\n    #---------------Month Cum Calculation start----------------#\n    for j in range(l):\n        tmp = df['month'].iloc[j]\n        tmpyear = df['year'].iloc[j]\n        if ((monthname != tmp) and (tmpyear == year)):\n            valid = j-1\n            if pd.isnull(df['last'].iloc[valid]) != True:\n                outvalue += [df['last'].iloc[valid]]\n                outyear += [df['year'].iloc[valid]]\n                outmonth += [df['month'].iloc[valid]]\n                outplant += [device[i]]\n            else:\n                if tmp == 1:\n                    tmp = 13\n                k = valid - 1\n                while k < valid:\n                    if ((pd.isnull(df['last'].iloc[k]) == False) and ((tmp-1) == monthname)):\n                        break\n                    k -= 1\n                outvalue += [df['last'].iloc[k]]\n                outyear += [df['year'].iloc[k]]\n                outmonth += [df['month'].iloc[k]]\n                outplant += [device[i]]\n                if tmp == 13:\n                   tmp = 1\n        elif ((monthname != tmp) and (tmpyear != year)): \n            valid = j-1\n            if pd.isnull(df['last'].iloc[valid]) != True:\n                outvalue += [df['last'].iloc[valid]]\n                outyear += [df['year'].iloc[valid]]\n                outmonth += [df['month'].iloc[valid]]\n                outplant += [device[i]]\n            else:\n                if tmp == 1:\n                    tmp = 13\n                k = valid - 1\n                while k < valid:\n                    if ((pd.isnull(df['last'].iloc[k]) == False) and ((tmp-1) == monthname)):\n                        break\n                    k -= 1\n                outvalue += [df['last'].iloc[k]]\n                outyear += [df['year'].iloc[k]]\n                outmonth += [df['month'].iloc[k]]\n                outplant += [device[i]]\n                if tmp == 13:\n                   tmp = 1\n        monthname = tmp \n        year = tmpyear    \n    \n    if ((monthname == tmp) and (tmpyear == year)):\n        count = l-1\n        if pd.isnull(df['last'].iloc[count]) != True:    \t\n            outvalue += [df['last'].iloc[count]]\n            outyear += [df['year'].iloc[count]]\n            outmonth += [df['month'].iloc[count]]\n            outplant += [device[i]]\n        else:\n            m = count - 1\n            while m < count:\n                if ((pd.isnull(df['last'].iloc[m]) == False) and (monthname == tmp)):\n                    break\n                m -= 1\n            outvalue += [df['last'].iloc[m]]\n            outyear += [df['year'].iloc[m]]\n            outmonth += [df['month'].iloc[m]]\n            outplant += [device[i]]\n\nout = [round(num, 2) for num in outvalue]\n\n#------------------------Month Cum calculation End------------------#\n\nnull = df[df['last'].isnull()].index.tolist()\nfor i in range(len(null)):\n    null_date = (df['Date_IST'].iloc[null[i]])\n\nepoch = []\n\nfor v in range(len(outvalue)):\n    #a_date = str(outyear[v]) + \"-\" + str(outmonth[v]) + \"-\" + \"01\" + \"T\" + \"00\" +\":\" +\"00\" + \":\" + \"00Z\n    ts = datetime.datetime(outyear[v],outmonth[v],1, 00, 00,00).timestamp()\n    ns = int(ts)\n    string = str(ns) + \"000\"\n    epoch = time.strftime(\"%Y-%m-%dT%H:%M:%SZ\", time.gmtime(int(string)/1000.0))\n    \n    data = [{\n        \"measurement\": dest_database_table,\n        \"tags\": {\n            \"plant\" : plant,\n            \"device\" : outplant[v],\n           \"meter_id\": \"75568\",\n           \"field\": \"EAE_Month\"\n             },\n        \"time\" : epoch,\n        \"fields\": {\n            \"value\" : out[v]\n            }\n        }]\n    print(data)\n    stat = os.system('influx bucket list --host '+influx_url+' --token '+influx_token+' --org '+organisation+' --name '+dest_database+' >> /dev/null')\n    if stat != 0:\n        stat = os.system('influx bucket create --host '+influx_url+' --token '+influx_token+' --org '+organisation+' --name '+dest_database+' >> /dev/null')\n    \n    write_api.write(dest_database, organisation, data)\n\n\n",
        "output": "str",
        "x": 420,
        "y": 820,
        "wires": [
            [
                "9d1ea501f92d6634"
            ]
        ]
    },
    {
        "id": "9d1ea501f92d6634",
        "type": "file",
        "z": "0df0424932598fd5",
        "name": "write file",
        "filename": "/home/iplon/EDAY_Month_egauge.py",
        "filenameType": "str",
        "appendNewline": false,
        "createDir": false,
        "overwriteFile": "true",
        "encoding": "none",
        "x": 600,
        "y": 820,
        "wires": [
            [
                "5f217e0ea030eea1"
            ]
        ]
    },
    {
        "id": "5f217e0ea030eea1",
        "type": "exec",
        "z": "0df0424932598fd5",
        "command": "python3 /home/iplon/EDAY_Month_egauge.py",
        "addpay": "payload",
        "append": "",
        "useSpawn": "true",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "",
        "x": 860,
        "y": 820,
        "wires": [
            [],
            [
                "343f4394ed30b607"
            ],
            []
        ]
    },
    {
        "id": "56af175358113d97",
        "type": "comment",
        "z": "0df0424932598fd5",
        "name": "Yearly value",
        "info": "",
        "x": 190,
        "y": 920,
        "wires": []
    },
    {
        "id": "14570db171264629",
        "type": "template",
        "z": "0df0424932598fd5",
        "name": "EDAY_Year_egauge",
        "field": "payload",
        "fieldType": "msg",
        "format": "python",
        "syntax": "mustache",
        "template": "import sys\nimport os\nimport time\nimport pytz\nimport calendar\nimport datetime\nimport pandas as pd\nfrom datetime import date\nfrom influxdb_client import InfluxDBClient, Point, WritePrecision, WriteOptions\nfrom influxdb_client.client.write_api import SYNCHRONOUS, ASYNCHRONOUS\n\ninflux_url=\"http://localhost:8087/\"\ninflux_token=\"pNNW_glBJ_PH_Elpft-l85BC570_MLlDJOo69DE5CERDSNovQI5z1GusUVL1qBadlMWRCHirPOWh92wdbk0vtg==\"\norganisation=\"Test\"\nsource_database=\"egaugemeter\"\nsource_database_table=\"report\"\ndest_database=\"egaugemeter\"\ndest_database_table=\"report\"\n\nclient = InfluxDBClient(url=influx_url, token=influx_token, org=organisation)\nwrite_api = client.write_api(write_options=SYNCHRONOUS)\nquery_api = client.query_api()\n\n#timestamp = (\"\"\"1640975400000 1767168792000\"\"\")\ntimestamp = (\"\"\"{{payload}}\"\"\")\nb = (timestamp.split())\nstart_time = time.strftime(\"%Y-%m-%dT%H:%M:%SZ\", time.gmtime(int(b[0])/1000.0))\nstop_time = time.strftime(\"%Y-%m-%dT%H:%M:%SZ\", time.gmtime(int(b[1])/1000.0))\n\ndef frame_influx_query(source_database, source_database_table, plant, device, field):\n    if source_database and source_database_table and plant and device and field:\n        query = ' from(bucket: \\\"'+source_database+'\\\")  |> range(start: '+start_time+', stop: '+stop_time+')  |> filter(fn: (r) => r[\"_measurement\"] == \\\"'+source_database_table+'\\\")  |> filter(fn: (r) => r[\"plant\"] == \\\"'+plant+'\\\")  |> filter(fn: (r) => r[\"device\"] == \\\"'+device+'\\\")  |> filter(fn: (r) => r[\"field\"] == \\\"'+field+'\\\")  |> filter(fn: (r) => r[\"_field\"] == \"value\")  |> yield(name: \"last\")'\n    return query\n\n\nplant = \"egauge75568\"\ndevice = ['EM']\nfield = \"EAE_Month\"\n\npd.set_option('display.max_columns', None)  \npd.set_option('display.max_rows', None) \n\npoints = []\noutvalue = []\noutyear = []\noutplant = []\n\nfor x in range(len(device)):\n    my_q_str = frame_influx_query(source_database, source_database_table, plant, device[x], field)\n    #print(my_q_str)\n    result = query_api.query(query=my_q_str)\n    points_day_array=[]\n    for table in result:\n        for record in table.records:\n            points_value = record.get_value()\n            points_time = time.strftime(\"%Y-%m-%dT%H:%M:%SZ\", time.gmtime(int(record.get_time().timestamp())))\n            points_day = {\n            \"time\": points_time,\n            \"last\": points_value\n            }\n            points_day_array.append(points_day)\n    df = pd.DataFrame(points_day_array)\n    #print(df)\n\n    pd.set_option('display.max_columns', None)  \n    pd.set_option('display.max_rows', None)  \n    df.time = pd.to_datetime(df.time)\n    df[\"Date_IST\"] = pd.to_datetime(df[\"time\"]) + pd.DateOffset(hours=5, minutes=30)\n    df['Cumulative Year'] = df.groupby(df['Date_IST'].dt.year)['last'].cumsum()\n    df['year'] = pd.to_datetime(df['Date_IST']).dt.year\n    year = df['year'].iloc[0]\n    l = len(df)\n    \n    #---------------Month Cum Calculation----------------#\n    for j in range(l):\n        tmpyear = df['year'].iloc[j]\n        if (tmpyear != year):\n            valid = j-1\n            if pd.isnull(df['Cumulative Year'].iloc[valid]) != True:\n                outvalue += [df['Cumulative Year'].iloc[valid]]\n                outyear += [df['year'].iloc[valid]]\n                outplant += [device[x]]\n            else:\n                k = valid - 1\n                while k < valid:\n                    if ((pd.isnull(df['Cumulative Year'].iloc[k]) == False) and ((tmpyear-1) == year)):\n                        break\n                    k -= 1\n                outvalue += [df['Cumulative Year'].iloc[k]]\n                outyear += [df['year'].iloc[k]]\n                outplant += [device[x]]\n                outplant += [device[x]] \n        year = tmpyear\n        \n    if (tmpyear == year):\n        count = l-1\n        if pd.isnull(df['Cumulative Year'].iloc[count]) != True:\n            outvalue += [df['Cumulative Year'].iloc[count]]\n            outyear += [df['year'].iloc[count]]\n            outplant += [device[x]]\n        else:\n            m = count - 1\n            while m < count:\n                if ((pd.isnull(df['Cumulative Year'].iloc[m]) == False) and (year == tmpyear)):\n                    break\n                m -= 1\n            outvalue += [df['Cumulative Year'].iloc[m]]\n            outyear += [df['year'].iloc[m]]\n            outplant += [device[x]]\n\nout = [round(num, 2) for num in outvalue]\n\n#------------------------Month Cum calculation End------------------#\n\nnull = df[df['Cumulative Year'].isnull()].index.tolist()\nfor i in range(len(null)):\n    null_date = (df['Date_IST'].iloc[null[i]])\n\nepoch = []\n\nfor v in range(len(outvalue)):\n    ts = datetime.datetime(outyear[v],1,1, 00, 00,00).timestamp()\n    ns = int(ts)\n    string = str(ns) + \"000\"\n    epoch = time.strftime(\"%Y-%m-%dT%H:%M:%SZ\", time.gmtime(int(string)/1000.0))    \n\n    data = [{\n        \"measurement\": dest_database_table,\n        \"tags\": {\n            \"plant\": plant,\n            \"device\" : outplant[v],\n           \"meter_id\": \"75568\",\n           \"field\": \"EAE_Year\"\n             },\n        \"time\": epoch,\n        \"fields\": {\n            \"value\": out[v]\n            }\n        }]\n    print(data)\n    stat = os.system('influx bucket list --host '+influx_url+' --token '+influx_token+' --org '+organisation+' --name '+dest_database+' >> /dev/null')\n    if stat != 0:\n        stat = os.system('influx bucket create --host '+influx_url+' --token '+influx_token+' --org '+organisation+' --name '+dest_database+' >> /dev/null')\n    \n    write_api.write(dest_database, organisation, data)\n",
        "output": "str",
        "x": 420,
        "y": 980,
        "wires": [
            [
                "4856949f107fbe4d"
            ]
        ]
    },
    {
        "id": "4856949f107fbe4d",
        "type": "file",
        "z": "0df0424932598fd5",
        "name": "write file",
        "filename": "/home/iplon/EDAY_Year_egauge.py",
        "filenameType": "str",
        "appendNewline": false,
        "createDir": false,
        "overwriteFile": "true",
        "encoding": "none",
        "x": 600,
        "y": 980,
        "wires": [
            [
                "400d65eef0453ba9"
            ]
        ]
    },
    {
        "id": "400d65eef0453ba9",
        "type": "exec",
        "z": "0df0424932598fd5",
        "command": "python3 /home/iplon/EDAY_Year_egauge.py",
        "addpay": "payload",
        "append": "",
        "useSpawn": "true",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "",
        "x": 850,
        "y": 980,
        "wires": [
            [],
            [
                "1ee392a10ff64c70"
            ],
            []
        ]
    },
    {
        "id": "e528e0643d06b3e0",
        "type": "inject",
        "z": "0df0424932598fd5",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 200,
        "y": 820,
        "wires": [
            [
                "464067d59f7912b1"
            ]
        ]
    },
    {
        "id": "8c855bac248062d6",
        "type": "inject",
        "z": "0df0424932598fd5",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 200,
        "y": 980,
        "wires": [
            [
                "14570db171264629"
            ]
        ]
    },
    {
        "id": "c50173d8629b0dcf",
        "type": "debug",
        "z": "0df0424932598fd5",
        "name": "debug 113",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 530,
        "y": 520,
        "wires": []
    },
    {
        "id": "09375257ddbadef4",
        "type": "debug",
        "z": "0df0424932598fd5",
        "name": "debug 114",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1050,
        "y": 680,
        "wires": []
    },
    {
        "id": "343f4394ed30b607",
        "type": "debug",
        "z": "0df0424932598fd5",
        "name": "debug 115",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1150,
        "y": 820,
        "wires": []
    },
    {
        "id": "1ee392a10ff64c70",
        "type": "debug",
        "z": "0df0424932598fd5",
        "name": "debug 116",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1130,
        "y": 980,
        "wires": []
    },
    {
        "id": "7fd635680a37e962",
        "type": "http in",
        "z": "0df0424932598fd5",
        "name": "",
        "url": "/egauge",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 370,
        "y": 740,
        "wires": [
            [
                "c6dbe947495e97bc"
            ]
        ]
    },
    {
        "id": "4dfa01e2ee13e8d5",
        "type": "http response",
        "z": "0df0424932598fd5",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 730,
        "y": 760,
        "wires": []
    },
    {
        "id": "c6dbe947495e97bc",
        "type": "template",
        "z": "0df0424932598fd5",
        "name": "",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "{{payload.from}} {{payload.to}}",
        "output": "str",
        "x": 540,
        "y": 760,
        "wires": [
            [
                "4dfa01e2ee13e8d5",
                "464067d59f7912b1",
                "d07427b4523775a1",
                "14570db171264629"
            ]
        ]
    },
    {
        "id": "d07427b4523775a1",
        "type": "debug",
        "z": "0df0424932598fd5",
        "name": "debug 117",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 990,
        "y": 740,
        "wires": []
    },
    {
        "id": "ac87f6a8cc17aedf",
        "type": "http request",
        "z": "b12a97c9e23a7df8",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://egauge75568.d.egauge.net/cgi-bin/egauge-show?m&s=14&a&n=2&c",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 390,
        "y": 700,
        "wires": [
            [
                "521e844c3ca36fc4"
            ]
        ]
    },
    {
        "id": "521e844c3ca36fc4",
        "type": "csv",
        "z": "b12a97c9e23a7df8",
        "name": "",
        "sep": ",",
        "hdrin": true,
        "hdrout": "",
        "multi": "one",
        "ret": "\\n",
        "temp": "",
        "skip": "0",
        "strings": true,
        "include_empty_strings": false,
        "include_null_values": true,
        "x": 550,
        "y": 700,
        "wires": [
            [
                "fa8e9d64fa06657d",
                "11636ff8b8245ead"
            ]
        ]
    },
    {
        "id": "a71742a4822df71c",
        "type": "debug",
        "z": "b12a97c9e23a7df8",
        "name": "debug 118",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 990,
        "y": 820,
        "wires": []
    },
    {
        "id": "11636ff8b8245ead",
        "type": "debug",
        "z": "b12a97c9e23a7df8",
        "name": "debug 119",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 550,
        "y": 820,
        "wires": []
    },
    {
        "id": "23328a10f62dad13",
        "type": "function",
        "z": "b12a97c9e23a7df8",
        "name": "function 5",
        "func": "//var plantObj = []; // Create an empty array to hold the InfluxDB line protocol objects\nfor (var i = 0; i < msg.payload.length; i++) {\n    var dateUTC = new Date(msg.payload[i][\"Date & Time\"]).getTime();\n    var obj = {};\n    obj.payload = [{\n        measurement: \"v\",\n        fields: {\n            value: msg.payload[i][\"Generation [kWh]\"],\n            text: \"0\",\n            qu: \"0\"\n        },\n        tags: {\n            meter_id: \"75568\",\n            plant: \"egauge75568\",\n            device:\"EM\",\n            field: \"EAE\"\n        },\n        timestamp: dateUTC\n    }];\n    node.send(obj);\n}\nreturn null;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 880,
        "y": 700,
        "wires": [
            [
                "a71742a4822df71c",
                "991dd92c8ae7e4ef"
            ]
        ]
    },
    {
        "id": "991dd92c8ae7e4ef",
        "type": "influxdb batch",
        "z": "b12a97c9e23a7df8",
        "influxdb": "bd932ff2.1cb77",
        "precision": "",
        "retentionPolicy": "",
        "name": "",
        "database": "database",
        "precisionV18FluxV20": "s",
        "retentionPolicyV18Flux": "",
        "org": "Test",
        "bucket": "egaugemeter",
        "x": 1190,
        "y": 700,
        "wires": []
    },
    {
        "id": "fa8e9d64fa06657d",
        "type": "join",
        "z": "b12a97c9e23a7df8",
        "name": "",
        "mode": "auto",
        "build": "object",
        "property": "payload",
        "propertyType": "msg",
        "key": "topic",
        "joiner": "\\n",
        "joinerType": "str",
        "accumulate": true,
        "timeout": "",
        "count": "",
        "reduceRight": false,
        "reduceExp": "",
        "reduceInit": "",
        "reduceInitType": "",
        "reduceFixup": "",
        "x": 710,
        "y": 700,
        "wires": [
            [
                "23328a10f62dad13",
                "2f1d8a28e7c62fb8"
            ]
        ]
    },
    {
        "id": "2f1d8a28e7c62fb8",
        "type": "debug",
        "z": "b12a97c9e23a7df8",
        "name": "debug 120",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 770,
        "y": 820,
        "wires": []
    },
    {
        "id": "9574580786e72ed8",
        "type": "cronplus",
        "z": "b12a97c9e23a7df8",
        "name": "",
        "outputField": "payload",
        "timeZone": "",
        "persistDynamic": false,
        "commandResponseMsgOutput": "output1",
        "outputs": 1,
        "options": [
            {
                "name": "schedule1",
                "topic": "topic1",
                "payloadType": "default",
                "payload": "",
                "expressionType": "cron",
                "expression": "0 0 * * *",
                "location": "",
                "offset": "0",
                "solarType": "all",
                "solarEvents": "sunrise,sunset"
            }
        ],
        "x": 200,
        "y": 700,
        "wires": [
            [
                "ac87f6a8cc17aedf"
            ]
        ]
    },
    {
        "id": "0a9da11015ab244b",
        "type": "comment",
        "z": "b12a97c9e23a7df8",
        "name": "EAE_DAY Calculation",
        "info": "",
        "x": 220,
        "y": 1120,
        "wires": []
    },
    {
        "id": "e06b7fd9e223fa00",
        "type": "function",
        "z": "b12a97c9e23a7df8",
        "name": "cum_edc",
        "func": "var q1 = 'from(bucket: \"egaugemeter\")|> range(start: -1d)|> filter(fn: (r) => r[\"_measurement\"] == \"v\") |>filter(fn: (r) => r[\"plant\"] == \"egauge75568\")|> filter(fn: (r) => r[\"device\"] == \"EM\") |> filter(fn: (r) => r[\"field\"] == \"EAE\")|> filter(fn: (r) => r[\"_field\"] == \"value\")|> aggregateWindow(every: 1d, fn: last, createEmpty: false)|> yield(name: \"EAEMIN\")'\nvar q2 = 'from(bucket: \"egaugemeter\")|> range(start: -1m)  |> filter(fn: (r) => r[\"_measurement\"] == \"v\")  |>filter(fn: (r) => r[\"plant\"] == \"egauge75568\")|> filter(fn: (r) => r[\"device\"] == \"EM\") |> filter(fn: (r) => r[\"field\"] == \"EAE\")|> filter(fn: (r) => r[\"_field\"] == \"value\")|> yield(name: \"EAE\")'\nmsg.query = q1 + q2\nreturn msg;\n \n \n \n ",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 360,
        "y": 1200,
        "wires": [
            [
                "c35afa2db86b0614"
            ]
        ]
    },
    {
        "id": "c35afa2db86b0614",
        "type": "influxdb in",
        "z": "b12a97c9e23a7df8",
        "influxdb": "dd04d92d3d5b3211",
        "name": "egauge",
        "query": "",
        "rawOutput": false,
        "precision": "",
        "retentionPolicy": "",
        "org": "Test",
        "x": 540,
        "y": 1200,
        "wires": [
            [
                "8514f610f2112d36",
                "8e5477c7eb74c0cf"
            ]
        ]
    },
    {
        "id": "ed72a6eff65ce9bc",
        "type": "cronplus",
        "z": "b12a97c9e23a7df8",
        "name": "",
        "outputField": "payload",
        "timeZone": "",
        "persistDynamic": false,
        "commandResponseMsgOutput": "output1",
        "outputs": 1,
        "options": [
            {
                "name": "schedule1",
                "topic": "topic1",
                "payloadType": "date",
                "payload": "",
                "expressionType": "cron",
                "expression": "0 * * * * * *",
                "location": "",
                "offset": "0",
                "solarType": "all",
                "solarEvents": "sunrise,sunset"
            }
        ],
        "x": 200,
        "y": 1200,
        "wires": [
            [
                "e06b7fd9e223fa00"
            ]
        ]
    },
    {
        "id": "96f3d777ce857b53",
        "type": "debug",
        "z": "b12a97c9e23a7df8",
        "name": "debug 121",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 990,
        "y": 1320,
        "wires": []
    },
    {
        "id": "8e5477c7eb74c0cf",
        "type": "function",
        "z": "b12a97c9e23a7df8",
        "name": "function 6",
        "func": "let plantObj\nplantObj = []\n{\n    var time = msg.payload[1]._time;\n    var eaemin = msg.payload[0]._value;\n    var eae = msg.payload[1]._value;\n    if (eae >= eaemin) {\n        var EAE_DAY = eae - eaemin\n    }\n    var obj =\n    {\n        time,\n        eaemin,\n        eae,\n        EAE_DAY\n    }\n    plantObj.push(obj)\n}\nmsg.payload = plantObj\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 740,
        "y": 1200,
        "wires": [
            [
                "5a5550f946cf8531",
                "4a445f2485bc6b2f"
            ]
        ]
    },
    {
        "id": "5a5550f946cf8531",
        "type": "function",
        "z": "b12a97c9e23a7df8",
        "name": "function 7",
        "func": "{\n    //var dateUTC = new Date(msg.payload[0].time).getTime();\n    var obj = {};\n    obj.payload = [{\n        measurement: \"v\",\n        fields: {\n            value: msg.payload[0].EAE_DAY,\n            text: \"0\",\n            qu: \"0\"\n        },\n        tags: {\n            meter_id: \"75568\",\n            plant: \"egauge75568\",\n            device: \"EM\",\n            field: \"EAE_DAY\"\n        },\n        //timestamp: dateUTC\n    }];\n    node.send(obj);\n}\nreturn null;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 920,
        "y": 1200,
        "wires": [
            [
                "96f3d777ce857b53",
                "bf5a1813aa0c31e3"
            ]
        ]
    },
    {
        "id": "4a445f2485bc6b2f",
        "type": "debug",
        "z": "b12a97c9e23a7df8",
        "name": "debug 122",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 770,
        "y": 1320,
        "wires": []
    },
    {
        "id": "bf5a1813aa0c31e3",
        "type": "influxdb batch",
        "z": "b12a97c9e23a7df8",
        "influxdb": "bd932ff2.1cb77",
        "precision": "",
        "retentionPolicy": "",
        "name": "",
        "database": "database",
        "precisionV18FluxV20": "s",
        "retentionPolicyV18Flux": "",
        "org": "Test",
        "bucket": "egaugemeter",
        "x": 1190,
        "y": 1200,
        "wires": []
    },
    {
        "id": "df559e1b423dce34",
        "type": "comment",
        "z": "b12a97c9e23a7df8",
        "name": "EAE Data fetch",
        "info": "",
        "x": 200,
        "y": 640,
        "wires": []
    },
    {
        "id": "ccc4c40ae8dd938b",
        "type": "template",
        "z": "b12a97c9e23a7df8",
        "name": "EDAY_egauge",
        "field": "payload",
        "fieldType": "msg",
        "format": "python",
        "syntax": "mustache",
        "template": "import sys\nimport os\nimport time\nimport pytz\nimport calendar\nimport datetime\nimport pandas as pd\nfrom datetime import date\nfrom influxdb_client.client.write_api import SYNCHRONOUS, ASYNCHRONOUS\nfrom influxdb_client import InfluxDBClient, Point, WritePrecision, WriteOptions\n\ntoday = date.today()\np = (str(today))\nx = p.split('-')\nuniqueday = int(x[2])\nuniquemonth = int(x[1])\nuniqueyear = int(x[0])\nts = datetime.datetime(uniqueyear,uniquemonth,uniqueday, 00, 00,00).timestamp()\nc = int(ts)\nFrom = (c-19800)\nTo = calendar.timegm(time.gmtime())\n\ninflux_url=\"http://localhost:8087/\"\ninflux_token=\"pNNW_glBJ_PH_Elpft-l85BC570_MLlDJOo69DE5CERDSNovQI5z1GusUVL1qBadlMWRCHirPOWh92wdbk0vtg==\"\norganisation=\"Test\"\nsource_database=\"egaugemeter\"\ndest_database=\"egaugemeter\"\n\nclient = InfluxDBClient(url=influx_url, token=influx_token, org=organisation)\nwrite_api = client.write_api(write_options=SYNCHRONOUS, debug=True)\nquery_api = client.query_api()\n\nplant = \"egauge75568\"\niGate_id = \"75568\"\ndevice = ['EM']\nfield = \"EAE_DAY\"\n\ndef frame_influx_query(source_database, plant, device, field):\n    if source_database and device and field:\n       query = 'from(bucket: \\\"'+source_database+'\\\")  |> range(start: -30m)  |> filter(fn: (r) => r[\"_measurement\"] == \"v\") |> filter(fn: (r) => r[\"plant\"] == \\\"'+plant+'\\\") |> filter(fn: (r) => r[\"device\"] == \\\"'+device+'\\\") |> filter(fn: (r) => r[\"field\"] == \\\"'+field+'\\\") |> filter(fn: (r) => r[\"_field\"] == \"value\") |> yield(name: \"last\")'\n       \n    return query\n\ndef sending(df):\n   Year = int(df['Year'])\n   Month = int(df['Month'])\n   Day = int(df['Day'])\n   Device = str(df['Device'])\n   EAE_DAY = float(df['EAE_DAY'])\n   #print(EAE_DAY)\n   x = Device.split(' ')\n   y = x[4]\n   z = y.split('\\n')\n   Dev = z[0]\n   ts = datetime.datetime(Year,Month,Day, 00, 00,00).timestamp()\n   #ts = (calendar.timegm(Date_IST.timetuple()))\n   ns = int(ts)\n   string = str(ns) + \"000\"\n   liveepoch = time.strftime(\"%Y-%m-%dT%H:%M:%SZ\", time.gmtime(int(string)/1000.0))\n   data = [{\n       \"measurement\":\"report\",\n       \"tags\": {\n           \"plant\" : plant,\n           \"meter_id\": \"75568\",\n           \"device\" : Dev,\n           \"field\": \"EAE_DAY\"\n               },\n       \"time\" : liveepoch,\n       \"fields\": {\n           \"value\" : EAE_DAY\n           }\n       }]\n   print(data)\n   stat = os.system('influx bucket list --host '+influx_url+' --token '+influx_token+' --org '+organisation+' --name '+dest_database+' >> /dev/null')\n   if stat != 0:\n       stat = os.system('influx bucket create --host '+influx_url+' --token '+influx_token+' --org '+organisation+' --name '+dest_database+' >> /dev/null')\n   \n   write_api.write(dest_database, organisation, data)\n\n\nfor i in range(len(device)):\n    points_day = []\n    my_q_str = frame_influx_query(source_database, plant, device[i], field)\n    print(my_q_str)\n    result = query_api.query(query=my_q_str)\n    for table in result:\n        for record in table.records:\n            points_value = record.get_value()\n            points_time = time.strftime(\"%Y-%m-%dT%H:%M:%SZ\", time.gmtime(int(record.get_time().timestamp())))\n    points_day = [{\n        \"time\": points_time,\n        \"last\": points_value\n        }]\n    df = pd.DataFrame(points_day)\n    #print(df)\n    if len(df) != 0:\n        df[\"Date_IST\"] = pd.to_datetime(df[\"time\"]) + pd.DateOffset(hours=5, minutes=30)\n        df.Date_IST = pd.to_datetime(df.Date_IST)\n        #df[\"Date_IST\"] = df[\"Date_IST\"].to_pydatetime()\n        df['day'] = pd.to_datetime(df['Date_IST']).dt.day\n        df['month'] = pd.to_datetime(df['Date_IST']).dt.month\n        df['year'] = pd.to_datetime(df['Date_IST']).dt.year\n        df = df.dropna()\n   \n        Month = df['month'].tolist()\n        Year = df['year'].tolist()\n        Day =  df['day'].tolist()\n        EAE_DAY =  df['last'].tolist()\n        Date_IST =  df['Date_IST'].tolist()\n\n        df = pd.DataFrame({\n        'Month': Month,\n        'Year': Year,\n        'Day': Day,\n        'EAE_DAY': EAE_DAY,\n        'Date_IST': Date_IST,\n        'Device':  device[i]})\n        #print(df)\n        sending(df)",
        "output": "str",
        "x": 400,
        "y": 1480,
        "wires": [
            [
                "51008b19e29508e6"
            ]
        ]
    },
    {
        "id": "51008b19e29508e6",
        "type": "file",
        "z": "b12a97c9e23a7df8",
        "name": "write file",
        "filename": "/home/iplon/EDAY_egauge.py",
        "filenameType": "str",
        "appendNewline": false,
        "createDir": false,
        "overwriteFile": "true",
        "encoding": "none",
        "x": 560,
        "y": 1480,
        "wires": [
            [
                "2947b45cf6ed3663"
            ]
        ]
    },
    {
        "id": "2947b45cf6ed3663",
        "type": "exec",
        "z": "b12a97c9e23a7df8",
        "command": "python3 /home/iplon/EDAY_egauge.py",
        "addpay": "payload",
        "append": "",
        "useSpawn": "true",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "",
        "x": 790,
        "y": 1480,
        "wires": [
            [
                "a2e28dd54ee61dda"
            ],
            [],
            []
        ]
    },
    {
        "id": "0abe8043de6697ae",
        "type": "comment",
        "z": "b12a97c9e23a7df8",
        "name": "Daily value",
        "info": "",
        "x": 180,
        "y": 1400,
        "wires": []
    },
    {
        "id": "6b1c0f678c774180",
        "type": "comment",
        "z": "b12a97c9e23a7df8",
        "name": "Monthly value",
        "info": "",
        "x": 190,
        "y": 1560,
        "wires": []
    },
    {
        "id": "7f3e499971dec5f6",
        "type": "template",
        "z": "b12a97c9e23a7df8",
        "name": "EDAY_Month_egauge",
        "field": "payload",
        "fieldType": "msg",
        "format": "python",
        "syntax": "mustache",
        "template": "import sys\nimport os\nimport time\nimport pytz\nimport calendar\nimport datetime\nimport pandas as pd\nfrom datetime import date\nfrom influxdb_client import InfluxDBClient, Point, WritePrecision, WriteOptions\nfrom influxdb_client.client.write_api import SYNCHRONOUS, ASYNCHRONOUS\n\ninflux_url=\"http://localhost:8087/\"\ninflux_token=\"pNNW_glBJ_PH_Elpft-l85BC570_MLlDJOo69DE5CERDSNovQI5z1GusUVL1qBadlMWRCHirPOWh92wdbk0vtg==\"\norganisation=\"Test\"\nsource_database=\"egaugemeter\"\nsource_database_table=\"report\"\ndest_database=\"egaugemeter\"\ndest_database_table=\"report\"\n\nclient = InfluxDBClient(url=influx_url, token=influx_token, org=organisation)\nwrite_api = client.write_api(write_options=SYNCHRONOUS)\nquery_api = client.query_api()\n\ntimestamp = (\"\"\"1640975400000 2240524800000\"\"\")\n#timestamp = (\"\"\"{{payload}}\"\"\")\nb = (timestamp.split())\nstart_time = time.strftime(\"%Y-%m-%dT%H:%M:%SZ\", time.gmtime(int(b[0])/1000.0))\nstop_time = time.strftime(\"%Y-%m-%dT%H:%M:%SZ\", time.gmtime(int(b[1])/1000.0))\n\ndef frame_influx_query(source_database, source_database_table, plant, device, field):\n    if source_database and source_database_table and plant and field:\n        query = ' from(bucket: \\\"'+source_database+'\\\")  |> range(start: '+start_time+', stop: '+stop_time+')  |> filter(fn: (r) => r[\"_measurement\"] == \\\"'+source_database_table+'\\\")  |> filter(fn: (r) => r[\"plant\"] == \\\"'+plant+'\\\")  |> filter(fn: (r) => r[\"device\"] == \\\"'+device+'\\\")  |> filter(fn: (r) => r[\"field\"] == \\\"'+field+'\\\")  |> filter(fn: (r) => r[\"_field\"] == \"value\")  |> yield(name: \"last\")'\n    return query\n\n\nplant = \"egauge75568\"\ndevice = ['EM']\nfield = \"EAE_DAY\"\n\npoints = []\noutvalue = []\noutyear = []\noutmonth = []\noutplant = []\n\nfor i in range(len(device)):\n    my_q_str = frame_influx_query(source_database, source_database_table, plant, device[i], field)\n    #print(my_q_str)\n    result = query_api.query(query=my_q_str)\n    points_day_array=[]\n    for table in result:\n        for record in table.records:\n            points_value = record.get_value()\n            points_time = time.strftime(\"%Y-%m-%dT%H:%M:%SZ\", time.gmtime(int(record.get_time().timestamp())))\n            points_day = {\n            \"time\": points_time,\n            \"last\": points_value\n            }\n            points_day_array.append(points_day)\n    df = pd.DataFrame(points_day_array)\n    #print(df)\n\n    pd.set_option('display.max_columns', None)  \n    pd.set_option('display.max_rows', None)  \n    df.time = pd.to_datetime(df.time)\n    df[\"Date_IST\"] = pd.to_datetime(df[\"time\"]) + pd.DateOffset(hours=5, minutes=30)\n    df['Date'] = pd.to_datetime(df['Date_IST']).dt.date\n    df['Time'] = pd.to_datetime(df['Date_IST']).dt.time\n    df.Date = pd.to_datetime(df.Date)\n    df = df.groupby('Date').sum('last')\n    df = df.groupby(df.index.to_period('m')).cumsum().reset_index()\n    df1 = df.groupby('Date').sum('last')\n    df1 = df1.groupby(df1.index.to_period('y')).cumsum().reset_index()\n    df['month'] = pd.to_datetime(df['Date']).dt.month\n    df['year'] = pd.to_datetime(df['Date']).dt.year\n \n    monthname = df['month'].iloc[0]\n    year = df['year'].iloc[0]   \n    l = len(df)\n\n    #---------------Month Cum Calculation start----------------#\n    for j in range(l):\n        tmp = df['month'].iloc[j]\n        tmpyear = df['year'].iloc[j]\n        if ((monthname != tmp) and (tmpyear == year)):\n            valid = j-1\n            if pd.isnull(df['last'].iloc[valid]) != True:\n                outvalue += [df['last'].iloc[valid]]\n                outyear += [df['year'].iloc[valid]]\n                outmonth += [df['month'].iloc[valid]]\n                outplant += [device[i]]\n            else:\n                if tmp == 1:\n                    tmp = 13\n                k = valid - 1\n                while k < valid:\n                    if ((pd.isnull(df['last'].iloc[k]) == False) and ((tmp-1) == monthname)):\n                        break\n                    k -= 1\n                outvalue += [df['last'].iloc[k]]\n                outyear += [df['year'].iloc[k]]\n                outmonth += [df['month'].iloc[k]]\n                outplant += [device[i]]\n                if tmp == 13:\n                   tmp = 1\n        elif ((monthname != tmp) and (tmpyear != year)): \n            valid = j-1\n            if pd.isnull(df['last'].iloc[valid]) != True:\n                outvalue += [df['last'].iloc[valid]]\n                outyear += [df['year'].iloc[valid]]\n                outmonth += [df['month'].iloc[valid]]\n                outplant += [device[i]]\n            else:\n                if tmp == 1:\n                    tmp = 13\n                k = valid - 1\n                while k < valid:\n                    if ((pd.isnull(df['last'].iloc[k]) == False) and ((tmp-1) == monthname)):\n                        break\n                    k -= 1\n                outvalue += [df['last'].iloc[k]]\n                outyear += [df['year'].iloc[k]]\n                outmonth += [df['month'].iloc[k]]\n                outplant += [device[i]]\n                if tmp == 13:\n                   tmp = 1\n        monthname = tmp \n        year = tmpyear    \n    \n    if ((monthname == tmp) and (tmpyear == year)):\n        count = l-1\n        if pd.isnull(df['last'].iloc[count]) != True:    \t\n            outvalue += [df['last'].iloc[count]]\n            outyear += [df['year'].iloc[count]]\n            outmonth += [df['month'].iloc[count]]\n            outplant += [device[i]]\n        else:\n            m = count - 1\n            while m < count:\n                if ((pd.isnull(df['last'].iloc[m]) == False) and (monthname == tmp)):\n                    break\n                m -= 1\n            outvalue += [df['last'].iloc[m]]\n            outyear += [df['year'].iloc[m]]\n            outmonth += [df['month'].iloc[m]]\n            outplant += [device[i]]\n\nout = [round(num, 2) for num in outvalue]\n\n#------------------------Month Cum calculation End------------------#\n\nnull = df[df['last'].isnull()].index.tolist()\nfor i in range(len(null)):\n    null_date = (df['Date_IST'].iloc[null[i]])\n\nepoch = []\n\nfor v in range(len(outvalue)):\n    #a_date = str(outyear[v]) + \"-\" + str(outmonth[v]) + \"-\" + \"01\" + \"T\" + \"00\" +\":\" +\"00\" + \":\" + \"00Z\n    ts = datetime.datetime(outyear[v],outmonth[v],1, 00, 00,00).timestamp()\n    ns = int(ts)\n    string = str(ns) + \"000\"\n    epoch = time.strftime(\"%Y-%m-%dT%H:%M:%SZ\", time.gmtime(int(string)/1000.0))\n    \n    data = [{\n        \"measurement\": dest_database_table,\n        \"tags\": {\n            \"plant\" : plant,\n            \"device\" : outplant[v],\n           \"meter_id\": \"75568\",\n           \"field\": \"EAE_Month\"\n             },\n        \"time\" : epoch,\n        \"fields\": {\n            \"value\" : out[v]\n            }\n        }]\n    print(data)\n    stat = os.system('influx bucket list --host '+influx_url+' --token '+influx_token+' --org '+organisation+' --name '+dest_database+' >> /dev/null')\n    if stat != 0:\n        stat = os.system('influx bucket create --host '+influx_url+' --token '+influx_token+' --org '+organisation+' --name '+dest_database+' >> /dev/null')\n    \n    write_api.write(dest_database, organisation, data)\n\n\n",
        "output": "str",
        "x": 420,
        "y": 1620,
        "wires": [
            [
                "4b4935b5e90c792a"
            ]
        ]
    },
    {
        "id": "4b4935b5e90c792a",
        "type": "file",
        "z": "b12a97c9e23a7df8",
        "name": "write file",
        "filename": "/home/iplon/EDAY_Month_egauge.py",
        "filenameType": "str",
        "appendNewline": false,
        "createDir": false,
        "overwriteFile": "true",
        "encoding": "none",
        "x": 600,
        "y": 1620,
        "wires": [
            [
                "896e5803bd6a051e"
            ]
        ]
    },
    {
        "id": "896e5803bd6a051e",
        "type": "exec",
        "z": "b12a97c9e23a7df8",
        "command": "python3 /home/iplon/EDAY_Month_egauge.py",
        "addpay": "payload",
        "append": "",
        "useSpawn": "true",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "",
        "x": 860,
        "y": 1620,
        "wires": [
            [
                "6d07a6691a9ce3db"
            ],
            [],
            []
        ]
    },
    {
        "id": "4402f1db735c5ebb",
        "type": "comment",
        "z": "b12a97c9e23a7df8",
        "name": "Yearly value",
        "info": "",
        "x": 190,
        "y": 1720,
        "wires": []
    },
    {
        "id": "f8bb1821a90ed974",
        "type": "template",
        "z": "b12a97c9e23a7df8",
        "name": "EDAY_Year_egauge",
        "field": "payload",
        "fieldType": "msg",
        "format": "python",
        "syntax": "mustache",
        "template": "import sys\nimport os\nimport time\nimport pytz\nimport calendar\nimport datetime\nimport pandas as pd\nfrom datetime import date\nfrom influxdb_client import InfluxDBClient, Point, WritePrecision, WriteOptions\nfrom influxdb_client.client.write_api import SYNCHRONOUS, ASYNCHRONOUS\n\ninflux_url=\"http://localhost:8087/\"\ninflux_token=\"pNNW_glBJ_PH_Elpft-l85BC570_MLlDJOo69DE5CERDSNovQI5z1GusUVL1qBadlMWRCHirPOWh92wdbk0vtg==\"\norganisation=\"Test\"\nsource_database=\"egaugemeter\"\nsource_database_table=\"report\"\ndest_database=\"egaugemeter\"\ndest_database_table=\"report\"\n\nclient = InfluxDBClient(url=influx_url, token=influx_token, org=organisation)\nwrite_api = client.write_api(write_options=SYNCHRONOUS)\nquery_api = client.query_api()\n\ntimestamp = (\"\"\"1640975400000 2240524800000\"\"\")\n#timestamp = (\"\"\"{{payload}}\"\"\")\nb = (timestamp.split())\nstart_time = time.strftime(\"%Y-%m-%dT%H:%M:%SZ\", time.gmtime(int(b[0])/1000.0))\nstop_time = time.strftime(\"%Y-%m-%dT%H:%M:%SZ\", time.gmtime(int(b[1])/1000.0))\n\ndef frame_influx_query(source_database, source_database_table, plant, device, field):\n    if source_database and source_database_table and plant and device and field:\n        query = ' from(bucket: \\\"'+source_database+'\\\")  |> range(start: '+start_time+', stop: '+stop_time+')  |> filter(fn: (r) => r[\"_measurement\"] == \\\"'+source_database_table+'\\\")  |> filter(fn: (r) => r[\"plant\"] == \\\"'+plant+'\\\")  |> filter(fn: (r) => r[\"device\"] == \\\"'+device+'\\\")  |> filter(fn: (r) => r[\"field\"] == \\\"'+field+'\\\")  |> filter(fn: (r) => r[\"_field\"] == \"value\")  |> yield(name: \"last\")'\n    return query\n\n\nplant = \"egauge75568\"\ndevice = ['EM']\nfield = \"EAE_Month\"\n\npd.set_option('display.max_columns', None)  \npd.set_option('display.max_rows', None) \n\npoints = []\noutvalue = []\noutyear = []\noutplant = []\n\nfor x in range(len(device)):\n    my_q_str = frame_influx_query(source_database, source_database_table, plant, device[x], field)\n    #print(my_q_str)\n    result = query_api.query(query=my_q_str)\n    points_day_array=[]\n    for table in result:\n        for record in table.records:\n            points_value = record.get_value()\n            points_time = time.strftime(\"%Y-%m-%dT%H:%M:%SZ\", time.gmtime(int(record.get_time().timestamp())))\n            points_day = {\n            \"time\": points_time,\n            \"last\": points_value\n            }\n            points_day_array.append(points_day)\n    df = pd.DataFrame(points_day_array)\n    #print(df)\n\n    pd.set_option('display.max_columns', None)  \n    pd.set_option('display.max_rows', None)  \n    df.time = pd.to_datetime(df.time)\n    df[\"Date_IST\"] = pd.to_datetime(df[\"time\"]) + pd.DateOffset(hours=5, minutes=30)\n    df['Cumulative Year'] = df.groupby(df['Date_IST'].dt.year)['last'].cumsum()\n    df['year'] = pd.to_datetime(df['Date_IST']).dt.year\n    year = df['year'].iloc[0]\n    l = len(df)\n    \n    #---------------Month Cum Calculation----------------#\n    for j in range(l):\n        tmpyear = df['year'].iloc[j]\n        if (tmpyear != year):\n            valid = j-1\n            if pd.isnull(df['Cumulative Year'].iloc[valid]) != True:\n                outvalue += [df['Cumulative Year'].iloc[valid]]\n                outyear += [df['year'].iloc[valid]]\n                outplant += [device[x]]\n            else:\n                k = valid - 1\n                while k < valid:\n                    if ((pd.isnull(df['Cumulative Year'].iloc[k]) == False) and ((tmpyear-1) == year)):\n                        break\n                    k -= 1\n                outvalue += [df['Cumulative Year'].iloc[k]]\n                outyear += [df['year'].iloc[k]]\n                outplant += [device[x]]\n                outplant += [device[x]] \n        year = tmpyear\n        \n    if (tmpyear == year):\n        count = l-1\n        if pd.isnull(df['Cumulative Year'].iloc[count]) != True:\n            outvalue += [df['Cumulative Year'].iloc[count]]\n            outyear += [df['year'].iloc[count]]\n            outplant += [device[x]]\n        else:\n            m = count - 1\n            while m < count:\n                if ((pd.isnull(df['Cumulative Year'].iloc[m]) == False) and (year == tmpyear)):\n                    break\n                m -= 1\n            outvalue += [df['Cumulative Year'].iloc[m]]\n            outyear += [df['year'].iloc[m]]\n            outplant += [device[x]]\n\nout = [round(num, 2) for num in outvalue]\n\n#------------------------Month Cum calculation End------------------#\n\nnull = df[df['Cumulative Year'].isnull()].index.tolist()\nfor i in range(len(null)):\n    null_date = (df['Date_IST'].iloc[null[i]])\n\nepoch = []\n\nfor v in range(len(outvalue)):\n    ts = datetime.datetime(outyear[v],1,1, 00, 00,00).timestamp()\n    ns = int(ts)\n    string = str(ns) + \"000\"\n    epoch = time.strftime(\"%Y-%m-%dT%H:%M:%SZ\", time.gmtime(int(string)/1000.0))    \n\n    data = [{\n        \"measurement\": dest_database_table,\n        \"tags\": {\n            \"plant\": plant,\n            \"device\" : outplant[v],\n           \"meter_id\": \"75568\",\n           \"field\": \"EAE_Year\"\n             },\n        \"time\": epoch,\n        \"fields\": {\n            \"value\": out[v]\n            }\n        }]\n    print(data)\n    stat = os.system('influx bucket list --host '+influx_url+' --token '+influx_token+' --org '+organisation+' --name '+dest_database+' >> /dev/null')\n    if stat != 0:\n        stat = os.system('influx bucket create --host '+influx_url+' --token '+influx_token+' --org '+organisation+' --name '+dest_database+' >> /dev/null')\n    \n    write_api.write(dest_database, organisation, data)\n",
        "output": "str",
        "x": 420,
        "y": 1780,
        "wires": [
            [
                "0d01e9271fbb23e0"
            ]
        ]
    },
    {
        "id": "0d01e9271fbb23e0",
        "type": "file",
        "z": "b12a97c9e23a7df8",
        "name": "write file",
        "filename": "/home/iplon/EDAY_Year_egauge.py",
        "filenameType": "str",
        "appendNewline": false,
        "createDir": false,
        "overwriteFile": "true",
        "encoding": "none",
        "x": 600,
        "y": 1780,
        "wires": [
            [
                "47e474f9bf3f3ded"
            ]
        ]
    },
    {
        "id": "47e474f9bf3f3ded",
        "type": "exec",
        "z": "b12a97c9e23a7df8",
        "command": "python3 /home/iplon/EDAY_Year_egauge.py",
        "addpay": "payload",
        "append": "",
        "useSpawn": "true",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "",
        "x": 850,
        "y": 1780,
        "wires": [
            [
                "591329cc50e789a2"
            ],
            [],
            []
        ]
    },
    {
        "id": "8514f610f2112d36",
        "type": "debug",
        "z": "b12a97c9e23a7df8",
        "name": "debug 123",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 530,
        "y": 1320,
        "wires": []
    },
    {
        "id": "a2e28dd54ee61dda",
        "type": "debug",
        "z": "b12a97c9e23a7df8",
        "name": "debug 124",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1050,
        "y": 1480,
        "wires": []
    },
    {
        "id": "6d07a6691a9ce3db",
        "type": "debug",
        "z": "b12a97c9e23a7df8",
        "name": "debug 125",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1150,
        "y": 1620,
        "wires": []
    },
    {
        "id": "591329cc50e789a2",
        "type": "debug",
        "z": "b12a97c9e23a7df8",
        "name": "debug 126",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1130,
        "y": 1780,
        "wires": []
    },
    {
        "id": "6b9b6086679f1e65",
        "type": "cronplus",
        "z": "b12a97c9e23a7df8",
        "name": "",
        "outputField": "payload",
        "timeZone": "",
        "persistDynamic": false,
        "commandResponseMsgOutput": "output1",
        "outputs": 1,
        "options": [
            {
                "name": "schedule1",
                "topic": "topic1",
                "payloadType": "default",
                "payload": "",
                "expressionType": "cron",
                "expression": "0 0 12 * * *",
                "location": "",
                "offset": "0",
                "solarType": "all",
                "solarEvents": "sunrise,sunset"
            }
        ],
        "x": 200,
        "y": 1480,
        "wires": [
            [
                "ccc4c40ae8dd938b"
            ]
        ]
    },
    {
        "id": "133cb782b24cdd63",
        "type": "cronplus",
        "z": "b12a97c9e23a7df8",
        "name": "",
        "outputField": "payload",
        "timeZone": "",
        "persistDynamic": false,
        "commandResponseMsgOutput": "output1",
        "outputs": 1,
        "options": [
            {
                "name": "schedule1",
                "topic": "topic1",
                "payloadType": "default",
                "payload": "",
                "expressionType": "cron",
                "expression": "0 0 12 * * *",
                "location": "",
                "offset": "0",
                "solarType": "all",
                "solarEvents": "sunrise,sunset"
            }
        ],
        "x": 220,
        "y": 1620,
        "wires": [
            [
                "7f3e499971dec5f6"
            ]
        ]
    },
    {
        "id": "4cd0793529bd9f9c",
        "type": "cronplus",
        "z": "b12a97c9e23a7df8",
        "name": "",
        "outputField": "payload",
        "timeZone": "",
        "persistDynamic": false,
        "commandResponseMsgOutput": "output1",
        "outputs": 1,
        "options": [
            {
                "name": "schedule1",
                "topic": "topic1",
                "payloadType": "default",
                "payload": "",
                "expressionType": "cron",
                "expression": "0 0 12 * * *",
                "location": "",
                "offset": "0",
                "solarType": "all",
                "solarEvents": "sunrise,sunset"
            }
        ],
        "x": 200,
        "y": 1780,
        "wires": [
            [
                "f8bb1821a90ed974"
            ]
        ]
    },
    {
        "id": "d55488219e89163d",
        "type": "inject",
        "z": "b12a97c9e23a7df8",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 220,
        "y": 920,
        "wires": [
            [
                "f3e0d0d367f9194e"
            ]
        ]
    },
    {
        "id": "f3e0d0d367f9194e",
        "type": "http request",
        "z": "b12a97c9e23a7df8",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://egauge75568.d.egauge.net/cgi-bin/egauge-show?m&n=1&a&c",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 390,
        "y": 920,
        "wires": [
            [
                "ba1c097202f11eba"
            ]
        ]
    },
    {
        "id": "ba1c097202f11eba",
        "type": "csv",
        "z": "b12a97c9e23a7df8",
        "name": "",
        "sep": ",",
        "hdrin": true,
        "hdrout": "",
        "multi": "one",
        "ret": "\\n",
        "temp": "",
        "skip": "0",
        "strings": true,
        "include_empty_strings": false,
        "include_null_values": true,
        "x": 570,
        "y": 920,
        "wires": [
            [
                "29f837bef4cca04c"
            ]
        ]
    },
    {
        "id": "55d7386c90bf4f5d",
        "type": "function",
        "z": "b12a97c9e23a7df8",
        "name": "function 8",
        "func": "let plantObj\nplantObj = []\n{\n    var time = msg.payload[0][\"Date & Time\"];\n    var eae = msg.payload[0][\"Generation [kWh]\"];\n    if (eae > 0) {\n        var COMMUNICATION_TIME = time\n    }\n    var obj =\n    {\n        time,\n        eae,\n        COMMUNICATION_TIME\n    }\n    plantObj.push(obj)\n}\nmsg.payload = plantObj\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 860,
        "y": 920,
        "wires": [
            [
                "04caa5c3c5a5559a"
            ]
        ]
    },
    {
        "id": "29f837bef4cca04c",
        "type": "join",
        "z": "b12a97c9e23a7df8",
        "name": "",
        "mode": "auto",
        "build": "object",
        "property": "payload",
        "propertyType": "msg",
        "key": "topic",
        "joiner": "\\n",
        "joinerType": "str",
        "accumulate": true,
        "timeout": "",
        "count": "",
        "reduceRight": false,
        "reduceExp": "",
        "reduceInit": "",
        "reduceInitType": "",
        "reduceFixup": "",
        "x": 710,
        "y": 920,
        "wires": [
            [
                "55d7386c90bf4f5d"
            ]
        ]
    },
    {
        "id": "5a2b6085366f7058",
        "type": "comment",
        "z": "b12a97c9e23a7df8",
        "name": "Communication time",
        "info": "",
        "x": 210,
        "y": 860,
        "wires": []
    },
    {
        "id": "04caa5c3c5a5559a",
        "type": "function",
        "z": "b12a97c9e23a7df8",
        "name": "function 12",
        "func": "//var plantObj = []; // Create an empty array to hold the InfluxDB line protocol objects\nfor (var i = 0; i < msg.payload.length; i++) {\n    var obj = {};\n    obj.payload = [{\n        measurement: \"v\",\n        fields: {\n            value: msg.payload[i].time,\n            text: \"0\",\n            qu: \"0\"\n        },\n        tags: {\n            meter_id: \"75568\",\n            plant: \"egauge75568\",\n            device: \"EM\",\n            field: \"COMMUNICATION_TIME\"\n        },\n\n    }];\n    node.send(obj);\n}\nreturn null;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1030,
        "y": 920,
        "wires": [
            [
                "3186c7325d727eab",
                "096e2ffcae27886b"
            ]
        ]
    },
    {
        "id": "3186c7325d727eab",
        "type": "influxdb batch",
        "z": "b12a97c9e23a7df8",
        "influxdb": "bd932ff2.1cb77",
        "precision": "",
        "retentionPolicy": "",
        "name": "",
        "database": "database",
        "precisionV18FluxV20": "s",
        "retentionPolicyV18Flux": "",
        "org": "Test",
        "bucket": "egaugemeter",
        "x": 1230,
        "y": 920,
        "wires": []
    },
    {
        "id": "096e2ffcae27886b",
        "type": "debug",
        "z": "b12a97c9e23a7df8",
        "name": "debug 131",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1030,
        "y": 1020,
        "wires": []
    },
    {
        "id": "11b1fda35651c7b1",
        "type": "comment",
        "z": "b12a97c9e23a7df8",
        "name": "History data (Initial only)",
        "info": "",
        "x": 220,
        "y": 60,
        "wires": []
    },
    {
        "id": "438ba719457f9a2f",
        "type": "http request",
        "z": "b12a97c9e23a7df8",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://egauge75568.d.egauge.net/cgi-bin/egauge-show?m&s=14&a&c",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 390,
        "y": 140,
        "wires": [
            [
                "35ad4ef690b4f81e"
            ]
        ]
    },
    {
        "id": "35ad4ef690b4f81e",
        "type": "csv",
        "z": "b12a97c9e23a7df8",
        "name": "",
        "sep": ",",
        "hdrin": true,
        "hdrout": "",
        "multi": "one",
        "ret": "\\n",
        "temp": "",
        "skip": "0",
        "strings": true,
        "include_empty_strings": false,
        "include_null_values": true,
        "x": 550,
        "y": 140,
        "wires": [
            [
                "2124171b377461fc",
                "a3f2553e799dced2"
            ]
        ]
    },
    {
        "id": "f325c2ded85cbc46",
        "type": "debug",
        "z": "b12a97c9e23a7df8",
        "name": "debug 133",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 990,
        "y": 260,
        "wires": []
    },
    {
        "id": "a3f2553e799dced2",
        "type": "debug",
        "z": "b12a97c9e23a7df8",
        "name": "debug 134",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 550,
        "y": 260,
        "wires": []
    },
    {
        "id": "60b51df7edfc5ab0",
        "type": "function",
        "z": "b12a97c9e23a7df8",
        "name": "function 13",
        "func": "//var plantObj = []; // Create an empty array to hold the InfluxDB line protocol objects\nfor (var i = 0; i < msg.payload.length; i++) {\n    var dateUTC = new Date(msg.payload[i][\"Date & Time\"]).getTime();\n    var obj = {};\n    obj.payload = [{\n        measurement: \"v\",\n        fields: {\n            value: msg.payload[i][\"Generation [kWh]\"],\n            text: \"0\",\n            qu: \"0\"\n        },\n        tags: {\n            meter_id: \"75568\",\n            plant: \"egauge75568\",\n            device:\"EM\",\n            field: \"EAE\"\n        },\n        timestamp: dateUTC\n    }];\n    node.send(obj);\n}\nreturn null;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 880,
        "y": 140,
        "wires": [
            [
                "f325c2ded85cbc46",
                "9b4ee78feb1fb732"
            ]
        ]
    },
    {
        "id": "9b4ee78feb1fb732",
        "type": "influxdb batch",
        "z": "b12a97c9e23a7df8",
        "influxdb": "bd932ff2.1cb77",
        "precision": "",
        "retentionPolicy": "",
        "name": "",
        "database": "database",
        "precisionV18FluxV20": "s",
        "retentionPolicyV18Flux": "",
        "org": "Test",
        "bucket": "egaugemeter",
        "x": 1190,
        "y": 140,
        "wires": []
    },
    {
        "id": "2124171b377461fc",
        "type": "join",
        "z": "b12a97c9e23a7df8",
        "name": "",
        "mode": "auto",
        "build": "object",
        "property": "payload",
        "propertyType": "msg",
        "key": "topic",
        "joiner": "\\n",
        "joinerType": "str",
        "accumulate": true,
        "timeout": "",
        "count": "",
        "reduceRight": false,
        "reduceExp": "",
        "reduceInit": "",
        "reduceInitType": "",
        "reduceFixup": "",
        "x": 710,
        "y": 140,
        "wires": [
            [
                "60b51df7edfc5ab0",
                "5fd7a2fc1f721be6"
            ]
        ]
    },
    {
        "id": "5fd7a2fc1f721be6",
        "type": "debug",
        "z": "b12a97c9e23a7df8",
        "name": "debug 135",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 770,
        "y": 260,
        "wires": []
    },
    {
        "id": "f1545b6b72bdabb6",
        "type": "inject",
        "z": "b12a97c9e23a7df8",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 200,
        "y": 140,
        "wires": [
            []
        ]
    },
    {
        "id": "a3e88476804057eb",
        "type": "comment",
        "z": "b12a97c9e23a7df8",
        "name": "Refill EAE_DAY",
        "info": "",
        "x": 200,
        "y": 340,
        "wires": []
    },
    {
        "id": "63de093257f96ebd",
        "type": "comment",
        "z": "266079b93877e06e",
        "name": "EAE_DAY Calculation",
        "info": "",
        "x": 180,
        "y": 780,
        "wires": []
    },
    {
        "id": "94c2bb4adaa3b46e",
        "type": "function",
        "z": "266079b93877e06e",
        "name": "cum_edc",
        "func": "var q1 = 'from(bucket: \"egaugemeter\")|> range(start: -1d)|> filter(fn: (r) => r[\"_measurement\"] == \"v\") |>filter(fn: (r) => r[\"plant\"] == \"egauge75568\")|> filter(fn: (r) => r[\"device\"] == \"EM\") |> filter(fn: (r) => r[\"field\"] == \"EAE\")|> filter(fn: (r) => r[\"_field\"] == \"value\")|> aggregateWindow(every: 1d, fn: last, createEmpty: false)|> yield(name: \"EAEMIN\")'\nvar q2 = 'from(bucket: \"egaugemeter\")|> range(start: -1m)  |> filter(fn: (r) => r[\"_measurement\"] == \"v\")  |>filter(fn: (r) => r[\"plant\"] == \"egauge75568\")|> filter(fn: (r) => r[\"device\"] == \"EM\") |> filter(fn: (r) => r[\"field\"] == \"EAE\")|> filter(fn: (r) => r[\"_field\"] == \"value\")|> yield(name: \"EAE\")'\nmsg.query = q1 + q2\nreturn msg;\n \n \n \n ",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 320,
        "y": 860,
        "wires": [
            [
                "404d18e75073c7b9"
            ]
        ]
    },
    {
        "id": "404d18e75073c7b9",
        "type": "influxdb in",
        "z": "266079b93877e06e",
        "influxdb": "dd04d92d3d5b3211",
        "name": "egauge",
        "query": "",
        "rawOutput": false,
        "precision": "",
        "retentionPolicy": "",
        "org": "Test",
        "x": 480,
        "y": 860,
        "wires": [
            [
                "36c0cf8745c8f109"
            ]
        ]
    },
    {
        "id": "8e871c505835e98e",
        "type": "cronplus",
        "z": "266079b93877e06e",
        "name": "",
        "outputField": "payload",
        "timeZone": "",
        "persistDynamic": false,
        "commandResponseMsgOutput": "output1",
        "outputs": 1,
        "options": [
            {
                "name": "schedule1",
                "topic": "topic1",
                "payloadType": "date",
                "payload": "",
                "expressionType": "cron",
                "expression": "0 10 00 * * * *",
                "location": "",
                "offset": "0",
                "solarType": "all",
                "solarEvents": "sunrise,sunset"
            }
        ],
        "x": 160,
        "y": 920,
        "wires": [
            []
        ]
    },
    {
        "id": "9f136cff78a4136a",
        "type": "debug",
        "z": "266079b93877e06e",
        "name": "debug 149",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 950,
        "y": 980,
        "wires": []
    },
    {
        "id": "54b01ac3e1dfd58e",
        "type": "function",
        "z": "266079b93877e06e",
        "name": "function 21",
        "func": "let plantObj\nplantObj = []\n{\n    var time = msg.payload[1]._time;\n    var eaemin = msg.payload[0]._value;\n    var eae = msg.payload[1]._value;\n    if (eae >= eaemin) {\n        var EAE_DAY = eae - eaemin\n    }\n    var obj =\n    {\n        time,\n        eaemin,\n        eae,\n        EAE_DAY\n    }\n    plantObj.push(obj)\n}\nmsg.payload = plantObj\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 700,
        "y": 860,
        "wires": [
            [
                "569cddea0099b23e",
                "749cbfb52737e6c9"
            ]
        ]
    },
    {
        "id": "569cddea0099b23e",
        "type": "function",
        "z": "266079b93877e06e",
        "name": "function 22",
        "func": "{\n    //var dateUTC = new Date(msg.payload[0].time).getTime();\n    var obj = {};\n    obj.payload = [{\n        measurement: \"v\",\n        fields: {\n            value: msg.payload[0].EAE_DAY,\n            text: \"0\",\n            qu: \"0\"\n        },\n        tags: {\n            meter_id: \"75568\",\n            plant: \"egauge75568\",\n            device: \"EM\",\n            field: \"EAE_DAY\"\n        },\n        //timestamp: dateUTC\n    }];\n    node.send(obj);\n}\nreturn null;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 880,
        "y": 860,
        "wires": [
            [
                "9f136cff78a4136a",
                "f6c591b059f1f5b9"
            ]
        ]
    },
    {
        "id": "749cbfb52737e6c9",
        "type": "debug",
        "z": "266079b93877e06e",
        "name": "debug 150",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 730,
        "y": 980,
        "wires": []
    },
    {
        "id": "f6c591b059f1f5b9",
        "type": "influxdb batch",
        "z": "266079b93877e06e",
        "influxdb": "bd932ff2.1cb77",
        "precision": "",
        "retentionPolicy": "",
        "name": "",
        "database": "database",
        "precisionV18FluxV20": "s",
        "retentionPolicyV18Flux": "",
        "org": "Test",
        "bucket": "egaugemeter",
        "x": 1150,
        "y": 860,
        "wires": []
    },
    {
        "id": "61429663b545c287",
        "type": "comment",
        "z": "266079b93877e06e",
        "name": "EAE Data fetch",
        "info": "",
        "x": 140,
        "y": 420,
        "wires": []
    },
    {
        "id": "d3b0432324df9d61",
        "type": "template",
        "z": "266079b93877e06e",
        "name": "EDAY_egauge",
        "field": "payload",
        "fieldType": "msg",
        "format": "python",
        "syntax": "mustache",
        "template": "import sys\nimport os\nimport time\nimport pytz\nimport calendar\nimport datetime\nimport pandas as pd\nfrom datetime import date\nfrom influxdb_client.client.write_api import SYNCHRONOUS, ASYNCHRONOUS\nfrom influxdb_client import InfluxDBClient, Point, WritePrecision, WriteOptions\n\ntoday = date.today()\np = (str(today))\nx = p.split('-')\nuniqueday = int(x[2])\nuniquemonth = int(x[1])\nuniqueyear = int(x[0])\nts = datetime.datetime(uniqueyear,uniquemonth,uniqueday, 00, 00,00).timestamp()\nc = int(ts)\nFrom = (c-19800)\nTo = calendar.timegm(time.gmtime())\n\ninflux_url=\"http://localhost:8087/\"\ninflux_token=\"pNNW_glBJ_PH_Elpft-l85BC570_MLlDJOo69DE5CERDSNovQI5z1GusUVL1qBadlMWRCHirPOWh92wdbk0vtg==\"\norganisation=\"Test\"\nsource_database=\"egaugemeter\"\ndest_database=\"egaugemeter\"\n\nclient = InfluxDBClient(url=influx_url, token=influx_token, org=organisation)\nwrite_api = client.write_api(write_options=SYNCHRONOUS, debug=True)\nquery_api = client.query_api()\n\nplant = \"egauge75568\"\niGate_id = \"75568\"\ndevice = ['EM']\nfield = \"EAE_DAY\"\n\ndef frame_influx_query(source_database, plant, device, field):\n    if source_database and device and field:\n       query = 'from(bucket: \\\"'+source_database+'\\\")  |> range(start: -30m)  |> filter(fn: (r) => r[\"_measurement\"] == \"v\") |> filter(fn: (r) => r[\"plant\"] == \\\"'+plant+'\\\") |> filter(fn: (r) => r[\"device\"] == \\\"'+device+'\\\") |> filter(fn: (r) => r[\"field\"] == \\\"'+field+'\\\") |> filter(fn: (r) => r[\"_field\"] == \"value\") |> yield(name: \"last\")'\n       \n    return query\n\ndef sending(df):\n   Year = int(df['Year'])\n   Month = int(df['Month'])\n   Day = int(df['Day'])\n   Device = str(df['Device'])\n   EAE_DAY = float(df['EAE_DAY'])\n   #print(EAE_DAY)\n   x = Device.split(' ')\n   y = x[4]\n   z = y.split('\\n')\n   Dev = z[0]\n   ts = datetime.datetime(Year,Month,Day, 00, 00,00).timestamp()\n   #ts = (calendar.timegm(Date_IST.timetuple()))\n   ns = int(ts)\n   string = str(ns) + \"000\"\n   liveepoch = time.strftime(\"%Y-%m-%dT%H:%M:%SZ\", time.gmtime(int(string)/1000.0))\n   data = [{\n       \"measurement\":\"report\",\n       \"tags\": {\n           \"plant\" : plant,\n           \"meter_id\": \"75568\",\n           \"device\" : Dev,\n           \"field\": \"EAE_DAY\"\n               },\n       \"time\" : liveepoch,\n       \"fields\": {\n           \"value\" : EAE_DAY\n           }\n       }]\n   print(data)\n   stat = os.system('influx bucket list --host '+influx_url+' --token '+influx_token+' --org '+organisation+' --name '+dest_database+' >> /dev/null')\n   if stat != 0:\n       stat = os.system('influx bucket create --host '+influx_url+' --token '+influx_token+' --org '+organisation+' --name '+dest_database+' >> /dev/null')\n   \n   write_api.write(dest_database, organisation, data)\n\n\nfor i in range(len(device)):\n    points_day = []\n    my_q_str = frame_influx_query(source_database, plant, device[i], field)\n    print(my_q_str)\n    result = query_api.query(query=my_q_str)\n    for table in result:\n        for record in table.records:\n            points_value = record.get_value()\n            points_time = time.strftime(\"%Y-%m-%dT%H:%M:%SZ\", time.gmtime(int(record.get_time().timestamp())))\n    points_day = [{\n        \"time\": points_time,\n        \"last\": points_value\n        }]\n    df = pd.DataFrame(points_day)\n    #print(df)\n    if len(df) != 0:\n        df[\"Date_IST\"] = pd.to_datetime(df[\"time\"]) + pd.DateOffset(hours=5, minutes=30)\n        df.Date_IST = pd.to_datetime(df.Date_IST)\n        #df[\"Date_IST\"] = df[\"Date_IST\"].to_pydatetime()\n        df['day'] = pd.to_datetime(df['Date_IST']).dt.day\n        df['month'] = pd.to_datetime(df['Date_IST']).dt.month\n        df['year'] = pd.to_datetime(df['Date_IST']).dt.year\n        df = df.dropna()\n   \n        Month = df['month'].tolist()\n        Year = df['year'].tolist()\n        Day =  df['day'].tolist()\n        EAE_DAY =  df['last'].tolist()\n        Date_IST =  df['Date_IST'].tolist()\n\n        df = pd.DataFrame({\n        'Month': Month,\n        'Year': Year,\n        'Day': Day,\n        'EAE_DAY': EAE_DAY,\n        'Date_IST': Date_IST,\n        'Device':  device[i]})\n        #print(df)\n        sending(df)",
        "output": "str",
        "x": 340,
        "y": 1480,
        "wires": [
            [
                "f2bac009dadcf80c"
            ]
        ]
    },
    {
        "id": "f2bac009dadcf80c",
        "type": "file",
        "z": "266079b93877e06e",
        "name": "write file",
        "filename": "/home/iplon/EDAY_egauge.py",
        "filenameType": "str",
        "appendNewline": false,
        "createDir": false,
        "overwriteFile": "true",
        "encoding": "none",
        "x": 500,
        "y": 1480,
        "wires": [
            [
                "f8a04d25deeab81f"
            ]
        ]
    },
    {
        "id": "f8a04d25deeab81f",
        "type": "exec",
        "z": "266079b93877e06e",
        "command": "python3 /home/iplon/EDAY_egauge.py",
        "addpay": "payload",
        "append": "",
        "useSpawn": "true",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "",
        "x": 730,
        "y": 1480,
        "wires": [
            [
                "2207092d94a91e88"
            ],
            [],
            []
        ]
    },
    {
        "id": "310569298a4a4551",
        "type": "comment",
        "z": "266079b93877e06e",
        "name": "Daily value",
        "info": "",
        "x": 120,
        "y": 1400,
        "wires": []
    },
    {
        "id": "6522c7564610113c",
        "type": "comment",
        "z": "266079b93877e06e",
        "name": "Monthly value",
        "info": "",
        "x": 130,
        "y": 1560,
        "wires": []
    },
    {
        "id": "f0e0099eee4d1d05",
        "type": "template",
        "z": "266079b93877e06e",
        "name": "EDAY_Month_egauge",
        "field": "payload",
        "fieldType": "msg",
        "format": "python",
        "syntax": "mustache",
        "template": "import sys\nimport os\nimport time\nimport pytz\nimport calendar\nimport datetime\nimport pandas as pd\nfrom datetime import date\nfrom influxdb_client import InfluxDBClient, Point, WritePrecision, WriteOptions\nfrom influxdb_client.client.write_api import SYNCHRONOUS, ASYNCHRONOUS\n\ninflux_url=\"http://localhost:8087/\"\ninflux_token=\"pNNW_glBJ_PH_Elpft-l85BC570_MLlDJOo69DE5CERDSNovQI5z1GusUVL1qBadlMWRCHirPOWh92wdbk0vtg==\"\norganisation=\"Test\"\nsource_database=\"egaugemeter\"\nsource_database_table=\"report\"\ndest_database=\"egaugemeter\"\ndest_database_table=\"report\"\n\nclient = InfluxDBClient(url=influx_url, token=influx_token, org=organisation)\nwrite_api = client.write_api(write_options=SYNCHRONOUS)\nquery_api = client.query_api()\n\ntimestamp = (\"\"\"1640975400000 2240524800000\"\"\")\n#timestamp = (\"\"\"{{payload}}\"\"\")\nb = (timestamp.split())\nstart_time = time.strftime(\"%Y-%m-%dT%H:%M:%SZ\", time.gmtime(int(b[0])/1000.0))\nstop_time = time.strftime(\"%Y-%m-%dT%H:%M:%SZ\", time.gmtime(int(b[1])/1000.0))\n\ndef frame_influx_query(source_database, source_database_table, plant, device, field):\n    if source_database and source_database_table and plant and field:\n        query = ' from(bucket: \\\"'+source_database+'\\\")  |> range(start: '+start_time+', stop: '+stop_time+')  |> filter(fn: (r) => r[\"_measurement\"] == \\\"'+source_database_table+'\\\")  |> filter(fn: (r) => r[\"plant\"] == \\\"'+plant+'\\\")  |> filter(fn: (r) => r[\"device\"] == \\\"'+device+'\\\")  |> filter(fn: (r) => r[\"field\"] == \\\"'+field+'\\\")  |> filter(fn: (r) => r[\"_field\"] == \"value\")  |> yield(name: \"last\")'\n    return query\n\n\nplant = \"egauge75568\"\ndevice = ['EM']\nfield = \"EAE_DAY\"\n\npoints = []\noutvalue = []\noutyear = []\noutmonth = []\noutplant = []\n\nfor i in range(len(device)):\n    my_q_str = frame_influx_query(source_database, source_database_table, plant, device[i], field)\n    #print(my_q_str)\n    result = query_api.query(query=my_q_str)\n    points_day_array=[]\n    for table in result:\n        for record in table.records:\n            points_value = record.get_value()\n            points_time = time.strftime(\"%Y-%m-%dT%H:%M:%SZ\", time.gmtime(int(record.get_time().timestamp())))\n            points_day = {\n            \"time\": points_time,\n            \"last\": points_value\n            }\n            points_day_array.append(points_day)\n    df = pd.DataFrame(points_day_array)\n    #print(df)\n\n    pd.set_option('display.max_columns', None)  \n    pd.set_option('display.max_rows', None)  \n    df.time = pd.to_datetime(df.time)\n    df[\"Date_IST\"] = pd.to_datetime(df[\"time\"]) + pd.DateOffset(hours=5, minutes=30)\n    df['Date'] = pd.to_datetime(df['Date_IST']).dt.date\n    df['Time'] = pd.to_datetime(df['Date_IST']).dt.time\n    df.Date = pd.to_datetime(df.Date)\n    df = df.groupby('Date').sum('last')\n    df = df.groupby(df.index.to_period('m')).cumsum().reset_index()\n    df1 = df.groupby('Date').sum('last')\n    df1 = df1.groupby(df1.index.to_period('y')).cumsum().reset_index()\n    df['month'] = pd.to_datetime(df['Date']).dt.month\n    df['year'] = pd.to_datetime(df['Date']).dt.year\n \n    monthname = df['month'].iloc[0]\n    year = df['year'].iloc[0]   \n    l = len(df)\n\n    #---------------Month Cum Calculation start----------------#\n    for j in range(l):\n        tmp = df['month'].iloc[j]\n        tmpyear = df['year'].iloc[j]\n        if ((monthname != tmp) and (tmpyear == year)):\n            valid = j-1\n            if pd.isnull(df['last'].iloc[valid]) != True:\n                outvalue += [df['last'].iloc[valid]]\n                outyear += [df['year'].iloc[valid]]\n                outmonth += [df['month'].iloc[valid]]\n                outplant += [device[i]]\n            else:\n                if tmp == 1:\n                    tmp = 13\n                k = valid - 1\n                while k < valid:\n                    if ((pd.isnull(df['last'].iloc[k]) == False) and ((tmp-1) == monthname)):\n                        break\n                    k -= 1\n                outvalue += [df['last'].iloc[k]]\n                outyear += [df['year'].iloc[k]]\n                outmonth += [df['month'].iloc[k]]\n                outplant += [device[i]]\n                if tmp == 13:\n                   tmp = 1\n        elif ((monthname != tmp) and (tmpyear != year)): \n            valid = j-1\n            if pd.isnull(df['last'].iloc[valid]) != True:\n                outvalue += [df['last'].iloc[valid]]\n                outyear += [df['year'].iloc[valid]]\n                outmonth += [df['month'].iloc[valid]]\n                outplant += [device[i]]\n            else:\n                if tmp == 1:\n                    tmp = 13\n                k = valid - 1\n                while k < valid:\n                    if ((pd.isnull(df['last'].iloc[k]) == False) and ((tmp-1) == monthname)):\n                        break\n                    k -= 1\n                outvalue += [df['last'].iloc[k]]\n                outyear += [df['year'].iloc[k]]\n                outmonth += [df['month'].iloc[k]]\n                outplant += [device[i]]\n                if tmp == 13:\n                   tmp = 1\n        monthname = tmp \n        year = tmpyear    \n    \n    if ((monthname == tmp) and (tmpyear == year)):\n        count = l-1\n        if pd.isnull(df['last'].iloc[count]) != True:    \t\n            outvalue += [df['last'].iloc[count]]\n            outyear += [df['year'].iloc[count]]\n            outmonth += [df['month'].iloc[count]]\n            outplant += [device[i]]\n        else:\n            m = count - 1\n            while m < count:\n                if ((pd.isnull(df['last'].iloc[m]) == False) and (monthname == tmp)):\n                    break\n                m -= 1\n            outvalue += [df['last'].iloc[m]]\n            outyear += [df['year'].iloc[m]]\n            outmonth += [df['month'].iloc[m]]\n            outplant += [device[i]]\n\nout = [round(num, 2) for num in outvalue]\n\n#------------------------Month Cum calculation End------------------#\n\nnull = df[df['last'].isnull()].index.tolist()\nfor i in range(len(null)):\n    null_date = (df['Date_IST'].iloc[null[i]])\n\nepoch = []\n\nfor v in range(len(outvalue)):\n    #a_date = str(outyear[v]) + \"-\" + str(outmonth[v]) + \"-\" + \"01\" + \"T\" + \"00\" +\":\" +\"00\" + \":\" + \"00Z\n    ts = datetime.datetime(outyear[v],outmonth[v],1, 00, 00,00).timestamp()\n    ns = int(ts)\n    string = str(ns) + \"000\"\n    epoch = time.strftime(\"%Y-%m-%dT%H:%M:%SZ\", time.gmtime(int(string)/1000.0))\n    \n    data = [{\n        \"measurement\": dest_database_table,\n        \"tags\": {\n            \"plant\" : plant,\n            \"device\" : outplant[v],\n           \"meter_id\": \"75568\",\n           \"field\": \"EAE_Month\"\n             },\n        \"time\" : epoch,\n        \"fields\": {\n            \"value\" : out[v]\n            }\n        }]\n    print(data)\n    stat = os.system('influx bucket list --host '+influx_url+' --token '+influx_token+' --org '+organisation+' --name '+dest_database+' >> /dev/null')\n    if stat != 0:\n        stat = os.system('influx bucket create --host '+influx_url+' --token '+influx_token+' --org '+organisation+' --name '+dest_database+' >> /dev/null')\n    \n    write_api.write(dest_database, organisation, data)\n\n\n",
        "output": "str",
        "x": 360,
        "y": 1620,
        "wires": [
            [
                "9e6b09f110bb2c40"
            ]
        ]
    },
    {
        "id": "9e6b09f110bb2c40",
        "type": "file",
        "z": "266079b93877e06e",
        "name": "write file",
        "filename": "/home/iplon/EDAY_Month_egauge.py",
        "filenameType": "str",
        "appendNewline": false,
        "createDir": false,
        "overwriteFile": "true",
        "encoding": "none",
        "x": 540,
        "y": 1620,
        "wires": [
            [
                "ae8a26e4af791c47"
            ]
        ]
    },
    {
        "id": "ae8a26e4af791c47",
        "type": "exec",
        "z": "266079b93877e06e",
        "command": "python3 /home/iplon/EDAY_Month_egauge.py",
        "addpay": "payload",
        "append": "",
        "useSpawn": "true",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "",
        "x": 800,
        "y": 1620,
        "wires": [
            [
                "75358c2df0fd80ff"
            ],
            [],
            []
        ]
    },
    {
        "id": "5d18e9eade677d0b",
        "type": "comment",
        "z": "266079b93877e06e",
        "name": "Yearly value",
        "info": "",
        "x": 130,
        "y": 1720,
        "wires": []
    },
    {
        "id": "ea117ac041d7257f",
        "type": "template",
        "z": "266079b93877e06e",
        "name": "EDAY_Year_egauge",
        "field": "payload",
        "fieldType": "msg",
        "format": "python",
        "syntax": "mustache",
        "template": "import sys\nimport os\nimport time\nimport pytz\nimport calendar\nimport datetime\nimport pandas as pd\nfrom datetime import date\nfrom influxdb_client import InfluxDBClient, Point, WritePrecision, WriteOptions\nfrom influxdb_client.client.write_api import SYNCHRONOUS, ASYNCHRONOUS\n\ninflux_url=\"http://localhost:8087/\"\ninflux_token=\"pNNW_glBJ_PH_Elpft-l85BC570_MLlDJOo69DE5CERDSNovQI5z1GusUVL1qBadlMWRCHirPOWh92wdbk0vtg==\"\norganisation=\"Test\"\nsource_database=\"egaugemeter\"\nsource_database_table=\"report\"\ndest_database=\"egaugemeter\"\ndest_database_table=\"report\"\n\nclient = InfluxDBClient(url=influx_url, token=influx_token, org=organisation)\nwrite_api = client.write_api(write_options=SYNCHRONOUS)\nquery_api = client.query_api()\n\ntimestamp = (\"\"\"1640975400000 2240524800000\"\"\")\n#timestamp = (\"\"\"{{payload}}\"\"\")\nb = (timestamp.split())\nstart_time = time.strftime(\"%Y-%m-%dT%H:%M:%SZ\", time.gmtime(int(b[0])/1000.0))\nstop_time = time.strftime(\"%Y-%m-%dT%H:%M:%SZ\", time.gmtime(int(b[1])/1000.0))\n\ndef frame_influx_query(source_database, source_database_table, plant, device, field):\n    if source_database and source_database_table and plant and device and field:\n        query = ' from(bucket: \\\"'+source_database+'\\\")  |> range(start: '+start_time+', stop: '+stop_time+')  |> filter(fn: (r) => r[\"_measurement\"] == \\\"'+source_database_table+'\\\")  |> filter(fn: (r) => r[\"plant\"] == \\\"'+plant+'\\\")  |> filter(fn: (r) => r[\"device\"] == \\\"'+device+'\\\")  |> filter(fn: (r) => r[\"field\"] == \\\"'+field+'\\\")  |> filter(fn: (r) => r[\"_field\"] == \"value\")  |> yield(name: \"last\")'\n    return query\n\n\nplant = \"egauge75568\"\ndevice = ['EM']\nfield = \"EAE_Month\"\n\npd.set_option('display.max_columns', None)  \npd.set_option('display.max_rows', None) \n\npoints = []\noutvalue = []\noutyear = []\noutplant = []\n\nfor x in range(len(device)):\n    my_q_str = frame_influx_query(source_database, source_database_table, plant, device[x], field)\n    #print(my_q_str)\n    result = query_api.query(query=my_q_str)\n    points_day_array=[]\n    for table in result:\n        for record in table.records:\n            points_value = record.get_value()\n            points_time = time.strftime(\"%Y-%m-%dT%H:%M:%SZ\", time.gmtime(int(record.get_time().timestamp())))\n            points_day = {\n            \"time\": points_time,\n            \"last\": points_value\n            }\n            points_day_array.append(points_day)\n    df = pd.DataFrame(points_day_array)\n    #print(df)\n\n    pd.set_option('display.max_columns', None)  \n    pd.set_option('display.max_rows', None)  \n    df.time = pd.to_datetime(df.time)\n    df[\"Date_IST\"] = pd.to_datetime(df[\"time\"]) + pd.DateOffset(hours=5, minutes=30)\n    df['Cumulative Year'] = df.groupby(df['Date_IST'].dt.year)['last'].cumsum()\n    df['year'] = pd.to_datetime(df['Date_IST']).dt.year\n    year = df['year'].iloc[0]\n    l = len(df)\n    \n    #---------------Month Cum Calculation----------------#\n    for j in range(l):\n        tmpyear = df['year'].iloc[j]\n        if (tmpyear != year):\n            valid = j-1\n            if pd.isnull(df['Cumulative Year'].iloc[valid]) != True:\n                outvalue += [df['Cumulative Year'].iloc[valid]]\n                outyear += [df['year'].iloc[valid]]\n                outplant += [device[x]]\n            else:\n                k = valid - 1\n                while k < valid:\n                    if ((pd.isnull(df['Cumulative Year'].iloc[k]) == False) and ((tmpyear-1) == year)):\n                        break\n                    k -= 1\n                outvalue += [df['Cumulative Year'].iloc[k]]\n                outyear += [df['year'].iloc[k]]\n                outplant += [device[x]]\n                outplant += [device[x]] \n        year = tmpyear\n        \n    if (tmpyear == year):\n        count = l-1\n        if pd.isnull(df['Cumulative Year'].iloc[count]) != True:\n            outvalue += [df['Cumulative Year'].iloc[count]]\n            outyear += [df['year'].iloc[count]]\n            outplant += [device[x]]\n        else:\n            m = count - 1\n            while m < count:\n                if ((pd.isnull(df['Cumulative Year'].iloc[m]) == False) and (year == tmpyear)):\n                    break\n                m -= 1\n            outvalue += [df['Cumulative Year'].iloc[m]]\n            outyear += [df['year'].iloc[m]]\n            outplant += [device[x]]\n\nout = [round(num, 2) for num in outvalue]\n\n#------------------------Month Cum calculation End------------------#\n\nnull = df[df['Cumulative Year'].isnull()].index.tolist()\nfor i in range(len(null)):\n    null_date = (df['Date_IST'].iloc[null[i]])\n\nepoch = []\n\nfor v in range(len(outvalue)):\n    ts = datetime.datetime(outyear[v],1,1, 00, 00,00).timestamp()\n    ns = int(ts)\n    string = str(ns) + \"000\"\n    epoch = time.strftime(\"%Y-%m-%dT%H:%M:%SZ\", time.gmtime(int(string)/1000.0))    \n\n    data = [{\n        \"measurement\": dest_database_table,\n        \"tags\": {\n            \"plant\": plant,\n            \"device\" : outplant[v],\n           \"meter_id\": \"75568\",\n           \"field\": \"EAE_Year\"\n             },\n        \"time\": epoch,\n        \"fields\": {\n            \"value\": out[v]\n            }\n        }]\n    print(data)\n    stat = os.system('influx bucket list --host '+influx_url+' --token '+influx_token+' --org '+organisation+' --name '+dest_database+' >> /dev/null')\n    if stat != 0:\n        stat = os.system('influx bucket create --host '+influx_url+' --token '+influx_token+' --org '+organisation+' --name '+dest_database+' >> /dev/null')\n    \n    write_api.write(dest_database, organisation, data)\n",
        "output": "str",
        "x": 360,
        "y": 1780,
        "wires": [
            [
                "e762955045bb6aee"
            ]
        ]
    },
    {
        "id": "e762955045bb6aee",
        "type": "file",
        "z": "266079b93877e06e",
        "name": "write file",
        "filename": "/home/iplon/EDAY_Year_egauge.py",
        "filenameType": "str",
        "appendNewline": false,
        "createDir": false,
        "overwriteFile": "true",
        "encoding": "none",
        "x": 540,
        "y": 1780,
        "wires": [
            [
                "e85b229df5f18428"
            ]
        ]
    },
    {
        "id": "e85b229df5f18428",
        "type": "exec",
        "z": "266079b93877e06e",
        "command": "python3 /home/iplon/EDAY_Year_egauge.py",
        "addpay": "payload",
        "append": "",
        "useSpawn": "true",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "",
        "x": 790,
        "y": 1780,
        "wires": [
            [
                "6a56bb76489e4667"
            ],
            [],
            []
        ]
    },
    {
        "id": "36c0cf8745c8f109",
        "type": "debug",
        "z": "266079b93877e06e",
        "name": "debug 151",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 490,
        "y": 980,
        "wires": []
    },
    {
        "id": "2207092d94a91e88",
        "type": "debug",
        "z": "266079b93877e06e",
        "name": "debug 152",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 990,
        "y": 1480,
        "wires": []
    },
    {
        "id": "75358c2df0fd80ff",
        "type": "debug",
        "z": "266079b93877e06e",
        "name": "debug 153",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1090,
        "y": 1620,
        "wires": []
    },
    {
        "id": "6a56bb76489e4667",
        "type": "debug",
        "z": "266079b93877e06e",
        "name": "debug 154",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1070,
        "y": 1780,
        "wires": []
    },
    {
        "id": "646f96d7d77c43c6",
        "type": "cronplus",
        "z": "266079b93877e06e",
        "name": "",
        "outputField": "payload",
        "timeZone": "",
        "persistDynamic": false,
        "commandResponseMsgOutput": "output1",
        "outputs": 1,
        "options": [
            {
                "name": "schedule1",
                "topic": "topic1",
                "payloadType": "default",
                "payload": "",
                "expressionType": "cron",
                "expression": "0 0 12 * * *",
                "location": "",
                "offset": "0",
                "solarType": "all",
                "solarEvents": "sunrise,sunset"
            }
        ],
        "x": 140,
        "y": 1480,
        "wires": [
            [
                "d3b0432324df9d61"
            ]
        ]
    },
    {
        "id": "6e4501c8f31d1f3d",
        "type": "cronplus",
        "z": "266079b93877e06e",
        "name": "",
        "outputField": "payload",
        "timeZone": "",
        "persistDynamic": false,
        "commandResponseMsgOutput": "output1",
        "outputs": 1,
        "options": [
            {
                "name": "schedule1",
                "topic": "topic1",
                "payloadType": "default",
                "payload": "",
                "expressionType": "cron",
                "expression": "0 0 12 * * *",
                "location": "",
                "offset": "0",
                "solarType": "all",
                "solarEvents": "sunrise,sunset"
            }
        ],
        "x": 160,
        "y": 1620,
        "wires": [
            [
                "f0e0099eee4d1d05"
            ]
        ]
    },
    {
        "id": "95705698622437a3",
        "type": "cronplus",
        "z": "266079b93877e06e",
        "name": "",
        "outputField": "payload",
        "timeZone": "",
        "persistDynamic": false,
        "commandResponseMsgOutput": "output1",
        "outputs": 1,
        "options": [
            {
                "name": "schedule1",
                "topic": "topic1",
                "payloadType": "default",
                "payload": "",
                "expressionType": "cron",
                "expression": "0 0 12 * * *",
                "location": "",
                "offset": "0",
                "solarType": "all",
                "solarEvents": "sunrise,sunset"
            }
        ],
        "x": 140,
        "y": 1780,
        "wires": [
            [
                "ea117ac041d7257f"
            ]
        ]
    },
    {
        "id": "1906abcebe93b1f9",
        "type": "comment",
        "z": "266079b93877e06e",
        "name": "Communication time",
        "info": "",
        "x": 150,
        "y": 620,
        "wires": []
    },
    {
        "id": "84e807503c4ea1f5",
        "type": "comment",
        "z": "266079b93877e06e",
        "name": "History data (Initial only)",
        "info": "",
        "x": 160,
        "y": 60,
        "wires": []
    },
    {
        "id": "ea033c2c0a093e07",
        "type": "comment",
        "z": "266079b93877e06e",
        "name": "Refill EAE_DAY",
        "info": "",
        "x": 140,
        "y": 220,
        "wires": []
    },
    {
        "id": "44e88782119e3fc9",
        "type": "template",
        "z": "266079b93877e06e",
        "name": "RefillEDay_egauge",
        "field": "payload",
        "fieldType": "msg",
        "format": "python",
        "syntax": "mustache",
        "template": "import sys\nimport os\nimport time\nimport pytz\nimport calendar\nimport datetime\nimport pandas as pd\nfrom datetime import date\nfrom influxdb_client.client.write_api import SYNCHRONOUS, ASYNCHRONOUS\nfrom influxdb_client import InfluxDBClient, Point, WritePrecision, WriteOptions\n\n#Influxdb Information\ninflux_url=\"http://localhost:8087/\"\ninflux_token=\"pNNW_glBJ_PH_Elpft-l85BC570_MLlDJOo69DE5CERDSNovQI5z1GusUVL1qBadlMWRCHirPOWh92wdbk0vtg==\"\norganisation=\"Test\"\nsource_database=\"egaugemeter\"\nsource_database_report=\"egaugemeter\"\nsource_database_report_table=\"report\"\ndest_database_report=\"egaugemeter\"\ndest_database_report_table=\"report\"\n\n#Plant Information\nplant = \"egauge\"\ndevice = ['egauge75568']\nfield = \"EAE_DAY\"\n_field = \"EAE_DAY\"\n\ndate_to_check = 2\n\nclient = InfluxDBClient(url=influx_url, token=influx_token, org=organisation)\nwrite_api = client.write_api(write_options=SYNCHRONOUS, debug=True)\nquery_api = client.query_api()\n\npd.set_option('display.max_columns', None)  \npd.set_option('display.max_rows', None)\n\nYear = []\nMonth = []\nDay = []\nDevice = []\nEAE_DAY = []\nliveepoch = []\n\ndef frame_influx_query1(source_database_report, source_database_report_table, plant, device, _field, date_to_check):\n    if source_database_report and source_database_report_table and plant and device and _field:\n        #query = ' from(bucket: \\\"'+source_database_report+'\\\")  |> range(start: -'+date_to_check+'d)  |> filter(fn: (r) => r[\"_measurement\"] == \\\"'+source_database_report_table+'\\\")  |> filter(fn: (r) => r[\"p\"] == \\\"'+plant+'\\\")  |> filter(fn: (r) => r[\"d\"] == \\\"'+device+'\\\")  |> filter(fn: (r) => r[\"_field\"] == \"value\")  |> filter(fn: (r) => r[\"f\"] == \\\"'+_field+'\\\")  |> aggregateWindow(every: 1d, fn: mean, createEmpty: true)  |> yield(name: \"last\")'\n        query = ' from(bucket: \\\"'+source_database_report+'\\\")  |> range(start: -'+date_to_check+'d)  |> filter(fn: (r) => r[\"_measurement\"] == \\\"'+source_database_report_table+'\\\")  |> filter(fn: (r) => r[\"p\"] == \\\"'+plant+'\\\")  |> filter(fn: (r) => r[\"d\"] == \\\"'+device+'\\\")  |> filter(fn: (r) => r[\"_field\"] == \"value\")  |> filter(fn: (r) => r[\"f\"] == \\\"'+_field+'\\\")  |> yield(name: \"last\")'\n    return query\n\ndef frame_influx_query(source_database, plant, device, field, startTime, stopTime):\n    if source_database and plant and device and field and startTime and stopTime:\n       query = 'from(bucket: \\\"'+source_database+'\\\")  |> range(start: '+startTime+', stop: '+stopTime+')  |> filter(fn: (r) => r[\"_measurement\"] == \"v\") |> filter(fn: (r) => r[\"bd\"] == \\\"'+plant+'\\\") |> filter(fn: (r) => r[\"d\"] == \\\"'+device+'\\\") |> filter(fn: (r) => r[\"f\"] == \\\"'+field+'\\\") |> filter(fn: (r) => r[\"_field\"] == \"value\") |> yield(name: \"last\")'       \n    return query\n\ndef sending(df):\n    #print(df)\n    for j in range(len(df)):\n        global Year\n        global Month\n        global Day \n        global Device\n        global EAE_DAY\n        global liveepoch\n        Year += [df['Year'].iloc[j]]\n        Month += [df['Month'].iloc[j]]\n        Day += [df['Day'].iloc[j]]\n        Device = [df['Device'].iloc[j]]\n        EAE_DAY += [df['EAE_DAY'].iloc[j]]\n        ts = datetime.datetime(Year[j],Month[j],Day[j], 00, 00,00).timestamp()\n        #ts = (calendar.timegm(Date_IST.timetuple()))\n        ns = int(ts)\n        string = str(ns) + \"000\"\n        liveepoch.append(time.strftime(\"%Y-%m-%dT%H:%M:%SZ\", time.gmtime(int(string)/1000.0)))\n\n        data = [{\n            \"measurement\":dest_database_report_table,\n            \"tags\": {\n                \"p\"  : plant,\n                \"iid\": \"5307\",\n                \"d\"  : Device[0],\n                \"f\"  : field\n                    },\n            \"time\" : liveepoch[j],\n            \"fields\": {\n                \"value\" : EAE_DAY[j]\n                }\n            }]   \n        print(data)\n        stat = os.system('influx bucket list --host '+influx_url+' --token '+influx_token+' --org '+organisation+' --name '+dest_database_report+' >> /dev/null')\n        if stat != 0:\n            stat = os.system('influx bucket create --host '+influx_url+' --token '+influx_token+' --org '+organisation+' --name '+dest_database_report+' >> /dev/null')\n    \n        write_api.write(dest_database_report, organisation, data)\n\n\nmiss = []\nfor t in range(len(device)):\n    points_day_array = []\n    my_q_str = frame_influx_query1(source_database_report, source_database_report_table, plant, device[t], _field, str(date_to_check))\n    #print(my_q_str)\n    result = query_api.query(query=my_q_str)\n    for table in result:\n        for record in table.records:\n            points_value = record.get_value()\n            points_time = time.strftime(\"%Y-%m-%dT%H:%M:%SZ\", time.gmtime(int(record.get_time().timestamp())))\n            points_day = {\n                \"time\": points_time,\n                \"last\": points_value\n                }\n            print(points_day)\n            points_day_array.append(points_day)\n    df_day = pd.DataFrame(points_day_array)\n    if df_day.empty or df_day.eq(0).any().any() or df_day.isnull().values.any():\n        miss.append(device[t])\nprint(miss)\n\nfor i in range(len(miss)):\n    points_day_array = []\n    for x in range(date_to_check, 0, -1):\n        checkDate = datetime.datetime.today() - datetime.timedelta(days=x)\n        q = (str(checkDate))\n        x = q.split('-')\n        un = x[2].split()\n        uniqueday = int(un[0])\n        uniquemonth = int(x[1])\n        uniqueyear = int(x[0])\n    \n        Stop_TS = int(datetime.datetime(uniqueyear, uniquemonth, uniqueday, 23, 55, 00).timestamp())\n        stopTime = time.strftime(\"%Y-%m-%dT%H:%M:%SZ\", time.gmtime(int(Stop_TS)))\n    \n        Start_TS = int(datetime.datetime(uniqueyear, uniquemonth, uniqueday, 00, 00, 00).timestamp())\n        startTime = time.strftime(\"%Y-%m-%dT%H:%M:%SZ\", time.gmtime(int(Start_TS)))\n\n        my_q_str = frame_influx_query(source_database, plant, miss[i], field, startTime, stopTime)\n        #print(my_q_str)\n        result = query_api.query(query=my_q_str)\n        for table in result:\n            for record in table.records:\n                #print(record)\n                points_value = record.get_value()\n                points_time = time.strftime(\"%Y-%m-%dT%H:%M:%SZ\", time.gmtime(int(record.get_time().timestamp())))\n                points_day = {\n                    \"time\": points_time,\n                    \"last\": points_value\n                    }\n            points_day_array.append(points_day)\n        df = pd.DataFrame(points_day_array)\n        #print(df)\n\n        if len(df) != 0:\n            df[\"Date_IST\"] = pd.to_datetime(df[\"time\"]) + pd.DateOffset(hours=5, minutes=30)\n            df.Date_IST = pd.to_datetime(df.Date_IST)\n            #df[\"Date_IST\"] = df[\"Date_IST\"].to_pydatetime()\n            df['day'] = pd.to_datetime(df['Date_IST']).dt.day\n            df['month'] = pd.to_datetime(df['Date_IST']).dt.month\n            df['year'] = pd.to_datetime(df['Date_IST']).dt.year\n            df = df.dropna() \n        \n            Month = df['month'].tolist()\n            Year = df['year'].tolist()\n            Day =  df['day'].tolist()\n            EAE_DAY =  df['last'].tolist()\n            Date_IST =  df['Date_IST'].tolist()\n        \n            df = pd.DataFrame(\n            {'Month': Month,\n            'Year': Year,\n            'Day': Day,\n            'EAE_DAY': EAE_DAY,\n            'Date_IST': Date_IST,\n            'Device': miss[i]})\n    #print(df)\n\n    sending(df)\n",
        "output": "str",
        "x": 330,
        "y": 300,
        "wires": [
            [
                "eb5a1217f3219317"
            ]
        ]
    },
    {
        "id": "eb5a1217f3219317",
        "type": "file",
        "z": "266079b93877e06e",
        "name": "write file",
        "filename": "RefillEDay_egauge.py",
        "filenameType": "str",
        "appendNewline": false,
        "createDir": false,
        "overwriteFile": "true",
        "encoding": "none",
        "x": 520,
        "y": 300,
        "wires": [
            [
                "46368ff84d7bf1de"
            ]
        ]
    },
    {
        "id": "46368ff84d7bf1de",
        "type": "exec",
        "z": "266079b93877e06e",
        "command": "python3 RefillEDay_egauge.py",
        "addpay": "payload",
        "append": "",
        "useSpawn": "true",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "",
        "x": 770,
        "y": 300,
        "wires": [
            [
                "62426a202bddb00e"
            ],
            [],
            []
        ]
    },
    {
        "id": "d4ac28a4650a446c",
        "type": "inject",
        "z": "266079b93877e06e",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 140,
        "y": 300,
        "wires": [
            [
                "44e88782119e3fc9"
            ]
        ]
    },
    {
        "id": "2cfc21d1b69477b7",
        "type": "function",
        "z": "266079b93877e06e",
        "name": "Meter API's",
        "func": "// Array of URLs\nvar urls = [\n    \"https://egauge75569.d.egauge.net/cgi-bin/egauge-show?m&s=14&a&c&f=1685318400\",\n    \"https://egauge75570.d.egauge.net/cgi-bin/egauge-show?m&s=14&a&c&f=1685318400\",\n    \"https://egauge77153.d.egauge.net/cgi-bin/egauge-show?m&s=14&a&c&f=1685318400\",\n    \"https://egauge77154.d.egauge.net/cgi-bin/egauge-show?m&s=14&a&c&f=1685318400\",\n    \"https://egauge83559.d.egauge.net/cgi-bin/egauge-show?m&s=14&a&c&f=1685318400\",\n    \"https://egauge75568.d.egauge.net/cgi-bin/egauge-show?m&s=14&a&c&f=1685318400\"\n];\n\n// Set the array of URLs as a property of the message\nmsg.payload = urls;\n\n// Return the modified message\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 330,
        "y": 120,
        "wires": [
            [
                "dc7af6a751394c16"
            ]
        ]
    },
    {
        "id": "15b9c2f0e753cd69",
        "type": "influxdb batch",
        "z": "266079b93877e06e",
        "influxdb": "bd932ff2.1cb77",
        "precision": "",
        "retentionPolicy": "",
        "name": "",
        "database": "database",
        "precisionV18FluxV20": "s",
        "retentionPolicyV18Flux": "",
        "org": "Test",
        "bucket": "egaugemeter",
        "x": 1310,
        "y": 120,
        "wires": []
    },
    {
        "id": "db8313d8bf875356",
        "type": "inject",
        "z": "266079b93877e06e",
        "name": "",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 180,
        "y": 120,
        "wires": [
            [
                "2cfc21d1b69477b7"
            ]
        ]
    },
    {
        "id": "b516f6cbadd8ece1",
        "type": "http request",
        "z": "266079b93877e06e",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 770,
        "y": 120,
        "wires": [
            [
                "1d84fd6ba3ad6c66"
            ]
        ]
    },
    {
        "id": "dc7af6a751394c16",
        "type": "split",
        "z": "266079b93877e06e",
        "name": "",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 470,
        "y": 120,
        "wires": [
            [
                "3fc423b31f43982e"
            ]
        ]
    },
    {
        "id": "3fc423b31f43982e",
        "type": "change",
        "z": "266079b93877e06e",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "url",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 610,
        "y": 120,
        "wires": [
            [
                "b516f6cbadd8ece1"
            ]
        ]
    },
    {
        "id": "1d84fd6ba3ad6c66",
        "type": "csv",
        "z": "266079b93877e06e",
        "name": "",
        "sep": ",",
        "hdrin": true,
        "hdrout": "none",
        "multi": "mult",
        "ret": "\\n",
        "temp": "",
        "skip": "0",
        "strings": true,
        "include_empty_strings": "",
        "include_null_values": true,
        "x": 930,
        "y": 120,
        "wires": [
            [
                "7f89c3960358c3fe"
            ]
        ]
    },
    {
        "id": "7f89c3960358c3fe",
        "type": "function",
        "z": "266079b93877e06e",
        "name": "Influx 2.0",
        "func": "// Extract the meter name from API\nvar url = msg.url\nvar parsedValue = url.split(\"https://\")[1].split(\".\")[0];\n\nfor (var i = 0; i < msg.payload.length; i++) {\n    var dateUTC = new Date(msg.payload[i][\"Date & Time\"]).getTime();\n    var obj = {};\n    obj.payload = [{\n        measurement: \"v\",\n        fields: {\n            value: msg.payload[i][\"Generation [kWh]\"],\n            text: \"0\",\n            qu: \"0\"\n        },\n        tags: {\n            \n            b: \"B\",\n            bd: \"B_EM\",\n            d: parsedValue,\n            dd: \"EM\",\n            dt: \"EM\",\n            f: \"EAE\",\n            fd: \"generation\",\n            h: parsedValue,\n            iid: parsedValue,\n            m: \"1\",\n            p: \"egauge\",\n            u: \"kwh\"\n        },\n        timestamp: dateUTC\n    }];\n    node.send(obj);\n}\nreturn null;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1080,
        "y": 120,
        "wires": [
            [
                "15b9c2f0e753cd69",
                "a46ffc7c9f50397e"
            ]
        ]
    },
    {
        "id": "b129ccddda95c5c1",
        "type": "cronplus",
        "z": "266079b93877e06e",
        "name": "",
        "outputField": "payload",
        "timeZone": "Asia/Kolkata",
        "persistDynamic": false,
        "commandResponseMsgOutput": "output1",
        "outputs": 1,
        "options": [
            {
                "name": "schedule1",
                "topic": "topic1",
                "payloadType": "date",
                "payload": "",
                "expressionType": "cron",
                "expression": "0 50 23 * * * *",
                "location": "",
                "offset": "0",
                "solarType": "all",
                "solarEvents": "sunrise,sunset"
            }
        ],
        "x": 160,
        "y": 360,
        "wires": [
            []
        ]
    },
    {
        "id": "62426a202bddb00e",
        "type": "debug",
        "z": "266079b93877e06e",
        "name": "debug 177",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1050,
        "y": 320,
        "wires": []
    },
    {
        "id": "5ee05ab4d071a6d8",
        "type": "function",
        "z": "266079b93877e06e",
        "name": "Meter API's",
        "func": "// Array of URLs\nvar urls = [\n    \"https://egauge75569.d.egauge.net/cgi-bin/egauge-show?m&s=14&a&n=97&c\",\n    \"https://egauge75570.d.egauge.net/cgi-bin/egauge-show?m&s=14&a&n=97&c\",\n    \"https://egauge77153.d.egauge.net/cgi-bin/egauge-show?m&s=14&a&n=97&c\",\n    \"https://egauge77154.d.egauge.net/cgi-bin/egauge-show?m&s=14&a&n=97&c\",\n    \"https://egauge83559.d.egauge.net/cgi-bin/egauge-show?m&s=14&a&n=97&c\",\n    \"https://egauge75568.d.egauge.net/cgi-bin/egauge-show?m&s=14&a&n=97&c\"\n];\n\n// Set the array of URLs as a property of the message\nmsg.payload = urls;\n\n// Return the modified message\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 310,
        "y": 520,
        "wires": [
            [
                "fa7c23f7c7bafe43"
            ]
        ]
    },
    {
        "id": "28ea618726941f0e",
        "type": "influxdb batch",
        "z": "266079b93877e06e",
        "influxdb": "bd932ff2.1cb77",
        "precision": "",
        "retentionPolicy": "",
        "name": "",
        "database": "database",
        "precisionV18FluxV20": "s",
        "retentionPolicyV18Flux": "",
        "org": "Test",
        "bucket": "egaugemeter",
        "x": 1290,
        "y": 520,
        "wires": []
    },
    {
        "id": "0c0715e998b46c43",
        "type": "http request",
        "z": "266079b93877e06e",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 750,
        "y": 520,
        "wires": [
            [
                "fd7dfa525b9bd4c7"
            ]
        ]
    },
    {
        "id": "fa7c23f7c7bafe43",
        "type": "split",
        "z": "266079b93877e06e",
        "name": "",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 450,
        "y": 520,
        "wires": [
            [
                "aba48d6e4391e297"
            ]
        ]
    },
    {
        "id": "aba48d6e4391e297",
        "type": "change",
        "z": "266079b93877e06e",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "url",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 590,
        "y": 520,
        "wires": [
            [
                "0c0715e998b46c43"
            ]
        ]
    },
    {
        "id": "fd7dfa525b9bd4c7",
        "type": "csv",
        "z": "266079b93877e06e",
        "name": "",
        "sep": ",",
        "hdrin": true,
        "hdrout": "none",
        "multi": "mult",
        "ret": "\\n",
        "temp": "",
        "skip": "0",
        "strings": true,
        "include_empty_strings": "",
        "include_null_values": true,
        "x": 910,
        "y": 520,
        "wires": [
            [
                "6cbc6e30e4a12111"
            ]
        ]
    },
    {
        "id": "6cbc6e30e4a12111",
        "type": "function",
        "z": "266079b93877e06e",
        "name": "Influx 2.0",
        "func": "// Extract the meter name from API\nvar url = msg.url\nvar parsedValue = url.split(\"https://\")[1].split(\".\")[0];\n\nfor (var i = 0; i < msg.payload.length; i++) {\n    var dateUTC = new Date(msg.payload[i][\"Date & Time\"]).getTime();\n    var obj = {};\n    obj.payload = [{\n        measurement: \"v\",\n        fields: {\n            value: msg.payload[i][\"Generation [kWh]\"],\n            text: \"0\",\n            qu: \"0\"\n        },\n        tags: {\n            \n            b: \"B\",\n            bd: \"B_EM\",\n            d: parsedValue,\n            dd: \"EM\",\n            dt: \"EM\",\n            f: \"EAE\",\n            fd: \"generation\",\n            h: parsedValue,\n            iid: parsedValue,\n            m: \"1\",\n            p: \"egauge\",\n            u: \"kwh\"\n        },\n        timestamp: dateUTC\n    }];\n    node.send(obj);\n}\nreturn null;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1060,
        "y": 520,
        "wires": [
            [
                "28ea618726941f0e",
                "a340986ab01c4863"
            ]
        ]
    },
    {
        "id": "a46ffc7c9f50397e",
        "type": "debug",
        "z": "266079b93877e06e",
        "name": "debug 178",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1190,
        "y": 200,
        "wires": []
    },
    {
        "id": "a340986ab01c4863",
        "type": "debug",
        "z": "266079b93877e06e",
        "name": "debug 179",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1250,
        "y": 600,
        "wires": []
    },
    {
        "id": "c09e772461be733b",
        "type": "function",
        "z": "266079b93877e06e",
        "name": "Meter API's",
        "func": "// Array of URLs\nvar urls = [\n    \"https://egauge75569.d.egauge.net/cgi-bin/egauge-show?m&a&n=1&c\",\n    \"https://egauge75570.d.egauge.net/cgi-bin/egauge-show?m&a&n=1&c\",\n    \"https://egauge77153.d.egauge.net/cgi-bin/egauge-show?m&a&n=1&c\",\n    \"https://egauge77154.d.egauge.net/cgi-bin/egauge-show?m&a&n=1&c\",\n    \"https://egauge83559.d.egauge.net/cgi-bin/egauge-show?m&a&n=1&c\",\n    \"https://egauge75568.d.egauge.net/cgi-bin/egauge-show?m&a&n=1&c\"\n];\n\n// Set the array of URLs as a property of the message\nmsg.payload = urls;\n\n// Return the modified message\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 310,
        "y": 680,
        "wires": [
            [
                "0870ec952214b2d1"
            ]
        ]
    },
    {
        "id": "91779ced3f25df54",
        "type": "influxdb batch",
        "z": "266079b93877e06e",
        "influxdb": "bd932ff2.1cb77",
        "precision": "",
        "retentionPolicy": "",
        "name": "",
        "database": "database",
        "precisionV18FluxV20": "s",
        "retentionPolicyV18Flux": "",
        "org": "Test",
        "bucket": "egaugemeter",
        "x": 1290,
        "y": 680,
        "wires": []
    },
    {
        "id": "6f16baa25fbac8a2",
        "type": "inject",
        "z": "266079b93877e06e",
        "name": "",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 160,
        "y": 680,
        "wires": [
            [
                "c09e772461be733b"
            ]
        ]
    },
    {
        "id": "c5d74ee2bfb6e4c0",
        "type": "http request",
        "z": "266079b93877e06e",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 750,
        "y": 680,
        "wires": [
            [
                "a6d7b7aadbf46ca5"
            ]
        ]
    },
    {
        "id": "0870ec952214b2d1",
        "type": "split",
        "z": "266079b93877e06e",
        "name": "",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 450,
        "y": 680,
        "wires": [
            [
                "735f943734f558d5"
            ]
        ]
    },
    {
        "id": "735f943734f558d5",
        "type": "change",
        "z": "266079b93877e06e",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "url",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 590,
        "y": 680,
        "wires": [
            [
                "c5d74ee2bfb6e4c0"
            ]
        ]
    },
    {
        "id": "a6d7b7aadbf46ca5",
        "type": "csv",
        "z": "266079b93877e06e",
        "name": "",
        "sep": ",",
        "hdrin": true,
        "hdrout": "none",
        "multi": "mult",
        "ret": "\\n",
        "temp": "",
        "skip": "0",
        "strings": true,
        "include_empty_strings": "",
        "include_null_values": true,
        "x": 910,
        "y": 680,
        "wires": [
            [
                "0f0df035640d20bd"
            ]
        ]
    },
    {
        "id": "0f0df035640d20bd",
        "type": "function",
        "z": "266079b93877e06e",
        "name": "Influx 2.0",
        "func": "// Extract the meter name from API\nvar url = msg.url\nvar parsedValue = url.split(\"https://\")[1].split(\".\")[0];\n\nfor (var i = 0; i < msg.payload.length; i++) {\n    var dateUTC = new Date(msg.payload[i][\"Date & Time\"]).getTime(); \n    var obj = {};\n    obj.payload = [{\n        measurement: \"v\",\n        fields: {\n            value: dateUTC,\n            text: \"0\",\n            qu: \"0\"\n        },\n        tags: {\n            \n            b: \"B\",\n            bd: \"B_EM\",\n            d: parsedValue,\n            dd: \"EM\",\n            dt: \"EM\",\n            f: \"COMMUNICATION_TIME\",\n            fd: \"COMMUNICATION_TIME\",\n            h: parsedValue,\n            iid: parsedValue,\n            m: \"1\",\n            p: \"egauge\",\n            u: \"\"\n        },\n        timestamp: dateUTC\n    }];\n    node.send(obj);\n}\nreturn null;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1060,
        "y": 680,
        "wires": [
            [
                "91779ced3f25df54",
                "0c2de0759fc2d8d3"
            ]
        ]
    },
    {
        "id": "0c2de0759fc2d8d3",
        "type": "debug",
        "z": "266079b93877e06e",
        "name": "debug 180",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1250,
        "y": 760,
        "wires": []
    },
    {
        "id": "3176ae5fdf76b8ca",
        "type": "cronplus",
        "z": "266079b93877e06e",
        "name": "",
        "outputField": "payload",
        "timeZone": "Asia/Kolkata",
        "persistDynamic": false,
        "commandResponseMsgOutput": "output1",
        "outputs": 1,
        "options": [
            {
                "name": "schedule1",
                "topic": "topic1",
                "payloadType": "date",
                "payload": "",
                "expressionType": "cron",
                "expression": "0 00 00 * * * *",
                "location": "",
                "offset": "0",
                "solarType": "all",
                "solarEvents": "sunrise,sunset"
            }
        ],
        "x": 140,
        "y": 520,
        "wires": [
            [
                "5ee05ab4d071a6d8"
            ]
        ]
    },
    {
        "id": "639d1aeade069a2c",
        "type": "inject",
        "z": "266079b93877e06e",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 140,
        "y": 860,
        "wires": [
            [
                "94c2bb4adaa3b46e"
            ]
        ]
    },
    {
        "id": "40a8641556de5807",
        "type": "comment",
        "z": "c13a53cc905942bf",
        "name": "History data (Initial only)",
        "info": "",
        "x": 140,
        "y": 60,
        "wires": []
    },
    {
        "id": "17272d605270c781",
        "type": "function",
        "z": "c13a53cc905942bf",
        "name": "Meter API's",
        "func": "// Array of URLs\nvar urls = [\n    \"https://egauge75569.d.egauge.net/cgi-bin/egauge-show?d&a&c\",\n    //\"https://egauge75570.d.egauge.net/cgi-bin/egauge-show?d&a&c\",\n    //\"https://egauge77153.d.egauge.net/cgi-bin/egauge-show?d&a&c\",\n    //\"https://egauge77154.d.egauge.net/cgi-bin/egauge-show?d&a&c\",\n    //\"https://egauge83559.d.egauge.net/cgi-bin/egauge-show?d&a&c\",\n    //\"https://egauge75568.d.egauge.net/cgi-bin/egauge-show?d&a&c\"\n];\n\n// Set the array of URLs as a property of the message\nmsg.payload = urls;\n\n// Return the modified message\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 310,
        "y": 120,
        "wires": [
            [
                "65f22a4cbfad8af2"
            ]
        ]
    },
    {
        "id": "0987a1bb0c664bb1",
        "type": "influxdb batch",
        "z": "c13a53cc905942bf",
        "influxdb": "bd932ff2.1cb77",
        "precision": "",
        "retentionPolicy": "",
        "name": "",
        "database": "database",
        "precisionV18FluxV20": "s",
        "retentionPolicyV18Flux": "",
        "org": "Test",
        "bucket": "egaugemeter",
        "x": 1290,
        "y": 120,
        "wires": []
    },
    {
        "id": "6b97fb720a3fbdf6",
        "type": "inject",
        "z": "c13a53cc905942bf",
        "name": "",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 160,
        "y": 120,
        "wires": [
            [
                "17272d605270c781"
            ]
        ]
    },
    {
        "id": "a30a97039bd07c71",
        "type": "http request",
        "z": "c13a53cc905942bf",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 750,
        "y": 120,
        "wires": [
            [
                "f37a2fbd423ab7b6"
            ]
        ]
    },
    {
        "id": "65f22a4cbfad8af2",
        "type": "split",
        "z": "c13a53cc905942bf",
        "name": "",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 450,
        "y": 120,
        "wires": [
            [
                "3610eb87a620f84d"
            ]
        ]
    },
    {
        "id": "3610eb87a620f84d",
        "type": "change",
        "z": "c13a53cc905942bf",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "url",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 590,
        "y": 120,
        "wires": [
            [
                "a30a97039bd07c71"
            ]
        ]
    },
    {
        "id": "f37a2fbd423ab7b6",
        "type": "csv",
        "z": "c13a53cc905942bf",
        "name": "",
        "sep": ",",
        "hdrin": true,
        "hdrout": "none",
        "multi": "mult",
        "ret": "\\n",
        "temp": "",
        "skip": "0",
        "strings": true,
        "include_empty_strings": "",
        "include_null_values": true,
        "x": 910,
        "y": 120,
        "wires": [
            [
                "2f387a1ac690c0c5"
            ]
        ]
    },
    {
        "id": "2f387a1ac690c0c5",
        "type": "function",
        "z": "c13a53cc905942bf",
        "name": "Influx 2.0",
        "func": "// Extract the meter name from API\nvar url = msg.url\nvar parsedValue = url.split(\"https://\")[1].split(\".\")[0];\n\nfor (var i = 0; i < msg.payload.length; i++) {\n    var dateUTC = new Date(msg.payload[i][\"Date & Time\"]).getTime();\n    var obj = {};\n    obj.payload = [{\n        measurement: \"v\",\n        fields: {\n            value: msg.payload[i][\"Generation [kWh]\"],\n            text: \"0\",\n            qu: \"0\"\n        },\n        tags: {\n            \n            b: \"B\",\n            bd: \"B_EM\",\n            d: parsedValue,\n            dd: \"EM\",\n            dt: \"EM\",\n            f: \"EAE\",\n            fd: \"generation\",\n            h: parsedValue,\n            iid: parsedValue,\n            m: \"1\",\n            p: \"egauge\",\n            u: \"kwh\"\n        },\n        timestamp: dateUTC\n    }];\n    node.send(obj);\n}\nreturn null;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1060,
        "y": 120,
        "wires": [
            [
                "0987a1bb0c664bb1",
                "0df6a1ef2f5bbcbd"
            ]
        ]
    },
    {
        "id": "0df6a1ef2f5bbcbd",
        "type": "debug",
        "z": "c13a53cc905942bf",
        "name": "debug 181",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1170,
        "y": 200,
        "wires": []
    },
    {
        "id": "31e2f09c3f62b483",
        "type": "function",
        "z": "c13a53cc905942bf",
        "name": "cum_edc",
        "func": "// Install the influxdb-client package using npm:\n// npm install influxdb-client\n\nconst { InfluxDB } = require('@influxdata/influxdb-client');\n\n// Create a new InfluxDB client instance\nconst influxDBURL = 'http://localhost:8087'; // Replace with your InfluxDB URL\nconst influxDBToken = 'pNNW_glBJ_PH_Elpft-l85BC570_MLlDJOo69DE5CERDSNovQI5z1GusUVL1qBadlMWRCHirPOWh92wdbk0vtg=='; // Replace with your InfluxDB token\nconst influxDBOrg = 'Test'; // Replace with your InfluxDB organization\nconst influxDBBucket = 'egaugemeter'; // Replace with your InfluxDB bucket\n\nconst client = new InfluxDB({ url: influxDBURL, token: influxDBToken });\n\nvar query = [\n    'from(bucket: \"egaugemeter\") |> range(start: -3d) |> filter(fn: (r) => r[\"_measurement\"] == \"v\") |> filter(fn: (r) => r[\"p\"] == \"egauge\") |> filter(fn: (r) => r[\"d\"] == \"egauge75568\") |> filter(fn: (r) => r[\"f\"] == \"EAE\") |> filter(fn: (r) => r[\"_field\"] == \"value\") |> aggregateWindow(every: 1d, fn: last, createEmpty: false) |> yield(name: \"EAEMIN1\")',\n    'from(bucket: \"egaugemeter\") |> range(start: -3d) |> filter(fn: (r) => r[\"_measurement\"] == \"v\") |> filter(fn: (r) => r[\"p\"] == \"egauge\") |> filter(fn: (r) => r[\"d\"] == \"egauge75569\") |> filter(fn: (r) => r[\"f\"] == \"EAE\") |> filter(fn: (r) => r[\"_field\"] == \"value\") |> aggregateWindow(every: 1d, fn: last, createEmpty: false) |> yield(name: \"EAEMIN2\")',\n    'from(bucket: \"egaugemeter\") |> range(start: -3d) |> filter(fn: (r) => r[\"_measurement\"] == \"v\") |> filter(fn: (r) => r[\"p\"] == \"egauge\") |> filter(fn: (r) => r[\"d\"] == \"egauge75570\") |> filter(fn: (r) => r[\"f\"] == \"EAE\") |> filter(fn: (r) => r[\"_field\"] == \"value\") |> aggregateWindow(every: 1d, fn: last, createEmpty: false) |> yield(name: \"EAEMIN3\")',\n    'from(bucket: \"egaugemeter\") |> range(start: -3d) |> filter(fn: (r) => r[\"_measurement\"] == \"v\") |> filter(fn: (r) => r[\"p\"] == \"egauge\") |> filter(fn: (r) => r[\"d\"] == \"egauge77153\") |> filter(fn: (r) => r[\"f\"] == \"EAE\") |> filter(fn: (r) => r[\"_field\"] == \"value\") |> aggregateWindow(every: 1d, fn: last, createEmpty: false) |> yield(name: \"EAEMIN4\")',\n    'from(bucket: \"egaugemeter\") |> range(start: -3d) |> filter(fn: (r) => r[\"_measurement\"] == \"v\") |> filter(fn: (r) => r[\"p\"] == \"egauge\") |> filter(fn: (r) => r[\"d\"] == \"egauge77154\") |> filter(fn: (r) => r[\"f\"] == \"EAE\") |> filter(fn: (r) => r[\"_field\"] == \"value\") |> aggregateWindow(every: 1d, fn: last, createEmpty: false) |> yield(name: \"EAEMIN5\")',\n    'from(bucket: \"egaugemeter\") |> range(start: -3d) |> filter(fn: (r) => r[\"_measurement\"] == \"v\") |> filter(fn: (r) => r[\"p\"] == \"egauge\") |> filter(fn: (r) => r[\"d\"] == \"egauge83559\") |> filter(fn: (r) => r[\"f\"] == \"EAE\") |> filter(fn: (r) => r[\"_field\"] == \"value\") |> aggregateWindow(every: 1d, fn: last, createEmpty: false) |> yield(name: \"EAEMIN6\")'\n];\n\nvar results = []; // Array to store the query results\n\n// Iterate over each query and execute them\nfor (var i = 0; i < query.length; i++) {\n    const fluxQuery = query[i];\n\n    // Execute the query and get the results\n    const queryApi = client.getQueryApi(influxDBOrg);\n    const queryPromise = queryApi.collectRows(fluxQuery, influxDBBucket);\n\n    // Push the query results to the array\n    results.push(queryPromise);\n}\n\n// Wait for all the query promises to resolve\nPromise.all(results)\n    .then((queryResults) => {\n        // Set the query results as a property of the message\n        msg.payload = queryResults;\n\n        // Return the modified message\n        return msg;\n    })\n    .catch((error) => {\n        // Handle any errors that occurred during the query execution\n        console.error('Error executing queries:', error);\n    });\n\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 240,
        "y": 300,
        "wires": [
            [
                "166e870872cb52fe"
            ]
        ]
    },
    {
        "id": "71463c1f4d4c2276",
        "type": "influxdb in",
        "z": "c13a53cc905942bf",
        "influxdb": "dd04d92d3d5b3211",
        "name": "egauge",
        "query": "",
        "rawOutput": false,
        "precision": "",
        "retentionPolicy": "",
        "org": "Test",
        "x": 520,
        "y": 300,
        "wires": [
            [
                "b06650c068b1b91b"
            ]
        ]
    },
    {
        "id": "f035a6652b93cc65",
        "type": "cronplus",
        "z": "c13a53cc905942bf",
        "name": "",
        "outputField": "payload",
        "timeZone": "",
        "persistDynamic": false,
        "commandResponseMsgOutput": "output1",
        "outputs": 1,
        "options": [
            {
                "name": "schedule1",
                "topic": "topic1",
                "payloadType": "date",
                "payload": "",
                "expressionType": "cron",
                "expression": "0 10 00 * * * *",
                "location": "",
                "offset": "0",
                "solarType": "all",
                "solarEvents": "sunrise,sunset"
            }
        ],
        "x": 180,
        "y": 360,
        "wires": [
            []
        ]
    },
    {
        "id": "d077e55125401c94",
        "type": "debug",
        "z": "c13a53cc905942bf",
        "name": "debug 182",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 970,
        "y": 420,
        "wires": []
    },
    {
        "id": "26ef34d0a667d244",
        "type": "function",
        "z": "c13a53cc905942bf",
        "name": "function 36",
        "func": "let plantObj\nplantObj = []\n{\n    var time = msg.payload[1]._time;\n    var eaemin = msg.payload[0]._value;\n    var eae = msg.payload[1]._value;\n    if (eae >= eaemin) {\n        var EAE_DAY = eae - eaemin\n    }\n    var obj =\n    {\n        time,\n        eaemin,\n        eae,\n        EAE_DAY\n    }\n    plantObj.push(obj)\n}\nmsg.payload = plantObj\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 720,
        "y": 300,
        "wires": [
            [
                "0e6dc1289c51850a",
                "4b76e6ddac70b778"
            ]
        ]
    },
    {
        "id": "0e6dc1289c51850a",
        "type": "function",
        "z": "c13a53cc905942bf",
        "name": "function 37",
        "func": "{\n    //var dateUTC = new Date(msg.payload[0].time).getTime();\n    var obj = {};\n    obj.payload = [{\n        measurement: \"v\",\n        fields: {\n            value: msg.payload[0].EAE_DAY,\n            text: \"0\",\n            qu: \"0\"\n        },\n        tags: {\n            meter_id: \"75568\",\n            plant: \"egauge75568\",\n            device: \"EM\",\n            field: \"EAE_DAY\"\n        },\n        //timestamp: dateUTC\n    }];\n    node.send(obj);\n}\nreturn null;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 900,
        "y": 300,
        "wires": [
            [
                "d077e55125401c94",
                "2d89030fb58d3533"
            ]
        ]
    },
    {
        "id": "4b76e6ddac70b778",
        "type": "debug",
        "z": "c13a53cc905942bf",
        "name": "debug 183",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 750,
        "y": 420,
        "wires": []
    },
    {
        "id": "2d89030fb58d3533",
        "type": "influxdb batch",
        "z": "c13a53cc905942bf",
        "influxdb": "bd932ff2.1cb77",
        "precision": "",
        "retentionPolicy": "",
        "name": "",
        "database": "database",
        "precisionV18FluxV20": "s",
        "retentionPolicyV18Flux": "",
        "org": "Test",
        "bucket": "egaugemeter",
        "x": 1170,
        "y": 300,
        "wires": []
    },
    {
        "id": "b06650c068b1b91b",
        "type": "debug",
        "z": "c13a53cc905942bf",
        "name": "debug 184",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 510,
        "y": 420,
        "wires": []
    },
    {
        "id": "4431f19123463ac6",
        "type": "inject",
        "z": "c13a53cc905942bf",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 100,
        "y": 300,
        "wires": [
            [
                "31e2f09c3f62b483"
            ]
        ]
    },
    {
        "id": "09c430988c48c4ce",
        "type": "comment",
        "z": "c13a53cc905942bf",
        "name": "EAE_DAY Calculation",
        "info": "",
        "x": 140,
        "y": 220,
        "wires": []
    },
    {
        "id": "166e870872cb52fe",
        "type": "split",
        "z": "c13a53cc905942bf",
        "name": "",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 390,
        "y": 200,
        "wires": [
            [
                "77af2f54d5f708e1"
            ]
        ]
    },
    {
        "id": "77af2f54d5f708e1",
        "type": "change",
        "z": "c13a53cc905942bf",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "influx",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 620,
        "y": 200,
        "wires": [
            [
                "71463c1f4d4c2276"
            ]
        ]
    },
    {
        "id": "171f94114efd1825",
        "type": "comment",
        "z": "c13a53cc905942bf",
        "name": "Communication time",
        "info": "",
        "x": 130,
        "y": 460,
        "wires": []
    },
    {
        "id": "0dcb3cf1d0af9ad9",
        "type": "function",
        "z": "c13a53cc905942bf",
        "name": "Meter API's",
        "func": "// Array of URLs\nvar urls = [\n    \"https://egauge75569.d.egauge.net/cgi-bin/egauge-show?m&a&n=1&c\",\n    \"https://egauge75570.d.egauge.net/cgi-bin/egauge-show?m&a&n=1&c\",\n    \"https://egauge77153.d.egauge.net/cgi-bin/egauge-show?m&a&n=1&c\",\n    \"https://egauge77154.d.egauge.net/cgi-bin/egauge-show?m&a&n=1&c\",\n    \"https://egauge83559.d.egauge.net/cgi-bin/egauge-show?m&a&n=1&c\",\n    \"https://egauge75568.d.egauge.net/cgi-bin/egauge-show?m&a&n=1&c\"\n];\n\n// Set the array of URLs as a property of the message\nmsg.payload = urls;\n\n// Return the modified message\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 290,
        "y": 520,
        "wires": [
            [
                "3004273498900615"
            ]
        ]
    },
    {
        "id": "7f9efc512570b040",
        "type": "influxdb batch",
        "z": "c13a53cc905942bf",
        "influxdb": "bd932ff2.1cb77",
        "precision": "",
        "retentionPolicy": "",
        "name": "",
        "database": "database",
        "precisionV18FluxV20": "s",
        "retentionPolicyV18Flux": "",
        "org": "Test",
        "bucket": "egaugemeter",
        "x": 1270,
        "y": 520,
        "wires": []
    },
    {
        "id": "9dff27ba6c3e5087",
        "type": "inject",
        "z": "c13a53cc905942bf",
        "name": "",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 140,
        "y": 520,
        "wires": [
            [
                "0dcb3cf1d0af9ad9"
            ]
        ]
    },
    {
        "id": "31eceba38559d3e1",
        "type": "http request",
        "z": "c13a53cc905942bf",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 730,
        "y": 520,
        "wires": [
            [
                "79196a065efd51ad"
            ]
        ]
    },
    {
        "id": "3004273498900615",
        "type": "split",
        "z": "c13a53cc905942bf",
        "name": "",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 430,
        "y": 520,
        "wires": [
            [
                "7564ca7f08c7480e"
            ]
        ]
    },
    {
        "id": "7564ca7f08c7480e",
        "type": "change",
        "z": "c13a53cc905942bf",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "url",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 570,
        "y": 520,
        "wires": [
            [
                "31eceba38559d3e1"
            ]
        ]
    },
    {
        "id": "79196a065efd51ad",
        "type": "csv",
        "z": "c13a53cc905942bf",
        "name": "",
        "sep": ",",
        "hdrin": true,
        "hdrout": "none",
        "multi": "mult",
        "ret": "\\n",
        "temp": "",
        "skip": "0",
        "strings": true,
        "include_empty_strings": "",
        "include_null_values": true,
        "x": 890,
        "y": 520,
        "wires": [
            [
                "f47e5bc0bd4a6b6e"
            ]
        ]
    },
    {
        "id": "f47e5bc0bd4a6b6e",
        "type": "function",
        "z": "c13a53cc905942bf",
        "name": "Influx 2.0",
        "func": "// Extract the meter name from API\nvar url = msg.url\nvar parsedValue = url.split(\"https://\")[1].split(\".\")[0];\n\nfor (var i = 0; i < msg.payload.length; i++) {\n    var dateUTC = new Date(msg.payload[i][\"Date & Time\"]).getTime(); \n    var obj = {};\n    obj.payload = [{\n        measurement: \"v\",\n        fields: {\n            value: dateUTC,\n            text: \"0\",\n            qu: \"0\"\n        },\n        tags: {\n            \n            b: \"B\",\n            bd: \"B_EM\",\n            d: parsedValue,\n            dd: \"EM\",\n            dt: \"EM\",\n            f: \"COMMUNICATION_TIME\",\n            fd: \"COMMUNICATION_TIME\",\n            h: parsedValue,\n            iid: parsedValue,\n            m: \"1\",\n            p: \"egauge\",\n            u: \"\"\n        },\n        timestamp: dateUTC\n    }];\n    node.send(obj);\n}\nreturn null;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1040,
        "y": 520,
        "wires": [
            [
                "7f9efc512570b040",
                "189723df66713a26"
            ]
        ]
    },
    {
        "id": "189723df66713a26",
        "type": "debug",
        "z": "c13a53cc905942bf",
        "name": "debug 185",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1230,
        "y": 600,
        "wires": []
    },
    {
        "id": "1c2df89d12874e32",
        "type": "template",
        "z": "c13a53cc905942bf",
        "name": "EDAY_egauge",
        "field": "payload",
        "fieldType": "msg",
        "format": "python",
        "syntax": "mustache",
        "template": "import sys\nimport os\nimport time\nimport pytz\nimport calendar\nimport datetime\nimport pandas as pd\nfrom datetime import date\nfrom influxdb_client.client.write_api import SYNCHRONOUS, ASYNCHRONOUS\nfrom influxdb_client import InfluxDBClient, Point, WritePrecision, WriteOptions\n\ntoday = date.today()\np = (str(today))\nx = p.split('-')\nuniqueday = int(x[2])\nuniquemonth = int(x[1])\nuniqueyear = int(x[0])\nts = datetime.datetime(uniqueyear,uniquemonth,uniqueday, 00, 00,00).timestamp()\nc = int(ts)\nFrom = (c-19800)\nTo = calendar.timegm(time.gmtime())\n\ninflux_url=\"http://localhost:8087/\"\ninflux_token=\"pNNW_glBJ_PH_Elpft-l85BC570_MLlDJOo69DE5CERDSNovQI5z1GusUVL1qBadlMWRCHirPOWh92wdbk0vtg==\"\norganisation=\"Test\"\nsource_database=\"egaugemeter\"\ndest_database=\"egaugemeter\"\n\nclient = InfluxDBClient(url=influx_url, token=influx_token, org=organisation)\nwrite_api = client.write_api(write_options=SYNCHRONOUS, debug=True)\nquery_api = client.query_api()\n\nplant = \"egauge75568\"\niGate_id = \"75568\"\ndevice = ['EM']\nfield = \"EAE_DAY\"\n\ndef frame_influx_query(source_database, plant, device, field):\n    if source_database and device and field:\n       query = 'from(bucket: \\\"'+source_database+'\\\")  |> range(start: -30m)  |> filter(fn: (r) => r[\"_measurement\"] == \"v\") |> filter(fn: (r) => r[\"plant\"] == \\\"'+plant+'\\\") |> filter(fn: (r) => r[\"device\"] == \\\"'+device+'\\\") |> filter(fn: (r) => r[\"field\"] == \\\"'+field+'\\\") |> filter(fn: (r) => r[\"_field\"] == \"value\") |> yield(name: \"last\")'\n       \n    return query\n\ndef sending(df):\n   Year = int(df['Year'])\n   Month = int(df['Month'])\n   Day = int(df['Day'])\n   Device = str(df['Device'])\n   EAE_DAY = float(df['EAE_DAY'])\n   #print(EAE_DAY)\n   x = Device.split(' ')\n   y = x[4]\n   z = y.split('\\n')\n   Dev = z[0]\n   ts = datetime.datetime(Year,Month,Day, 00, 00,00).timestamp()\n   #ts = (calendar.timegm(Date_IST.timetuple()))\n   ns = int(ts)\n   string = str(ns) + \"000\"\n   liveepoch = time.strftime(\"%Y-%m-%dT%H:%M:%SZ\", time.gmtime(int(string)/1000.0))\n   data = [{\n       \"measurement\":\"report\",\n       \"tags\": {\n           \"plant\" : plant,\n           \"meter_id\": \"75568\",\n           \"device\" : Dev,\n           \"field\": \"EAE_DAY\"\n               },\n       \"time\" : liveepoch,\n       \"fields\": {\n           \"value\" : EAE_DAY\n           }\n       }]\n   print(data)\n   stat = os.system('influx bucket list --host '+influx_url+' --token '+influx_token+' --org '+organisation+' --name '+dest_database+' >> /dev/null')\n   if stat != 0:\n       stat = os.system('influx bucket create --host '+influx_url+' --token '+influx_token+' --org '+organisation+' --name '+dest_database+' >> /dev/null')\n   \n   write_api.write(dest_database, organisation, data)\n\n\nfor i in range(len(device)):\n    points_day = []\n    my_q_str = frame_influx_query(source_database, plant, device[i], field)\n    print(my_q_str)\n    result = query_api.query(query=my_q_str)\n    for table in result:\n        for record in table.records:\n            points_value = record.get_value()\n            points_time = time.strftime(\"%Y-%m-%dT%H:%M:%SZ\", time.gmtime(int(record.get_time().timestamp())))\n    points_day = [{\n        \"time\": points_time,\n        \"last\": points_value\n        }]\n    df = pd.DataFrame(points_day)\n    #print(df)\n    if len(df) != 0:\n        df[\"Date_IST\"] = pd.to_datetime(df[\"time\"]) + pd.DateOffset(hours=5, minutes=30)\n        df.Date_IST = pd.to_datetime(df.Date_IST)\n        #df[\"Date_IST\"] = df[\"Date_IST\"].to_pydatetime()\n        df['day'] = pd.to_datetime(df['Date_IST']).dt.day\n        df['month'] = pd.to_datetime(df['Date_IST']).dt.month\n        df['year'] = pd.to_datetime(df['Date_IST']).dt.year\n        df = df.dropna()\n   \n        Month = df['month'].tolist()\n        Year = df['year'].tolist()\n        Day =  df['day'].tolist()\n        EAE_DAY =  df['last'].tolist()\n        Date_IST =  df['Date_IST'].tolist()\n\n        df = pd.DataFrame({\n        'Month': Month,\n        'Year': Year,\n        'Day': Day,\n        'EAE_DAY': EAE_DAY,\n        'Date_IST': Date_IST,\n        'Device':  device[i]})\n        #print(df)\n        sending(df)",
        "output": "str",
        "x": 320,
        "y": 700,
        "wires": [
            [
                "92fa014c09a9327a"
            ]
        ]
    },
    {
        "id": "92fa014c09a9327a",
        "type": "file",
        "z": "c13a53cc905942bf",
        "name": "write file",
        "filename": "/home/iplon/EDAY_egauge.py",
        "filenameType": "str",
        "appendNewline": false,
        "createDir": false,
        "overwriteFile": "true",
        "encoding": "none",
        "x": 480,
        "y": 700,
        "wires": [
            [
                "debb6095c578f218"
            ]
        ]
    },
    {
        "id": "debb6095c578f218",
        "type": "exec",
        "z": "c13a53cc905942bf",
        "command": "python3 /home/iplon/EDAY_egauge.py",
        "addpay": "payload",
        "append": "",
        "useSpawn": "true",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "",
        "x": 710,
        "y": 700,
        "wires": [
            [
                "f16f0688ab1542c7"
            ],
            [],
            []
        ]
    },
    {
        "id": "f0616858a9536aac",
        "type": "comment",
        "z": "c13a53cc905942bf",
        "name": "Daily value",
        "info": "",
        "x": 100,
        "y": 620,
        "wires": []
    },
    {
        "id": "4766971447829faf",
        "type": "comment",
        "z": "c13a53cc905942bf",
        "name": "Monthly value",
        "info": "",
        "x": 110,
        "y": 780,
        "wires": []
    },
    {
        "id": "ba4ac95b6fbaa96d",
        "type": "template",
        "z": "c13a53cc905942bf",
        "name": "EDAY_Month_egauge",
        "field": "payload",
        "fieldType": "msg",
        "format": "python",
        "syntax": "mustache",
        "template": "import sys\nimport os\nimport time\nimport pytz\nimport calendar\nimport datetime\nimport pandas as pd\nfrom datetime import date\nfrom influxdb_client import InfluxDBClient, Point, WritePrecision, WriteOptions\nfrom influxdb_client.client.write_api import SYNCHRONOUS, ASYNCHRONOUS\n\ninflux_url=\"http://localhost:8087/\"\ninflux_token=\"pNNW_glBJ_PH_Elpft-l85BC570_MLlDJOo69DE5CERDSNovQI5z1GusUVL1qBadlMWRCHirPOWh92wdbk0vtg==\"\norganisation=\"Test\"\nsource_database=\"egaugemeter\"\nsource_database_table=\"report\"\ndest_database=\"egaugemeter\"\ndest_database_table=\"report\"\n\nclient = InfluxDBClient(url=influx_url, token=influx_token, org=organisation)\nwrite_api = client.write_api(write_options=SYNCHRONOUS)\nquery_api = client.query_api()\n\ntimestamp = (\"\"\"1640975400000 2240524800000\"\"\")\n#timestamp = (\"\"\"{{payload}}\"\"\")\nb = (timestamp.split())\nstart_time = time.strftime(\"%Y-%m-%dT%H:%M:%SZ\", time.gmtime(int(b[0])/1000.0))\nstop_time = time.strftime(\"%Y-%m-%dT%H:%M:%SZ\", time.gmtime(int(b[1])/1000.0))\n\ndef frame_influx_query(source_database, source_database_table, plant, device, field):\n    if source_database and source_database_table and plant and field:\n        query = ' from(bucket: \\\"'+source_database+'\\\")  |> range(start: '+start_time+', stop: '+stop_time+')  |> filter(fn: (r) => r[\"_measurement\"] == \\\"'+source_database_table+'\\\")  |> filter(fn: (r) => r[\"plant\"] == \\\"'+plant+'\\\")  |> filter(fn: (r) => r[\"device\"] == \\\"'+device+'\\\")  |> filter(fn: (r) => r[\"field\"] == \\\"'+field+'\\\")  |> filter(fn: (r) => r[\"_field\"] == \"value\")  |> yield(name: \"last\")'\n    return query\n\n\nplant = \"egauge75568\"\ndevice = ['EM']\nfield = \"EAE_DAY\"\n\npoints = []\noutvalue = []\noutyear = []\noutmonth = []\noutplant = []\n\nfor i in range(len(device)):\n    my_q_str = frame_influx_query(source_database, source_database_table, plant, device[i], field)\n    #print(my_q_str)\n    result = query_api.query(query=my_q_str)\n    points_day_array=[]\n    for table in result:\n        for record in table.records:\n            points_value = record.get_value()\n            points_time = time.strftime(\"%Y-%m-%dT%H:%M:%SZ\", time.gmtime(int(record.get_time().timestamp())))\n            points_day = {\n            \"time\": points_time,\n            \"last\": points_value\n            }\n            points_day_array.append(points_day)\n    df = pd.DataFrame(points_day_array)\n    #print(df)\n\n    pd.set_option('display.max_columns', None)  \n    pd.set_option('display.max_rows', None)  \n    df.time = pd.to_datetime(df.time)\n    df[\"Date_IST\"] = pd.to_datetime(df[\"time\"]) + pd.DateOffset(hours=5, minutes=30)\n    df['Date'] = pd.to_datetime(df['Date_IST']).dt.date\n    df['Time'] = pd.to_datetime(df['Date_IST']).dt.time\n    df.Date = pd.to_datetime(df.Date)\n    df = df.groupby('Date').sum('last')\n    df = df.groupby(df.index.to_period('m')).cumsum().reset_index()\n    df1 = df.groupby('Date').sum('last')\n    df1 = df1.groupby(df1.index.to_period('y')).cumsum().reset_index()\n    df['month'] = pd.to_datetime(df['Date']).dt.month\n    df['year'] = pd.to_datetime(df['Date']).dt.year\n \n    monthname = df['month'].iloc[0]\n    year = df['year'].iloc[0]   \n    l = len(df)\n\n    #---------------Month Cum Calculation start----------------#\n    for j in range(l):\n        tmp = df['month'].iloc[j]\n        tmpyear = df['year'].iloc[j]\n        if ((monthname != tmp) and (tmpyear == year)):\n            valid = j-1\n            if pd.isnull(df['last'].iloc[valid]) != True:\n                outvalue += [df['last'].iloc[valid]]\n                outyear += [df['year'].iloc[valid]]\n                outmonth += [df['month'].iloc[valid]]\n                outplant += [device[i]]\n            else:\n                if tmp == 1:\n                    tmp = 13\n                k = valid - 1\n                while k < valid:\n                    if ((pd.isnull(df['last'].iloc[k]) == False) and ((tmp-1) == monthname)):\n                        break\n                    k -= 1\n                outvalue += [df['last'].iloc[k]]\n                outyear += [df['year'].iloc[k]]\n                outmonth += [df['month'].iloc[k]]\n                outplant += [device[i]]\n                if tmp == 13:\n                   tmp = 1\n        elif ((monthname != tmp) and (tmpyear != year)): \n            valid = j-1\n            if pd.isnull(df['last'].iloc[valid]) != True:\n                outvalue += [df['last'].iloc[valid]]\n                outyear += [df['year'].iloc[valid]]\n                outmonth += [df['month'].iloc[valid]]\n                outplant += [device[i]]\n            else:\n                if tmp == 1:\n                    tmp = 13\n                k = valid - 1\n                while k < valid:\n                    if ((pd.isnull(df['last'].iloc[k]) == False) and ((tmp-1) == monthname)):\n                        break\n                    k -= 1\n                outvalue += [df['last'].iloc[k]]\n                outyear += [df['year'].iloc[k]]\n                outmonth += [df['month'].iloc[k]]\n                outplant += [device[i]]\n                if tmp == 13:\n                   tmp = 1\n        monthname = tmp \n        year = tmpyear    \n    \n    if ((monthname == tmp) and (tmpyear == year)):\n        count = l-1\n        if pd.isnull(df['last'].iloc[count]) != True:    \t\n            outvalue += [df['last'].iloc[count]]\n            outyear += [df['year'].iloc[count]]\n            outmonth += [df['month'].iloc[count]]\n            outplant += [device[i]]\n        else:\n            m = count - 1\n            while m < count:\n                if ((pd.isnull(df['last'].iloc[m]) == False) and (monthname == tmp)):\n                    break\n                m -= 1\n            outvalue += [df['last'].iloc[m]]\n            outyear += [df['year'].iloc[m]]\n            outmonth += [df['month'].iloc[m]]\n            outplant += [device[i]]\n\nout = [round(num, 2) for num in outvalue]\n\n#------------------------Month Cum calculation End------------------#\n\nnull = df[df['last'].isnull()].index.tolist()\nfor i in range(len(null)):\n    null_date = (df['Date_IST'].iloc[null[i]])\n\nepoch = []\n\nfor v in range(len(outvalue)):\n    #a_date = str(outyear[v]) + \"-\" + str(outmonth[v]) + \"-\" + \"01\" + \"T\" + \"00\" +\":\" +\"00\" + \":\" + \"00Z\n    ts = datetime.datetime(outyear[v],outmonth[v],1, 00, 00,00).timestamp()\n    ns = int(ts)\n    string = str(ns) + \"000\"\n    epoch = time.strftime(\"%Y-%m-%dT%H:%M:%SZ\", time.gmtime(int(string)/1000.0))\n    \n    data = [{\n        \"measurement\": dest_database_table,\n        \"tags\": {\n            \"plant\" : plant,\n            \"device\" : outplant[v],\n           \"meter_id\": \"75568\",\n           \"field\": \"EAE_Month\"\n             },\n        \"time\" : epoch,\n        \"fields\": {\n            \"value\" : out[v]\n            }\n        }]\n    print(data)\n    stat = os.system('influx bucket list --host '+influx_url+' --token '+influx_token+' --org '+organisation+' --name '+dest_database+' >> /dev/null')\n    if stat != 0:\n        stat = os.system('influx bucket create --host '+influx_url+' --token '+influx_token+' --org '+organisation+' --name '+dest_database+' >> /dev/null')\n    \n    write_api.write(dest_database, organisation, data)\n\n\n",
        "output": "str",
        "x": 340,
        "y": 840,
        "wires": [
            [
                "171173b9923e13c8"
            ]
        ]
    },
    {
        "id": "171173b9923e13c8",
        "type": "file",
        "z": "c13a53cc905942bf",
        "name": "write file",
        "filename": "/home/iplon/EDAY_Month_egauge.py",
        "filenameType": "str",
        "appendNewline": false,
        "createDir": false,
        "overwriteFile": "true",
        "encoding": "none",
        "x": 520,
        "y": 840,
        "wires": [
            [
                "478cee3b265bbb41"
            ]
        ]
    },
    {
        "id": "478cee3b265bbb41",
        "type": "exec",
        "z": "c13a53cc905942bf",
        "command": "python3 /home/iplon/EDAY_Month_egauge.py",
        "addpay": "payload",
        "append": "",
        "useSpawn": "true",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "",
        "x": 780,
        "y": 840,
        "wires": [
            [
                "0b14c5578497e86f"
            ],
            [],
            []
        ]
    },
    {
        "id": "c2a46b9cf38fcee0",
        "type": "comment",
        "z": "c13a53cc905942bf",
        "name": "Yearly value",
        "info": "",
        "x": 110,
        "y": 940,
        "wires": []
    },
    {
        "id": "d170b23638e6b0d1",
        "type": "template",
        "z": "c13a53cc905942bf",
        "name": "EDAY_Year_egauge",
        "field": "payload",
        "fieldType": "msg",
        "format": "python",
        "syntax": "mustache",
        "template": "import sys\nimport os\nimport time\nimport pytz\nimport calendar\nimport datetime\nimport pandas as pd\nfrom datetime import date\nfrom influxdb_client import InfluxDBClient, Point, WritePrecision, WriteOptions\nfrom influxdb_client.client.write_api import SYNCHRONOUS, ASYNCHRONOUS\n\ninflux_url=\"http://localhost:8087/\"\ninflux_token=\"pNNW_glBJ_PH_Elpft-l85BC570_MLlDJOo69DE5CERDSNovQI5z1GusUVL1qBadlMWRCHirPOWh92wdbk0vtg==\"\norganisation=\"Test\"\nsource_database=\"egaugemeter\"\nsource_database_table=\"report\"\ndest_database=\"egaugemeter\"\ndest_database_table=\"report\"\n\nclient = InfluxDBClient(url=influx_url, token=influx_token, org=organisation)\nwrite_api = client.write_api(write_options=SYNCHRONOUS)\nquery_api = client.query_api()\n\ntimestamp = (\"\"\"1640975400000 2240524800000\"\"\")\n#timestamp = (\"\"\"{{payload}}\"\"\")\nb = (timestamp.split())\nstart_time = time.strftime(\"%Y-%m-%dT%H:%M:%SZ\", time.gmtime(int(b[0])/1000.0))\nstop_time = time.strftime(\"%Y-%m-%dT%H:%M:%SZ\", time.gmtime(int(b[1])/1000.0))\n\ndef frame_influx_query(source_database, source_database_table, plant, device, field):\n    if source_database and source_database_table and plant and device and field:\n        query = ' from(bucket: \\\"'+source_database+'\\\")  |> range(start: '+start_time+', stop: '+stop_time+')  |> filter(fn: (r) => r[\"_measurement\"] == \\\"'+source_database_table+'\\\")  |> filter(fn: (r) => r[\"plant\"] == \\\"'+plant+'\\\")  |> filter(fn: (r) => r[\"device\"] == \\\"'+device+'\\\")  |> filter(fn: (r) => r[\"field\"] == \\\"'+field+'\\\")  |> filter(fn: (r) => r[\"_field\"] == \"value\")  |> yield(name: \"last\")'\n    return query\n\n\nplant = \"egauge75568\"\ndevice = ['EM']\nfield = \"EAE_Month\"\n\npd.set_option('display.max_columns', None)  \npd.set_option('display.max_rows', None) \n\npoints = []\noutvalue = []\noutyear = []\noutplant = []\n\nfor x in range(len(device)):\n    my_q_str = frame_influx_query(source_database, source_database_table, plant, device[x], field)\n    #print(my_q_str)\n    result = query_api.query(query=my_q_str)\n    points_day_array=[]\n    for table in result:\n        for record in table.records:\n            points_value = record.get_value()\n            points_time = time.strftime(\"%Y-%m-%dT%H:%M:%SZ\", time.gmtime(int(record.get_time().timestamp())))\n            points_day = {\n            \"time\": points_time,\n            \"last\": points_value\n            }\n            points_day_array.append(points_day)\n    df = pd.DataFrame(points_day_array)\n    #print(df)\n\n    pd.set_option('display.max_columns', None)  \n    pd.set_option('display.max_rows', None)  \n    df.time = pd.to_datetime(df.time)\n    df[\"Date_IST\"] = pd.to_datetime(df[\"time\"]) + pd.DateOffset(hours=5, minutes=30)\n    df['Cumulative Year'] = df.groupby(df['Date_IST'].dt.year)['last'].cumsum()\n    df['year'] = pd.to_datetime(df['Date_IST']).dt.year\n    year = df['year'].iloc[0]\n    l = len(df)\n    \n    #---------------Month Cum Calculation----------------#\n    for j in range(l):\n        tmpyear = df['year'].iloc[j]\n        if (tmpyear != year):\n            valid = j-1\n            if pd.isnull(df['Cumulative Year'].iloc[valid]) != True:\n                outvalue += [df['Cumulative Year'].iloc[valid]]\n                outyear += [df['year'].iloc[valid]]\n                outplant += [device[x]]\n            else:\n                k = valid - 1\n                while k < valid:\n                    if ((pd.isnull(df['Cumulative Year'].iloc[k]) == False) and ((tmpyear-1) == year)):\n                        break\n                    k -= 1\n                outvalue += [df['Cumulative Year'].iloc[k]]\n                outyear += [df['year'].iloc[k]]\n                outplant += [device[x]]\n                outplant += [device[x]] \n        year = tmpyear\n        \n    if (tmpyear == year):\n        count = l-1\n        if pd.isnull(df['Cumulative Year'].iloc[count]) != True:\n            outvalue += [df['Cumulative Year'].iloc[count]]\n            outyear += [df['year'].iloc[count]]\n            outplant += [device[x]]\n        else:\n            m = count - 1\n            while m < count:\n                if ((pd.isnull(df['Cumulative Year'].iloc[m]) == False) and (year == tmpyear)):\n                    break\n                m -= 1\n            outvalue += [df['Cumulative Year'].iloc[m]]\n            outyear += [df['year'].iloc[m]]\n            outplant += [device[x]]\n\nout = [round(num, 2) for num in outvalue]\n\n#------------------------Month Cum calculation End------------------#\n\nnull = df[df['Cumulative Year'].isnull()].index.tolist()\nfor i in range(len(null)):\n    null_date = (df['Date_IST'].iloc[null[i]])\n\nepoch = []\n\nfor v in range(len(outvalue)):\n    ts = datetime.datetime(outyear[v],1,1, 00, 00,00).timestamp()\n    ns = int(ts)\n    string = str(ns) + \"000\"\n    epoch = time.strftime(\"%Y-%m-%dT%H:%M:%SZ\", time.gmtime(int(string)/1000.0))    \n\n    data = [{\n        \"measurement\": dest_database_table,\n        \"tags\": {\n            \"plant\": plant,\n            \"device\" : outplant[v],\n           \"meter_id\": \"75568\",\n           \"field\": \"EAE_Year\"\n             },\n        \"time\": epoch,\n        \"fields\": {\n            \"value\": out[v]\n            }\n        }]\n    print(data)\n    stat = os.system('influx bucket list --host '+influx_url+' --token '+influx_token+' --org '+organisation+' --name '+dest_database+' >> /dev/null')\n    if stat != 0:\n        stat = os.system('influx bucket create --host '+influx_url+' --token '+influx_token+' --org '+organisation+' --name '+dest_database+' >> /dev/null')\n    \n    write_api.write(dest_database, organisation, data)\n",
        "output": "str",
        "x": 340,
        "y": 1000,
        "wires": [
            [
                "f3f8c93dbaa31610"
            ]
        ]
    },
    {
        "id": "f3f8c93dbaa31610",
        "type": "file",
        "z": "c13a53cc905942bf",
        "name": "write file",
        "filename": "/home/iplon/EDAY_Year_egauge.py",
        "filenameType": "str",
        "appendNewline": false,
        "createDir": false,
        "overwriteFile": "true",
        "encoding": "none",
        "x": 520,
        "y": 1000,
        "wires": [
            [
                "4e285eddbafe2096"
            ]
        ]
    },
    {
        "id": "4e285eddbafe2096",
        "type": "exec",
        "z": "c13a53cc905942bf",
        "command": "python3 /home/iplon/EDAY_Year_egauge.py",
        "addpay": "payload",
        "append": "",
        "useSpawn": "true",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "",
        "x": 770,
        "y": 1000,
        "wires": [
            [
                "0357fb81bce20262"
            ],
            [],
            []
        ]
    },
    {
        "id": "f16f0688ab1542c7",
        "type": "debug",
        "z": "c13a53cc905942bf",
        "name": "debug 186",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 970,
        "y": 700,
        "wires": []
    },
    {
        "id": "0b14c5578497e86f",
        "type": "debug",
        "z": "c13a53cc905942bf",
        "name": "debug 187",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1070,
        "y": 840,
        "wires": []
    },
    {
        "id": "0357fb81bce20262",
        "type": "debug",
        "z": "c13a53cc905942bf",
        "name": "debug 188",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1050,
        "y": 1000,
        "wires": []
    },
    {
        "id": "975d7822733ebd19",
        "type": "cronplus",
        "z": "c13a53cc905942bf",
        "name": "",
        "outputField": "payload",
        "timeZone": "",
        "persistDynamic": false,
        "commandResponseMsgOutput": "output1",
        "outputs": 1,
        "options": [
            {
                "name": "schedule1",
                "topic": "topic1",
                "payloadType": "default",
                "payload": "",
                "expressionType": "cron",
                "expression": "0 0 12 * * *",
                "location": "",
                "offset": "0",
                "solarType": "all",
                "solarEvents": "sunrise,sunset"
            }
        ],
        "x": 120,
        "y": 700,
        "wires": [
            [
                "1c2df89d12874e32"
            ]
        ]
    },
    {
        "id": "86e8360c8e2a9a66",
        "type": "cronplus",
        "z": "c13a53cc905942bf",
        "name": "",
        "outputField": "payload",
        "timeZone": "",
        "persistDynamic": false,
        "commandResponseMsgOutput": "output1",
        "outputs": 1,
        "options": [
            {
                "name": "schedule1",
                "topic": "topic1",
                "payloadType": "default",
                "payload": "",
                "expressionType": "cron",
                "expression": "0 0 12 * * *",
                "location": "",
                "offset": "0",
                "solarType": "all",
                "solarEvents": "sunrise,sunset"
            }
        ],
        "x": 140,
        "y": 840,
        "wires": [
            [
                "ba4ac95b6fbaa96d"
            ]
        ]
    },
    {
        "id": "76085bb38efc3e21",
        "type": "cronplus",
        "z": "c13a53cc905942bf",
        "name": "",
        "outputField": "payload",
        "timeZone": "",
        "persistDynamic": false,
        "commandResponseMsgOutput": "output1",
        "outputs": 1,
        "options": [
            {
                "name": "schedule1",
                "topic": "topic1",
                "payloadType": "default",
                "payload": "",
                "expressionType": "cron",
                "expression": "0 0 12 * * *",
                "location": "",
                "offset": "0",
                "solarType": "all",
                "solarEvents": "sunrise,sunset"
            }
        ],
        "x": 120,
        "y": 1000,
        "wires": [
            [
                "d170b23638e6b0d1"
            ]
        ]
    },
    {
        "id": "e562b8f328359671",
        "type": "http request",
        "z": "a54fb0c3c40c3190",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://egauge75569.d.egauge.net/cgi-bin/egauge-show?m&s=14&a&n=2&c",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 590,
        "y": 240,
        "wires": [
            [
                "0257c63e9c0289ae"
            ]
        ]
    },
    {
        "id": "0257c63e9c0289ae",
        "type": "csv",
        "z": "a54fb0c3c40c3190",
        "name": "",
        "sep": ",",
        "hdrin": true,
        "hdrout": "",
        "multi": "one",
        "ret": "\\n",
        "temp": "",
        "skip": "0",
        "strings": true,
        "include_empty_strings": false,
        "include_null_values": true,
        "x": 750,
        "y": 240,
        "wires": [
            [
                "2cdfe27b79c778d7",
                "ec099e95970fcf9f"
            ]
        ]
    },
    {
        "id": "7fd10de4ec0c653f",
        "type": "debug",
        "z": "a54fb0c3c40c3190",
        "name": "debug 136",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1190,
        "y": 360,
        "wires": []
    },
    {
        "id": "ec099e95970fcf9f",
        "type": "debug",
        "z": "a54fb0c3c40c3190",
        "name": "debug 137",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 750,
        "y": 360,
        "wires": []
    },
    {
        "id": "c318a29b98a2f2d8",
        "type": "function",
        "z": "a54fb0c3c40c3190",
        "name": "function 14",
        "func": "//var plantObj = []; // Create an empty array to hold the InfluxDB line protocol objects\n\nvar url = msg.responseUrl\nvar parsedValue = url.split(\"https://\")[1].split(\".\")[0];\n\n// Output the parsed value\nmsg.responseUrl = parsedValue;\n\nfor (var i = 0; i < msg.payload.length; i++) {\n    var dateUTC = new Date(msg.payload[i][\"Date & Time\"]).getTime();\n    var obj = {};\n    obj.payload = [{\n        measurement: \"v\",\n        fields: {\n            value: msg.payload[i][\"Generation [kWh]\"],\n            text: \"0\",\n            qu: \"0\"\n        },\n        tags: {\n            b: \"B\",\n            bd: \"B_EM\",\n            d: parsedValue,\n            dd: \"EM\",\n            dt: \"EM\",\n            f: \"EAE\",\n            fd: \"generation\",\n            h: \"egauge75568\",\n            iid: \"75568\",\n            m: \"1\",\n            p: \"egauge75568\",\n            u: \"kwh\"\n        },\n        timestamp: dateUTC\n    }];\n    node.send(obj);\n}\nreturn null;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1080,
        "y": 240,
        "wires": [
            [
                "7fd10de4ec0c653f",
                "bd921f660fcab4cf"
            ]
        ]
    },
    {
        "id": "bd921f660fcab4cf",
        "type": "influxdb batch",
        "z": "a54fb0c3c40c3190",
        "influxdb": "bd932ff2.1cb77",
        "precision": "",
        "retentionPolicy": "",
        "name": "",
        "database": "database",
        "precisionV18FluxV20": "s",
        "retentionPolicyV18Flux": "",
        "org": "Test",
        "bucket": "egauge",
        "x": 1390,
        "y": 240,
        "wires": []
    },
    {
        "id": "2cdfe27b79c778d7",
        "type": "join",
        "z": "a54fb0c3c40c3190",
        "name": "",
        "mode": "auto",
        "build": "object",
        "property": "payload",
        "propertyType": "msg",
        "key": "topic",
        "joiner": "\\n",
        "joinerType": "str",
        "accumulate": true,
        "timeout": "",
        "count": "",
        "reduceRight": false,
        "reduceExp": "",
        "reduceInit": "",
        "reduceInitType": "",
        "reduceFixup": "",
        "x": 910,
        "y": 240,
        "wires": [
            [
                "c318a29b98a2f2d8",
                "f4d65c7189923897"
            ]
        ]
    },
    {
        "id": "f4d65c7189923897",
        "type": "debug",
        "z": "a54fb0c3c40c3190",
        "name": "debug 138",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 970,
        "y": 360,
        "wires": []
    },
    {
        "id": "447647d6aa6b3cc1",
        "type": "cronplus",
        "z": "a54fb0c3c40c3190",
        "name": "",
        "outputField": "payload",
        "timeZone": "",
        "persistDynamic": false,
        "commandResponseMsgOutput": "output1",
        "outputs": 1,
        "options": [
            {
                "name": "schedule1",
                "topic": "topic1",
                "payloadType": "default",
                "payload": "",
                "expressionType": "cron",
                "expression": "0 0 * * *",
                "location": "",
                "offset": "0",
                "solarType": "all",
                "solarEvents": "sunrise,sunset"
            }
        ],
        "x": 240,
        "y": 360,
        "wires": [
            []
        ]
    },
    {
        "id": "f97de779d8cc677d",
        "type": "comment",
        "z": "a54fb0c3c40c3190",
        "name": "EAE Data fetch",
        "info": "",
        "x": 400,
        "y": 180,
        "wires": []
    },
    {
        "id": "93233398932fec81",
        "type": "inject",
        "z": "a54fb0c3c40c3190",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 400,
        "y": 240,
        "wires": [
            [
                "e562b8f328359671"
            ]
        ]
    },
    {
        "id": "a5c3386f3a236413",
        "type": "http request",
        "z": "a54fb0c3c40c3190",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 770,
        "y": 540,
        "wires": [
            [
                "19af4bace5d0447d",
                "4c99e14f5525a995"
            ]
        ]
    },
    {
        "id": "4602c69940bce49d",
        "type": "debug",
        "z": "a54fb0c3c40c3190",
        "name": "debug 139",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1150,
        "y": 640,
        "wires": []
    },
    {
        "id": "5bfb780e74f7150b",
        "type": "debug",
        "z": "a54fb0c3c40c3190",
        "name": "debug 140",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 470,
        "y": 640,
        "wires": []
    },
    {
        "id": "4c99e14f5525a995",
        "type": "function",
        "z": "a54fb0c3c40c3190",
        "name": "function 15",
        "func": "//var plantObj = []; // Create an empty array to hold the InfluxDB line protocol objects\n\n// Extract the meter name from API\nvar url = msg.url\nvar parsedValue = url.split(\"https://\")[1].split(\".\")[0];\n\n// Define the payload string\nvar payload = msg.payload\n\n// Split the payload string by comma to get individual values\nvar payloadValues = payload.split(',');\n\n// Extract the Date & Time and Generation values\nif (parsedValue === \"egauge75570\") {\n    var dateTime = payloadValues[4].split(\"Solar* [kVAh]\")[1].split('\\n')[1];\n    var generation = parseFloat(payloadValues[6]);\n} else if (parsedValue === \"egauge75568\") {\n    var dateTime = payloadValues[3].split(\"Solar  [kWh]\")[1].split('\\n')[1];\n    var generation = parseFloat(payloadValues[6]);\n} else {\n    var dateTime = payloadValues[3].split(\"Solar [kWh]\")[1].split('\\n')[1];\n    var generation = parseFloat(payloadValues[6]);\n}\n\n\n//for (var i = 0; i < msg.payload.length; i++) {\n    var obj = {};\n    obj.payload = [{\n        measurement: \"v\",\n        fields: {\n            value: generation,\n            text: \"0\",\n            qu: \"0\"\n        },\n        tags: {\n            \n            b: \"B\",\n            bd: \"B_EM\",\n            d: parsedValue,\n            dd: \"EM\",\n            dt: \"EM\",\n            f: \"EAE\",\n            fd: \"generation\",\n            h: parsedValue,\n            iid: parsedValue,\n            m: \"1\",\n            p: \"egauge\",\n            u: \"kwh\"\n        },\n        timestamp: dateTime\n    }];\n    node.send(obj);\n//}\nreturn null;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 970,
        "y": 540,
        "wires": [
            [
                "4602c69940bce49d",
                "d321e73347eb5aad"
            ]
        ]
    },
    {
        "id": "d321e73347eb5aad",
        "type": "influxdb batch",
        "z": "a54fb0c3c40c3190",
        "influxdb": "bd932ff2.1cb77",
        "precision": "",
        "retentionPolicy": "",
        "name": "",
        "database": "database",
        "precisionV18FluxV20": "s",
        "retentionPolicyV18Flux": "",
        "org": "Test",
        "bucket": "test",
        "x": 1290,
        "y": 540,
        "wires": []
    },
    {
        "id": "3ba1f83fd75d9dbe",
        "type": "inject",
        "z": "a54fb0c3c40c3190",
        "name": "",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 120,
        "y": 540,
        "wires": [
            [
                "ebd656880127ed73"
            ]
        ]
    },
    {
        "id": "6647ff1050d9e1a0",
        "type": "function",
        "z": "a54fb0c3c40c3190",
        "name": "function 16",
        "func": "// Array of URLs\nvar urls = [\n    \"https://egauge75569.d.egauge.net/cgi-bin/egauge-show?m&s=14&a&n=3&c\",\n    \"https://egauge75570.d.egauge.net/cgi-bin/egauge-show?m&s=14&a&n=3&c\",\n    \"https://egauge77153.d.egauge.net/cgi-bin/egauge-show?m&s=14&a&n=3&c\",\n    \"https://egauge77154.d.egauge.net/cgi-bin/egauge-show?m&s=14&a&n=3&c\",\n    \"https://egauge83559.d.egauge.net/cgi-bin/egauge-show?m&s=14&a&n=3&c\",\n    \"https://egauge75568.d.egauge.net/cgi-bin/egauge-show?m&s=14&a&n=3&c\"\n];\n\n// Set the array of URLs as a property of the message\nmsg.payload = urls;\n\n// Return the modified message\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 250,
        "y": 780,
        "wires": [
            [
                "66cb6aba432bd2e9"
            ]
        ]
    },
    {
        "id": "c58d19a4a107072c",
        "type": "debug",
        "z": "a54fb0c3c40c3190",
        "name": "debug 143",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 270,
        "y": 640,
        "wires": []
    },
    {
        "id": "a5c394771fc1b4e5",
        "type": "split",
        "z": "a54fb0c3c40c3190",
        "name": "",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 430,
        "y": 540,
        "wires": [
            [
                "a570710b354f4781",
                "5bfb780e74f7150b"
            ]
        ]
    },
    {
        "id": "e017384e94170dc5",
        "type": "debug",
        "z": "a54fb0c3c40c3190",
        "name": "debug 144",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 690,
        "y": 640,
        "wires": []
    },
    {
        "id": "a570710b354f4781",
        "type": "change",
        "z": "a54fb0c3c40c3190",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "url",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 590,
        "y": 540,
        "wires": [
            [
                "a5c3386f3a236413",
                "e017384e94170dc5"
            ]
        ]
    },
    {
        "id": "19af4bace5d0447d",
        "type": "debug",
        "z": "a54fb0c3c40c3190",
        "name": "debug 145",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 890,
        "y": 640,
        "wires": []
    },
    {
        "id": "e92c8c1f4bc6ab89",
        "type": "csv",
        "z": "a54fb0c3c40c3190",
        "name": "",
        "sep": ",",
        "hdrin": true,
        "hdrout": "none",
        "multi": "one",
        "ret": "\\n",
        "temp": "",
        "skip": "0",
        "strings": true,
        "include_empty_strings": "",
        "include_null_values": true,
        "x": 1610,
        "y": 940,
        "wires": [
            []
        ]
    },
    {
        "id": "08bba6aac6b42e17",
        "type": "join",
        "z": "a54fb0c3c40c3190",
        "name": "",
        "mode": "custom",
        "build": "object",
        "property": "payload",
        "propertyType": "msg",
        "key": "topic",
        "joiner": "\\n",
        "joinerType": "str",
        "accumulate": true,
        "timeout": "",
        "count": "12",
        "reduceRight": false,
        "reduceExp": "",
        "reduceInit": "",
        "reduceInitType": "",
        "reduceFixup": "",
        "x": 1490,
        "y": 940,
        "wires": [
            [
                "e92c8c1f4bc6ab89"
            ]
        ]
    },
    {
        "id": "046ea9143dc2f716",
        "type": "function",
        "z": "a54fb0c3c40c3190",
        "name": "function 19",
        "func": "var inputObject = msg.payload\n\nvar payload = inputObject.payload;\nvar payloadLines = payload.split(\"\\r\\n\");\nvar dataLine = payloadLines[1];\nvar values = dataLine.split(\",\");\n\nvar dateTime = parseInt(values[0]);\nvar usage = parseFloat(values[1]);\nvar generation = parseFloat(values[2]);\nvar device = \"egauge83559\";\n\nvar outputObject = {\n    dateTime: dateTime,\n    usage: usage,\n    generation: generation,\n    device: device\n};\n\nreturn outputObject;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1170,
        "y": 460,
        "wires": [
            []
        ]
    },
    {
        "id": "0467cfaed27017be",
        "type": "inject",
        "z": "a54fb0c3c40c3190",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 400,
        "y": 80,
        "wires": [
            [
                "ba217384910ac85f"
            ]
        ]
    },
    {
        "id": "ba217384910ac85f",
        "type": "http request",
        "z": "a54fb0c3c40c3190",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://egauge75568.d.egauge.net/cgi-bin/egauge-show?m&s=14&a&n=10&c",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 710,
        "y": 80,
        "wires": [
            [
                "4e9c7259e4c28b9c"
            ]
        ]
    },
    {
        "id": "12707562d349e4d5",
        "type": "debug",
        "z": "a54fb0c3c40c3190",
        "name": "debug 169",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1550,
        "y": 140,
        "wires": []
    },
    {
        "id": "4e9c7259e4c28b9c",
        "type": "csv",
        "z": "a54fb0c3c40c3190",
        "name": "",
        "sep": ",",
        "hdrin": true,
        "hdrout": "none",
        "multi": "mult",
        "ret": "\\n",
        "temp": "",
        "skip": "0",
        "strings": true,
        "include_empty_strings": "",
        "include_null_values": true,
        "x": 950,
        "y": 80,
        "wires": [
            [
                "3331f3e19eec27b8"
            ]
        ]
    },
    {
        "id": "ebd656880127ed73",
        "type": "function",
        "z": "a54fb0c3c40c3190",
        "name": "function 30",
        "func": "const http = require('http');\nconst fs = require('fs');\n\n// Array of URLs\nconst urls = [\n    \"https://egauge75569.d.egauge.net/cgi-bin/egauge-show?m&s=14&a&n=1&c\",\n    \"https://egauge75570.d.egauge.net/cgi-bin/egauge-show?m&s=14&a&n=1&c\",\n    \"https://egauge77153.d.egauge.net/cgi-bin/egauge-show?m&s=14&a&n=1&c\",\n    \"https://egauge77154.d.egauge.net/cgi-bin/egauge-show?m&s=14&a&n=1&c\",\n    \"https://egauge83559.d.egauge.net/cgi-bin/egauge-show?m&s=14&a&n=1&c\",\n    \"https://egauge75568.d.egauge.net/cgi-bin/egauge-show?m&s=14&a&n=1&c\"\n];\n\n// Function to fetch URL data and write as CSV\nfunction fetchAndWriteData(url) {\n    http.get(url, (response) => {\n        let data = '';\n\n        response.on('data', (chunk) => {\n            data += chunk;\n        });\n\n        response.on('end', () => {\n            const meterName = url.match(/egauge(\\d+)/)[1];\n            const csvFileName = meterName + '.csv';\n            fs.writeFile(csvFileName, data, (error) => {\n                if (error) {\n                    console.error(`Error writing CSV file for URL: ${url}`);\n                } else {\n                    console.log(`CSV file written successfully: ${csvFileName}`);\n                }\n            });\n        });\n    }).on('error', (error) => {\n        console.error(`Error fetching data for URL: ${url}`);\n    });\n}\n\n// Iterate over the URLs and fetch/write data\nurls.forEach((url) => {\n    fetchAndWriteData(url);\n});\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 270,
        "y": 540,
        "wires": [
            [
                "a5c394771fc1b4e5",
                "c58d19a4a107072c"
            ]
        ]
    },
    {
        "id": "b32cd13fbba2b44c",
        "type": "http request",
        "z": "a54fb0c3c40c3190",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 1710,
        "y": 700,
        "wires": [
            [
                "cdf8478744d25cac",
                "5538908ee785f921"
            ]
        ]
    },
    {
        "id": "87f850212281bea0",
        "type": "debug",
        "z": "a54fb0c3c40c3190",
        "name": "debug 170",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1630,
        "y": 880,
        "wires": []
    },
    {
        "id": "5538908ee785f921",
        "type": "function",
        "z": "a54fb0c3c40c3190",
        "name": "function 31",
        "func": "//var plantObj = []; // Create an empty array to hold the InfluxDB line protocol objects\n\n// Extract the meter name from API\nvar url = msg.url\nvar parsedValue = url.split(\"https://\")[1].split(\".\")[0];\n\n// Define the payload string\nvar payload = msg.payload\n\n// Split the payload string by comma to get individual values\nvar payloadValues = payload.split(',');\n\n// Extract the Date & Time and Generation values\nif (parsedValue === \"egauge75570\") {\n    var dateTime = payloadValues[4].split(\"Solar* [kVAh]\")[1].split('\\n')[1];\n    var generation = parseFloat(payloadValues[6]);\n} else if (parsedValue === \"egauge75568\") {\n    var dateTime = payloadValues[3].split(\"Solar  [kWh]\")[1].split('\\n')[1];\n    var generation = parseFloat(payloadValues[6]);\n} else {\n    var dateTime = payloadValues[3].split(\"Solar [kWh]\")[1].split('\\n')[1];\n    var generation = parseFloat(payloadValues[6]);\n}\n\n\n//for (var i = 0; i < msg.payload.length; i++) {\n    var obj = {};\n    obj.payload = [{\n        measurement: \"v\",\n        fields: {\n            value: generation,\n            text: \"0\",\n            qu: \"0\"\n        },\n        tags: {\n            \n            b: \"B\",\n            bd: \"B_EM\",\n            d: parsedValue,\n            dd: \"EM\",\n            dt: \"EM\",\n            f: \"EAE\",\n            fd: \"generation\",\n            h: parsedValue,\n            iid: parsedValue,\n            m: \"1\",\n            p: \"egauge\",\n            u: \"kwh\"\n        },\n        timestamp: dateTime\n    }];\n    node.send(obj);\n//}\nreturn null;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1930,
        "y": 700,
        "wires": [
            [
                "87f850212281bea0"
            ]
        ]
    },
    {
        "id": "f0bdbd20279d60fe",
        "type": "influxdb batch",
        "z": "a54fb0c3c40c3190",
        "influxdb": "bd932ff2.1cb77",
        "precision": "",
        "retentionPolicy": "",
        "name": "",
        "database": "database",
        "precisionV18FluxV20": "s",
        "retentionPolicyV18Flux": "",
        "org": "Test",
        "bucket": "test",
        "x": 1230,
        "y": 780,
        "wires": []
    },
    {
        "id": "3aa3627805512328",
        "type": "inject",
        "z": "a54fb0c3c40c3190",
        "name": "",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 100,
        "y": 780,
        "wires": [
            [
                "6647ff1050d9e1a0"
            ]
        ]
    },
    {
        "id": "872cb3fa9ad01119",
        "type": "debug",
        "z": "a54fb0c3c40c3190",
        "name": "debug 172",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 630,
        "y": 900,
        "wires": []
    },
    {
        "id": "cdf8478744d25cac",
        "type": "debug",
        "z": "a54fb0c3c40c3190",
        "name": "debug 174",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1470,
        "y": 860,
        "wires": []
    },
    {
        "id": "766b4e496d0dd473",
        "type": "function",
        "z": "a54fb0c3c40c3190",
        "name": "function 32",
        "func": "const http = require('http');\nconst fs = require('fs');\n\n// Array of URLs\nconst urls = [\n    \"https://egauge75569.d.egauge.net/cgi-bin/egauge-show?m&s=14&a&n=1&c\",\n    \"https://egauge75570.d.egauge.net/cgi-bin/egauge-show?m&s=14&a&n=1&c\",\n    \"https://egauge77153.d.egauge.net/cgi-bin/egauge-show?m&s=14&a&n=1&c\",\n    \"https://egauge77154.d.egauge.net/cgi-bin/egauge-show?m&s=14&a&n=1&c\",\n    \"https://egauge83559.d.egauge.net/cgi-bin/egauge-show?m&s=14&a&n=1&c\",\n    \"https://egauge75568.d.egauge.net/cgi-bin/egauge-show?m&s=14&a&n=1&c\"\n];\n\n// Function to fetch URL data and write as CSV\nfunction fetchAndWriteData(url) {\n    http.get(url, (response) => {\n        let data = '';\n\n        response.on('data', (chunk) => {\n            data += chunk;\n        });\n\n        response.on('end', () => {\n            const meterName = url.match(/egauge(\\d+)/)[1];\n            const csvFileName = meterName + '.csv';\n            fs.writeFile(csvFileName, data, (error) => {\n                if (error) {\n                    console.error(`Error writing CSV file for URL: ${url}`);\n                } else {\n                    console.log(`CSV file written successfully: ${csvFileName}`);\n                }\n            });\n        });\n    }).on('error', (error) => {\n        console.error(`Error fetching data for URL: ${url}`);\n    });\n}\n\n// Iterate over the URLs and fetch/write data\nurls.forEach((url) => {\n    fetchAndWriteData(url);\n});\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1590,
        "y": 660,
        "wires": [
            []
        ]
    },
    {
        "id": "89cb34b2b052ce43",
        "type": "http request",
        "z": "a54fb0c3c40c3190",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 690,
        "y": 780,
        "wires": [
            [
                "f287f8d2229d7a70"
            ]
        ]
    },
    {
        "id": "66cb6aba432bd2e9",
        "type": "split",
        "z": "a54fb0c3c40c3190",
        "name": "",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 390,
        "y": 780,
        "wires": [
            [
                "d5b7733b21f99e06"
            ]
        ]
    },
    {
        "id": "d5b7733b21f99e06",
        "type": "change",
        "z": "a54fb0c3c40c3190",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "url",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 530,
        "y": 780,
        "wires": [
            [
                "89cb34b2b052ce43"
            ]
        ]
    },
    {
        "id": "10e2c4cc.dab04d",
        "type": "http request",
        "z": "a54fb0c3c40c3190",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 330,
        "y": 1080,
        "wires": [
            [
                "1f0a4623.947b0b"
            ]
        ]
    },
    {
        "id": "3b47c19c.6ddbb4",
        "type": "debug",
        "z": "a54fb0c3c40c3190",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1370,
        "y": 1080,
        "wires": []
    },
    {
        "id": "1f0a4623.947b0b",
        "type": "split",
        "z": "a54fb0c3c40c3190",
        "name": "",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 470,
        "y": 1080,
        "wires": [
            []
        ]
    },
    {
        "id": "999222db.056c38",
        "type": "inject",
        "z": "a54fb0c3c40c3190",
        "name": "",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "[\"https://egauge75569.d.egauge.net/cgi-bin/egauge-show?m&s=14&a&n=1&c\",\"https://egauge75570.d.egauge.net/cgi-bin/egauge-show?m&s=14&a&n=1&c\",\"https://egauge77153.d.egauge.net/cgi-bin/egauge-show?m&s=14&a&n=1&c\",\"https://egauge77154.d.egauge.net/cgi-bin/egauge-show?m&s=14&a&n=1&c\",\"https://egauge83559.d.egauge.net/cgi-bin/egauge-show?m&s=14&a&n=1&c\",\"https://egauge75568.d.egauge.net/cgi-bin/egauge-show?m&s=14&a&n=1&c\"]",
        "payloadType": "json",
        "x": 150,
        "y": 1080,
        "wires": [
            [
                "10e2c4cc.dab04d"
            ]
        ]
    },
    {
        "id": "2e63e6d8.9451e",
        "type": "function",
        "z": "a54fb0c3c40c3190",
        "name": "Extract Meter Name",
        "func": "var url = msg.payload;\nvar meterName = url.match(/egauge(\\d+)/)[1];\n\nmsg.filename = meterName + '.csv';\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 180,
        "y": 880,
        "wires": [
            []
        ]
    },
    {
        "id": "2ef9754f24c27881",
        "type": "file",
        "z": "a54fb0c3c40c3190",
        "name": "",
        "filename": "/home/iplon/test.csv",
        "filenameType": "str",
        "appendNewline": true,
        "createDir": false,
        "overwriteFile": "true",
        "encoding": "none",
        "x": 1060,
        "y": 1080,
        "wires": [
            [
                "3b47c19c.6ddbb4"
            ]
        ]
    },
    {
        "id": "37448c3f3fe726ba",
        "type": "file",
        "z": "a54fb0c3c40c3190",
        "name": "",
        "filename": "/home/iplon/",
        "filenameType": "str",
        "appendNewline": true,
        "createDir": false,
        "overwriteFile": "true",
        "encoding": "none",
        "x": 470,
        "y": 900,
        "wires": [
            [
                "872cb3fa9ad01119"
            ]
        ]
    },
    {
        "id": "f287f8d2229d7a70",
        "type": "csv",
        "z": "a54fb0c3c40c3190",
        "name": "",
        "sep": ",",
        "hdrin": true,
        "hdrout": "none",
        "multi": "mult",
        "ret": "\\n",
        "temp": "",
        "skip": "0",
        "strings": true,
        "include_empty_strings": "",
        "include_null_values": true,
        "x": 850,
        "y": 780,
        "wires": [
            [
                "dfa20cfc1d83102d"
            ]
        ]
    },
    {
        "id": "ad0bfdbe3fcdbc1b",
        "type": "function",
        "z": "a54fb0c3c40c3190",
        "name": "function 34",
        "func": "msg.payload = JSON.parse(msg.payload)\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1390,
        "y": 140,
        "wires": [
            [
                "12707562d349e4d5"
            ]
        ]
    },
    {
        "id": "3331f3e19eec27b8",
        "type": "debug",
        "z": "a54fb0c3c40c3190",
        "name": "debug 176",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 830,
        "y": 180,
        "wires": []
    },
    {
        "id": "dfa20cfc1d83102d",
        "type": "function",
        "z": "a54fb0c3c40c3190",
        "name": "function 35",
        "func": "// Extract the meter name from API\nvar url = msg.url\nvar parsedValue = url.split(\"https://\")[1].split(\".\")[0];\n\nfor (var i = 0; i < msg.payload.length; i++) {\n    var dateUTC = new Date(msg.payload[i][\"Date & Time\"]).getTime();\n    var obj = {};\n    obj.payload = [{\n        measurement: \"v\",\n        fields: {\n            value: msg.payload[i][\"Generation [kWh]\"],\n            text: \"0\",\n            qu: \"0\"\n        },\n        tags: {\n            \n            b: \"B\",\n            bd: \"B_EM\",\n            d: parsedValue,\n            dd: \"EM\",\n            dt: \"EM\",\n            f: \"EAE\",\n            fd: \"generation\",\n            h: parsedValue,\n            iid: parsedValue,\n            m: \"1\",\n            p: \"egauge\",\n            u: \"kwh\"\n        },\n        timestamp: dateUTC\n    }];\n    node.send(obj);\n}\nreturn null;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1010,
        "y": 780,
        "wires": [
            [
                "f0bdbd20279d60fe"
            ]
        ]
    },
    {
        "id": "f77f0560c7c9c97b",
        "type": "inject",
        "z": "7e607c0a98d5e138",
        "name": "",
        "props": [],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 250,
        "y": 200,
        "wires": [
            [
                "440b5941501e6759"
            ]
        ]
    },
    {
        "id": "be55d2dbcb8e917d",
        "type": "debug",
        "z": "7e607c0a98d5e138",
        "name": "debug 1",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1260,
        "y": 280,
        "wires": []
    },
    {
        "id": "83df54d6cf7d042b",
        "type": "exec",
        "z": "7e607c0a98d5e138",
        "command": "cd /home && node automatic_csv.js \"https://igrafana-test.iplon.co.in/d/odzT5aD4k/15-dgr-report-sunalpha-vibrant-chittor-480-60kwp-400kw?orgId=20\" admin Cymon@Park",
        "addpay": "",
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "exec",
        "x": 890,
        "y": 220,
        "wires": [
            [
                "592b0d688a1ba798"
            ],
            [
                "84a73680eb739310"
            ],
            []
        ]
    },
    {
        "id": "440b5941501e6759",
        "type": "template",
        "z": "7e607c0a98d5e138",
        "name": "",
        "field": "payload",
        "fieldType": "msg",
        "format": "javascript",
        "syntax": "mustache",
        "template": "const puppeteer = require('/node_modules/puppeteer');\n\n(async () => {\n    // Get the username, password, and URL from command line arguments\n    const url = process.argv[2];\n    const username = process.argv[3];\n    const password = process.argv[4];\n\n\n    // Set up the browser\n    //const browser = await puppeteer.launch({ headless: false });\n    const browser = await puppeteer.launch({\n        headless: true,\n        args: [\n            \"--disable-gpu\",\n            \"--disable-dev-shm-usage\",\n            \"--disable-setuid-sandbox\",\n            \"--no-sandbox\",\n        ]\n    });\n    const page = await browser.newPage();\n    await page.setViewport({ width: 1200, height: 800 });\n\n    // Navigate to the Grafana login page\n    //await page.goto(`${url}/login`);\n    await page.goto(url, { waitUntil: 'networkidle0' });\n\n    // Wait for the login page to load and enter the credentials\n    await page.waitForSelector('input[name=\"user\"]');\n    await page.type('input[name=\"user\"]', username);\n    await page.type('input[name=\"password\"]', password);\n\n    // Click the login button and wait for the dashboard page to load\n    await Promise.all([\n        page.click('button[type=\"submit\"]'),\n        page.waitForNavigation({ waitUntil: 'networkidle0' })\n    ]);\n\n    // Wait for the dropdown options to appear\n    await page.waitForSelector('header.panel-title-container');\n\n    // Click the dropdown menu to open it\n    await page.click('header.panel-title-container');\n\n    // Find the data button in the inspect menu and click it\n    await page.waitForXPath('//a[./span[text()=\"Inspect\"]]');\n    const dataButton = (await page.$x('//a[./span[text()=\"Inspect\"]]'))[0];\n    await dataButton.click();\n\n    // Find Data options and click it\n\n    await page.waitForSelector('button.css-1i6bacp');\n    await page.evaluate(() => {\n        const dropdown = document.querySelector('button.css-1i6bacp');\n        dropdown.click();\n    });\n\n    //await page.waitForSelector('button.css-1i6bacp');\n    //await page.click('button.css-1i6bacp');\n    //await page.waitForXPath('//div[text()=\"Data options\"]');\n    //const data = (await page.$x('//div[text()=\"Data options\"]'))[0];\n    //await data.click();\n    //await page.waitForSelector('div.css-k8f47l'); // wait for the tab to appear\n    //await page.evaluate(() => {\n    //const dataOptionsTab = document.querySelector('//div[text()=\"Data options\"]');\n    //const dataOptionsTab = await page.$('.css-13se522'); // using class selector\n    //await dataOptionsTab.click();\n    //});\n\n    //async function clickDataOptionsTab() {\n    //const dataOptionsTab = await page.$('div.css-13se522'); // using class selector\n    //await dataOptionsTab.click();\n    //}\n\n    //await clickDataOptionsTab();\n\n\n\n    // Find show data frame and click it inside\n    await page.waitForSelector('div.css-15fuo2f-input-wrapper.css-imcr96');\n    await page.click('div.css-15fuo2f-input-wrapper.css-imcr96');\n\n    // Find the series joined by time option and click it\n    await page.keyboard.press('ArrowUp');\n    await page.keyboard.press('Enter');\n\n    // Find the download CSV button in the data options menu and click it\n    await page.waitForSelector('button.css-1vp08vr-button');\n    await page.click('button.css-1vp08vr-button');\n\n    await page.waitForTimeout(5000);\n\n    // Close the browser\n    await browser.close();\n})();\n",
        "output": "str",
        "x": 440,
        "y": 220,
        "wires": [
            [
                "1acb0862c2a912cb"
            ]
        ]
    },
    {
        "id": "1acb0862c2a912cb",
        "type": "file",
        "z": "7e607c0a98d5e138",
        "name": "",
        "filename": "/home/automatic_csv.js",
        "filenameType": "str",
        "appendNewline": false,
        "createDir": true,
        "overwriteFile": "true",
        "encoding": "none",
        "x": 650,
        "y": 220,
        "wires": [
            [
                "83df54d6cf7d042b"
            ]
        ]
    },
    {
        "id": "84a73680eb739310",
        "type": "debug",
        "z": "7e607c0a98d5e138",
        "name": "debug 2",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 980,
        "y": 360,
        "wires": []
    },
    {
        "id": "db013e456b231bbe",
        "type": "inject",
        "z": "7e607c0a98d5e138",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 660,
        "y": 480,
        "wires": [
            [
                "83df54d6cf7d042b"
            ]
        ]
    },
    {
        "id": "592b0d688a1ba798",
        "type": "file",
        "z": "7e607c0a98d5e138",
        "name": "",
        "filename": "/home/automatic.csv",
        "filenameType": "str",
        "appendNewline": true,
        "createDir": false,
        "overwriteFile": "true",
        "encoding": "none",
        "x": 1100,
        "y": 200,
        "wires": [
            [
                "be55d2dbcb8e917d"
            ]
        ]
    },
    {
        "id": "755b9bee2c3cdb09",
        "type": "debug",
        "z": "75028d37abb5aa92",
        "name": "debug 95",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1060,
        "y": 100,
        "wires": []
    },
    {
        "id": "bce877d3db8e248c",
        "type": "template",
        "z": "75028d37abb5aa92",
        "name": "",
        "field": "payload",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "<!DOCTYPE html>\n<html>\n\n<head>\n    <style>\n        * {\n            box-sizing: border-box;\n            margin: 0;\n            font-family: Arial;\n        }\n\n        .main {\n            height: 100%;\n            width: 100%;\n            border: 1px solid black;\n            position: fixed;\n            background-color: #E5E4E2;\n        }\n\n        .side {\n            border: 1px solid black;\n            text-align: center;\n            height: 75%;\n            width: 45%;\n            float: right;\n            margin-top: 50px;\n            margin-right: 70px;\n            background-color: white;\n        }\n\n        .block {\n            border: 1px solid black;\n            height: 50%;\n            width: 90%;\n            margin-top: 15px;\n            margin-left: 15px;\n            background-color: #09035E;\n        }\n\n        .hello {\n            position: fixed;\n            height: auto;\n            padding: 10px 10px 10px 10px;\n        }\n    </style>\n</head>\n\n<body>\n    <div class=\"main\"><img src=\"data:image/png;base64,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\" class=\"hello\" width=\"300\" height=\"150\" >\n        <div class=\"side\">\n            <div class=\"block\"></div>\n            <br /><br /><br />\n            <h2 style=\"color:black;\">Amplus Arjun</h2>\n            <h2 style=\"color:black;\">2MW</h2>\n            <br /><br /><br />\n            <h3 style=\"color:black;\">Portal User Manual</h3>\n            <br />\n            <hr style=\"width:90%;height:2px;color:darkblue;background-color:#09035E;margin-left: 15px\">\n            <br /><br /><br /><br />\n            <hr style=\"width:90%;height:15px;color:darkblue;background-color:#09035E;margin-left: 15px\">\n            <br />\n            <h4 style=\"float: right;margin-right: 15px;color:black;\">Nivethika &\n                                                                     Anushiya\n            </h4>\n            <h4 style=\"float: left;margin-left:15px;color:black;\">\n                <script>\n                    document.write(new Date().toLocaleDateString()); \n                </script>\n            </h4>\n        </div>\n    </div>\n</body>\n\n</html>",
        "output": "str",
        "x": 220,
        "y": 100,
        "wires": [
            [
                "1ec22094e2862e6f"
            ]
        ]
    },
    {
        "id": "0a2c3e89fc70d10e",
        "type": "file",
        "z": "75028d37abb5aa92",
        "name": "write",
        "filename": "/home/output/Frontpage.pdf",
        "filenameType": "str",
        "appendNewline": true,
        "createDir": false,
        "overwriteFile": "true",
        "encoding": "none",
        "x": 570,
        "y": 100,
        "wires": [
            [
                "04c95c3981dac59b"
            ]
        ]
    },
    {
        "id": "ec90b3b77d5d807f",
        "type": "comment",
        "z": "75028d37abb5aa92",
        "name": "Front page",
        "info": "",
        "x": 60,
        "y": 100,
        "wires": []
    },
    {
        "id": "52435872b213f4e4",
        "type": "comment",
        "z": "75028d37abb5aa92",
        "name": "Content",
        "info": "",
        "x": 50,
        "y": 220,
        "wires": []
    },
    {
        "id": "03eca0447d9c6f58",
        "type": "file in",
        "z": "75028d37abb5aa92",
        "name": "2",
        "filename": "/home/output/2.png",
        "filenameType": "str",
        "format": "",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 670,
        "y": 280,
        "wires": [
            [
                "7ce757f416c3405b"
            ]
        ]
    },
    {
        "id": "314bde8ac983ddaa",
        "type": "file in",
        "z": "75028d37abb5aa92",
        "name": "3",
        "filename": "/home/output/3.png",
        "filenameType": "str",
        "format": "",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 670,
        "y": 340,
        "wires": [
            [
                "a56ed2f57596d993"
            ]
        ]
    },
    {
        "id": "3464c5c82b983c94",
        "type": "file in",
        "z": "75028d37abb5aa92",
        "name": "4",
        "filename": "/home/output/4.png",
        "filenameType": "str",
        "format": "",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 670,
        "y": 400,
        "wires": [
            [
                "a628708de89c7033"
            ]
        ]
    },
    {
        "id": "584e4665814929de",
        "type": "file in",
        "z": "75028d37abb5aa92",
        "name": "5",
        "filename": "/home/output/5.png",
        "filenameType": "str",
        "format": "",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 670,
        "y": 460,
        "wires": [
            [
                "92ebd866c69c7b1f"
            ]
        ]
    },
    {
        "id": "c6016de6c7d4c48a",
        "type": "exec",
        "z": "75028d37abb5aa92",
        "command": "cd /home/ && node grafana_screenshot.js \"https://igrafana.iplon.co.in/d/FaUw5NYVz/02-energy-meter-overview?orgId=27\" arjun123:arjun123 output/2.png",
        "addpay": "",
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "2",
        "x": 490,
        "y": 300,
        "wires": [
            [
                "03eca0447d9c6f58"
            ],
            [],
            []
        ]
    },
    {
        "id": "b1281bf0b048ea28",
        "type": "exec",
        "z": "75028d37abb5aa92",
        "command": "cd /home/ && node grafana_screenshot.js \"https://igrafana.iplon.co.in/d/GN0vDHY4z/03-system-view?orgId=27&refresh=5m\" arjun123:arjun123 output/3.png",
        "addpay": "",
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "3",
        "x": 490,
        "y": 360,
        "wires": [
            [
                "314bde8ac983ddaa"
            ],
            [],
            []
        ]
    },
    {
        "id": "c4b4cc6a117d12a4",
        "type": "exec",
        "z": "75028d37abb5aa92",
        "command": "cd /home/ && node grafana_screenshot.js \"https://igrafana.iplon.co.in/d/sqT15tLVz/04-documentation?orgId=27\" arjun123:arjun123 output/4.png",
        "addpay": "",
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "4",
        "x": 490,
        "y": 420,
        "wires": [
            [
                "3464c5c82b983c94"
            ],
            [],
            []
        ]
    },
    {
        "id": "879b33ea41aa0f71",
        "type": "exec",
        "z": "75028d37abb5aa92",
        "command": "cd /home/ && node grafana_screenshot.js \"https://igrafana.iplon.co.in/d/77H_HtY4z/05-inverter-ac-power-kw-vs-radiation-w-m2?orgId=27\" arjun123:arjun123 output/5.png",
        "addpay": "",
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "5",
        "x": 490,
        "y": 480,
        "wires": [
            [
                "584e4665814929de"
            ],
            [],
            []
        ]
    },
    {
        "id": "04f9f94136ad186c",
        "type": "file in",
        "z": "75028d37abb5aa92",
        "name": "6",
        "filename": "/home/output/6.png",
        "filenameType": "str",
        "format": "",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 670,
        "y": 520,
        "wires": [
            [
                "d47b1d3881009002"
            ]
        ]
    },
    {
        "id": "76c7f66660966c94",
        "type": "exec",
        "z": "75028d37abb5aa92",
        "command": "cd /home/ && node grafana_screenshot.js \"https://igrafana.iplon.co.in/d/iF2PdNLVz/06-weather-station?orgId=27\" arjun123:arjun123 output/6.png",
        "addpay": "",
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "6",
        "x": 490,
        "y": 540,
        "wires": [
            [
                "04f9f94136ad186c"
            ],
            [],
            []
        ]
    },
    {
        "id": "243b0214309948b1",
        "type": "file in",
        "z": "75028d37abb5aa92",
        "name": "7",
        "filename": "/home/output/7.png",
        "filenameType": "str",
        "format": "",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 670,
        "y": 580,
        "wires": [
            [
                "87b18eae96a4a253"
            ]
        ]
    },
    {
        "id": "0fc3af2954a85e48",
        "type": "exec",
        "z": "75028d37abb5aa92",
        "command": "cd /home/ && node grafana_screenshot.js \"https://igrafana.iplon.co.in/d/nHQbvHLVk/07-inverter-pac-idc-heatmap?orgId=27\" arjun123:arjun123 output/7.png",
        "addpay": "",
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "7",
        "x": 490,
        "y": 600,
        "wires": [
            [
                "243b0214309948b1"
            ],
            [],
            []
        ]
    },
    {
        "id": "c14dde1128041da1",
        "type": "file in",
        "z": "75028d37abb5aa92",
        "name": "8",
        "filename": "/home/output/8.png",
        "filenameType": "str",
        "format": "",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 670,
        "y": 640,
        "wires": [
            [
                "7366c653eab226c9"
            ]
        ]
    },
    {
        "id": "4e588b3538466a22",
        "type": "exec",
        "z": "75028d37abb5aa92",
        "command": "cd /home/ && node grafana_screenshot.js \"https://igrafana.iplon.co.in/d/SydsDYjGG/08-inverter-status?orgId=27\" arjun123:arjun123 output/8.png",
        "addpay": "",
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "8",
        "x": 490,
        "y": 660,
        "wires": [
            [
                "c14dde1128041da1"
            ],
            [],
            []
        ]
    },
    {
        "id": "2f6aaf9c8b138563",
        "type": "file in",
        "z": "75028d37abb5aa92",
        "name": "9",
        "filename": "/home/output/9.png",
        "filenameType": "str",
        "format": "",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 670,
        "y": 700,
        "wires": [
            [
                "8b8770d099247a6a"
            ]
        ]
    },
    {
        "id": "495b913380ce820e",
        "type": "exec",
        "z": "75028d37abb5aa92",
        "command": "cd /home/ && node grafana_screenshot.js \"https://igrafana.iplon.co.in/d/Pm_ovmE4k/09-a-alarm-screen-st3_w0?orgId=27\" arjun123:arjun123 output/9.png",
        "addpay": "",
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "9",
        "x": 490,
        "y": 720,
        "wires": [
            [
                "2f6aaf9c8b138563"
            ],
            [],
            []
        ]
    },
    {
        "id": "f8ffd1352ddcee90",
        "type": "file in",
        "z": "75028d37abb5aa92",
        "name": "10",
        "filename": "/home/output/10.png",
        "filenameType": "str",
        "format": "",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 670,
        "y": 760,
        "wires": [
            [
                "b13bbf83bbf90c9d"
            ]
        ]
    },
    {
        "id": "deb20e7faaf4db05",
        "type": "exec",
        "z": "75028d37abb5aa92",
        "command": "cd /home/ && node grafana_screenshot.js \"https://igrafana.iplon.co.in/d/4V_eWiP4z/09-b-alarm-screen-st3_w1?orgId=27\" arjun123:arjun123 output/10.png",
        "addpay": "",
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "10",
        "x": 490,
        "y": 780,
        "wires": [
            [
                "f8ffd1352ddcee90"
            ],
            [],
            []
        ]
    },
    {
        "id": "ba83ac991b8e9c9a",
        "type": "file in",
        "z": "75028d37abb5aa92",
        "name": "11",
        "filename": "/home/output/11.png",
        "filenameType": "str",
        "format": "",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 670,
        "y": 820,
        "wires": [
            [
                "42d5f26079bc1c6b"
            ]
        ]
    },
    {
        "id": "2a9d445a3e24f08a",
        "type": "exec",
        "z": "75028d37abb5aa92",
        "command": "cd /home/ && node grafana_screenshot.js \"https://igrafana.iplon.co.in/d/BhtYDmE4k/09-c-alarm-screen-st3_w2?orgId=27\" arjun123:arjun123 output/11.png",
        "addpay": "",
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "11",
        "x": 490,
        "y": 840,
        "wires": [
            [
                "ba83ac991b8e9c9a"
            ],
            [],
            []
        ]
    },
    {
        "id": "8b5f381248b0b069",
        "type": "file in",
        "z": "75028d37abb5aa92",
        "name": "1",
        "filename": "/home/output/1.png",
        "filenameType": "str",
        "format": "",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 670,
        "y": 220,
        "wires": [
            [
                "25ebeac5c88a26c9"
            ]
        ]
    },
    {
        "id": "e2717efcc6fb5483",
        "type": "exec",
        "z": "75028d37abb5aa92",
        "command": "cd /home/ && node grafana_screenshot.js \"https://igrafana.iplon.co.in/d/ogKqbHY4z/01-plant-overview?orgId=27\" arjun123:arjun123 output/1.png",
        "addpay": "",
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "1",
        "x": 490,
        "y": 240,
        "wires": [
            [
                "8b5f381248b0b069"
            ],
            [],
            []
        ]
    },
    {
        "id": "3bd22eef9fb2d8bb",
        "type": "file",
        "z": "75028d37abb5aa92",
        "name": "output in PDF",
        "filename": "/home/output/arjun.pdf",
        "filenameType": "str",
        "appendNewline": true,
        "createDir": true,
        "overwriteFile": "true",
        "encoding": "none",
        "x": 1660,
        "y": 300,
        "wires": [
            [
                "da4d5d7b38108d63"
            ]
        ]
    },
    {
        "id": "969ffbf8ca0716c4",
        "type": "change",
        "z": "75028d37abb5aa92",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "a1",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1010,
        "y": 220,
        "wires": [
            [
                "6d87c7ba7336583d"
            ]
        ]
    },
    {
        "id": "17da67cba4fbade5",
        "type": "change",
        "z": "75028d37abb5aa92",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "a3",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1010,
        "y": 340,
        "wires": [
            [
                "6d87c7ba7336583d"
            ]
        ]
    },
    {
        "id": "6d87c7ba7336583d",
        "type": "function",
        "z": "75028d37abb5aa92",
        "name": "combine",
        "func": "context.data = context.data || {};\nswitch (msg.topic) {\n    case \"a1\":\n        context.data.a1 = msg.payload;\n        msg = null;\n        break;\n    case \"a2\":\n        context.data.a2 = msg.payload;\n        msg = null;\n        break;\n    case \"a3\":\n        context.data.a3 = msg.payload;\n        msg = null;\n        break;\n    case \"a4\":\n        context.data.a4 = msg.payload;\n        msg = null;\n        break;\n    case \"a5\":\n        context.data.a5 = msg.payload;\n        msg = null;\n        break;\n    case \"a6\":\n        context.data.a6 = msg.payload;\n        msg = null;\n        break;\n    case \"a7\":\n        context.data.a7 = msg.payload;\n        msg = null;\n        break;\n    case \"a8\":\n        context.data.a8 = msg.payload;\n        msg = null;\n        break;\n    case \"a9\":\n        context.data.a9 = msg.payload;\n        msg = null;\n        break;\n    case \"a10\":\n        context.data.a10 = msg.payload;\n        msg = null;\n        break;\n    case \"a11\":\n        context.data.a11 = msg.payload;\n        msg = null;\n        break;\n    case \"a12\":\n        context.data.a12 = msg.payload;\n        msg = null;\n        break;\n    case \"a13\":\n        context.data.a13 = msg.payload;\n        msg = null;\n        break;\n    case \"a14\":\n        context.data.a14 = msg.payload;\n        msg = null;\n        break;\n    case \"a15\":\n        context.data.a15 = msg.payload;\n        msg = null;\n        break;\n    \n}\nif (context.data.a1 != null && context.data.a2 != null && context.data.a3 != null && context.data.a4 != null && context.data.a5 != null && context.data.a6 != null && context.data.a7 != null && context.data.a8 != null && context.data.a9 != null && context.data.a10 != null && context.data.a11 != null && context.data.a12 != null && context.data.a13 != null && context.data.a14 != null && context.data.a15 != null) {\n    var data_combine = {\n        \"a1\": context.data.a1,\n        \"a2\": context.data.a2,\n        \"a3\": context.data.a3,\n        \"a4\": context.data.a4,\n        \"a5\": context.data.a5,\n        \"a6\": context.data.a6,\n        \"a7\": context.data.a7,\n        \"a8\": context.data.a8,\n        \"a9\": context.data.a9,\n        \"a10\": context.data.a10,\n        \"a11\": context.data.a11,\n        \"a12\": context.data.a12,\n        \"a13\": context.data.a13,\n        \"a14\": context.data.a14,\n        \"a15\": context.data.a15\n       \n    }\n    context.data = null\n    return { payload: data_combine };\n}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1200,
        "y": 300,
        "wires": [
            [
                "1081d395c844f6ad"
            ]
        ]
    },
    {
        "id": "761d57a4333edaaf",
        "type": "change",
        "z": "75028d37abb5aa92",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "a4",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1010,
        "y": 400,
        "wires": [
            [
                "6d87c7ba7336583d"
            ]
        ]
    },
    {
        "id": "95775d25c6e8dd1f",
        "type": "change",
        "z": "75028d37abb5aa92",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "a5",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1010,
        "y": 460,
        "wires": [
            [
                "6d87c7ba7336583d"
            ]
        ]
    },
    {
        "id": "3b47663c24d7c52d",
        "type": "change",
        "z": "75028d37abb5aa92",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "a2",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1010,
        "y": 280,
        "wires": [
            [
                "6d87c7ba7336583d"
            ]
        ]
    },
    {
        "id": "1081d395c844f6ad",
        "type": "template",
        "z": "75028d37abb5aa92",
        "name": "",
        "field": "payload",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "<!DOCTYPE html>\n<html lang=\"en\">\n\n<head>\n    <style type=\"text/css\">\n        @page {\n            size: A4;\n            margin: 0;\n        }\n\n        body {\n            margin: 0;\n        }\n    </style>\n    <style>\n        * {\n            box-sizing: border-box;\n            margin: 0;\n            font-family: Arial;\n        }\n\n        .main {\n            height: 100%;\n            width: 100%;\n        }\n\n        .header {\n            height: 10%;\n            width: 100%;\n            border: 1px solid black;\n            position: fixed;\n        }\n\n        .content {\n            width: 100%;\n            text-align: left;\n            height: 1500px;\n            padding-top: 200px;\n            padding-left: 50px;\n            padding-right: 50px;\n        }\n\n        .date {\n            height: 50%;\n            width: 50%;\n            border: 1px solid black;\n            text-align: center;\n            padding: 10px 10px 10px 10px;\n        }\n\n        .version {\n            height: 50%;\n            width: 50%;\n            border: 1px solid black;\n            text-align: center;\n            padding: 10px 10px 10px 10px;\n        }\n\n        .left {\n            float: left;\n            height: 100%;\n            width: 40%;\n            text-align: center;\n        }\n\n        .logo {\n            float: right;\n            padding: 5px 5px 5px 5px;\n        }\n    </style>\n\n</head>\n\n<body>\n    <script type=\"text/javascript\">\n        window.onload = addPageNumbers;\n            \n                      function addPageNumbers() {\n                        var totalPages = Math.ceil(document.body.scrollHeight / 1123);  //842px A4 pageheight for 72dpi, 1123px A4 pageheight for 96dpi, \n                        for (var i = 1; i <= 11; i++) {\n                          var pageNumberDiv = document.createElement(\"div\");\n                          var pageNumber = document.createTextNode(\"Page \" + i + \" of \" + 11);\n                          pageNumberDiv.style.position = \"absolute\";\n                          pageNumberDiv.style.top = \"calc((\" + i + \" * (297mm - 0.5px)) - 40px)\"; //297mm A4 pageheight; 0,5px unknown needed necessary correction value; additional wanted 40px margin from bottom(own element height included)\n                          pageNumberDiv.style.height = \"16px\";\n                          pageNumberDiv.appendChild(pageNumber);\n                          document.body.insertBefore(pageNumberDiv, document.getElementById(\"content\"));\n                          pageNumberDiv.style.left = \"calc(100% - (\" + pageNumberDiv.offsetWidth + \"px + 20px))\";\n                        }\n                      }\n    </script>\n    <div class=\"main\">\n        <div class=\"header\">\n            <div class=\"logo\">\n                <h3><img src=\"data:image/png;base64,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\" class=\"hello\" width=\"200\" height=\"90\" >\n                </h3>\n            </div>\n            <div class=\"left\">\n                <div class=\"date\">\n                    <h3>\n                        <script>\n                            document.write(new Date().toLocaleDateString());\n                        </script>\n                    </h3>\n                </div>\n                <div class=\"version\">\n                    <h3>version 1.0</h3>\n                </div>\n            </div>\n        </div>\n        <p style=\"page-break-after: always\"></p>\n        <div class=\"content\">\n            <style>\n                table,\n                th,\n                td {\n                    text-align: center;\n                    border: 1px solid black;\n                }\n            </style>\n            <h2>VERSION HISTORY</h2>\n            <br />\n            <table style=\"width:100%\">\n                <tr>\n                    <th>VERSION</th>\n                    <th>IMPLEMENTED BY</th>\n                    <th>REVISION DATE</th>\n                    <th>REASON</th>\n                </tr>\n                <tr>\n                    <td>1.0</td>\n                    <td>Nivethika &\n                        Anushiya\n                    </td>\n                    <td>\n                        <script>\n                            document.write(new Date().toLocaleDateString()); \n                        </script>\n                    </td>\n                    <td>REPORT</td>\n                </tr>\n            </table>\n            <p style=\"page-break-after: always\"></p>\n            <br /></br /><br /><br /><br /><br /><br /><br />\n            <h2>Table of Contents</h2>\n            <br /><br />\n            <table style=\"width:100%\">\n                <tr>\n                    <th>S.NO</th>\n                    <th>TITLE</th>\n                    <th>PAGE NO</th>\n                </tr>\n                <tr>\n                    <td>01</td>\n                    <td style=\"text-align:left\">Aim</td>\n                    <td>3</td>\n                </tr>\n                <tr>\n                    <td>02</td>\n                    <td style=\"text-align:left\">Summary</td>\n                    <td>3</td>\n                </tr>\n                <tr>\n                    <td>03</td>\n                    <td style=\"text-align:left\">Navigation & Visualization</td>\n                    <td>3</td>\n                </tr>\n                <tr>\n                    <td>04</td>\n                    <td style=\"text-align:left\">Plant Overview Screen</td>\n                    <td>4</td>\n                </tr>\n                <tr>\n                    <td>05</td>\n                    <td style=\"text-align:left\">Energy Meter Overview</td>\n                    <td>4</td>\n                </tr>\n                <tr>\n                    <td>06</td>\n                    <td style=\"text-align:left\">System View</td>\n                    <td>5</td>\n                </tr>\n                <tr>\n                    <td>07</td>\n                    <td style=\"text-align:left\">Documentation</td>\n                    <td>5</td>\n                </tr>\n                <tr>\n                    <td>08</td>\n                    <td style=\"text-align:left\">Inverter</td>\n                    <td>6</td>\n                </tr>\n                <tr>\n                    <td>09</td>\n                    <td style=\"text-align:left\">Weather Station</td>\n                    <td>6</td>\n                </tr>\n                <tr>\n                    <td>10</td>\n                    <td style=\"text-align:left\">Inverter PAC/IDC Heatmap</td>\n                    <td>7</td>\n                </tr>\n                <tr>\n                    <td>11</td>\n                    <td style=\"text-align:left\">Inveter Status</td>\n                    <td>7</td>\n                </tr>\n                <tr>\n                    <td>12.a.</td>\n                    <td style=\"text-align:left\">Alaram Screen ST3_WO</td>\n                    <td>8</td>\n                </tr>\n                <tr>\n                    <td>12.b.</td>\n                    <td style=\"text-align:left\">Alarm Screen ST3_W1</td>\n                    <td>8</td>\n                </tr>\n                <tr>\n                    <td>12.c.</td>\n                    <td style=\"text-align:left\">Alaram Screen ST3_W2</td>\n                    <td>9</td>\n                </tr>\n                <tr>\n                    <td>12.d.</td>\n                    <td style=\"text-align:left\">Alarm Screen ST3_W3</td>\n                    <td>9</td>\n                </tr>\n                <tr>\n                    <td>12.e.</td>\n                    <td style=\"text-align:left\">Alarm Screen ST3_W4</td>\n                    <td>9</td>\n                </tr>\n                <tr>\n                    <td>12.f.</td>\n                    <td style=\"text-align:left\">Alarm Screen ST3_W6</td>\n                    <td>9</td>\n                </tr>\n                <tr>\n                    <td>13</td>\n                    <td style=\"text-align:left\">Monthly/Yearly_Report</td>\n                    <td>9</td>\n                </tr>\n            </table>\n            <p style=\"page-break-after: always\"></p>\n            <br /></br /><br /><br /><br /><br /><br /><br />\n            <h3>01. Aim</h3>\n            <br />\n            <p>This document gives an overview of iPLON IoT 6.0 Amplus Arjun for 2 MW solar PV\n                power plant.</p>\n            <br />\n            <h3>2. Summary</h3>\n            <br />\n            <p>Overview of all SCADA screens along with Visualization of HMI screens like Inverter Rooms, Control Rooms,\n                and Weather station etc. Visualizing the real time data on all the available screens with HMI interface.\n                The Screens are flexible and it is developed according to the requirement from customer.</p>\n            <br />\n            <h3>3. Navigation & Visualization</h3>\n            <br />\n            <p>Background color for all screens: Black. In the top of Plant Overview Screen, navigation buttons to all\n                the folders like Plant Overview, SLD, PV block, Plant Generation, Trends, Energy meter, Reports, Alarms,\n                Power control, Plant DI & DO and Inverter overview is given. Once click on the folder it will be\n                navigating to the respective dashboards under that folder shown in fig below. Also in the top line,\n                Screen selection, Share Dashboard, Date selection & Refresh for each 1 min are displayed.</p>\n            <br />\n            <h3>4. Plant Overview Screen</h3>\n            <br />\n            <p>Plant Overview screen shows the Installed capacity of the plant, and location. It also shows the current\n                date and time in IST and the performance ratio displayed in the meter. The plant data are shows as total\n                energy generation from the date of commissioning, energy yield today and yesterday with solar radiation,\n                Ambient Temperature & Peak power.</p>\n            <br />\n            Also it shows the plant details in left corner with version. All the parameters are displayed in such a manner that\n            <br /><br />\n            DC instantaneous value  Light Green colour & DC Cumulative value  Dark Green.\n            <br /><br />\n            AC instantaneous value  Light Orange color & AC Cumulative value  Dark Green.\n            </p>\n            <p style=\"page-break-after: always\"></p>\n            <br /></br /><br /><br /><br /><br /><br /><br />\n            <br />\n            <div style=\"text-align: center;\">\n                <img src=\"data:image/jpeg;base64,{{{payload.a1}}}\"width=\"500\" height=\"300\">\n            </div>\n            <br />\n            <h3>5. Energy Meter Overview</h3>\n            <br />\n            <p>Click on the Navigation \"Energy meter overview\" provided on right top corner of the home screen.Under\n                this Energy\n                meter readings are displayed.This screen shows the Active power,EAE,EAE DAY values of the block and\n                control room. </p>\n            <br />\n            <div style=\"text-align: center;\">\n                <img src=\"data:image/jpeg;base64,{{{payload.a2}}}\"width=\"500\" height=\"300\">\n            </div>\n            <p style=\"page-break-after: always\"></p>\n            <br /></br /><br /><br /><br /><br /><br /><br />\n            <br />\n            <h3>6. System View</h3>\n            <br />\n            <p>This screen is used to compare multiple fields with multiple devices. Also used to analyse different\n                parameters at a\n                time..</p>\n            <br />\n            <div style=\"text-align: center;\">\n                <img src=\"data:image/jpeg;base64,{{{payload.a3}}}\"width=\"500\" height=\"300\">\n            </div>\n            <br />\n            <h3>7. Documentation</h3>\n            <br />\n            <p>This screen shows complete plant structure of a Plot. It represents the energy flow from solar PV to\n                Blocks and there to control room and to the feeder. SLD gives the clear picture of the system with\n                energy in each stage</p>\n            <br />\n            <div style=\"text-align: center;\">\n                <img src=\"data:image/jpeg;base64,{{{payload.a4}}}\"width=\"500\" height=\"300\">\n            </div>\n            <br />\n            <p style=\"page-break-after: always\"></p>\n            <br /></br /><br /><br /><br /><br /><br /><br />\n            <h3>8. Inverter(AC Power(kW)vs Radiation(W/m2))</h3>\n            <br />\n            <p>This screen shows inverter AC Power (kW) vs Radiation.</p>\n            <br />\n            <div style=\"text-align: center;\">\n                <img src=\"data:image/jpeg;base64,{{{payload.a5}}}\"width=\"500\" height=\"300\">\n            </div>\n            <br />\n            <p> This screen shows the Inverter Active power varaiation in the form of heat- map and can be use for\n                better analaysis.</p>\n            <br />\n            <h3>9. Weather Station</h3>\n            <br />\n            <p>The weather station has a variety of sensors for measuring solar irradiation, wind speed and direction,\n                air temperature,\n                relative humidity. Weather Monitoring Data displayed on these pages is obtained from a weather\n                monitoring station\n                located at the plant. Real-time sensor monitoring plus calculated parameters are available in\n                reports and graph.The parameters shown in the weather station are displayed as per the selection of the\n                date. User has\n                the option to select the intervel of from date to date.</p>\n            <br />\n            <div style=\"text-align: center;\">\n                <img src=\"data:image/jpeg;base64,{{{payload.a6}}}\"width=\"500\" height=\"300\">\n            </div>\n            <p style=\"page-break-after: always\"></p>\n            <br /></br /><br /><br /><br /><br /><br /><br />\n            <h3>10. Inverter PAC/IDC Heatmap</h3>\n            <br />\n            <p>This screen shows the Inverter PAC/ IDC Heatmap .\n                <br />\n            -- Block Per Min Report\n                <br />\n            -- Incomer/Outgoing Feeder MFM Report\n                <br />\n            -- Monthly Report\n                <br />\n            -- WMS One Min Report\n                <br />\n            -- Plant Generation Report\n                <br />\n            -- DGR Report\n            </p>\n            <br />\n            <div style=\"text-align: center;\">\n                <img src=\"data:image/jpeg;base64,{{{payload.a7}}}\"width=\"500\" height=\"300\">\n            </div>\n            <br />\n            <h3>11. Inverter Status</h3>\n            <br />\n            <p>This screen shows the Inverter Status.\n            </p>\n            <br />\n            <div style=\"text-align: center;\">\n                <img src=\"data:image/jpeg;base64,{{{payload.a8}}}\"width=\"500\" height=\"300\">\n            </div>\n            <p style=\"page-break-after: always\"></p>\n            <br /></br /><br /><br /><br /><br /><br /><br />\n            <br />\n            <h3>12. a.Alaram Screen ST3_W0</h3>\n            <br />\n            <p>This screen shows the Block wise Inverter parameters like active power, generation & Inverter IGBT\n                temperature and plant level trends in different dashboards.</p>\n            <br />\n            <div style=\"text-align: center;\">\n                <img src=\"data:image/jpeg;base64,{{{payload.a9}}}\"width=\"500\" height=\"300\">\n            </div>\n            <h3>12. b.Alaram Screen ST3_W1</h3>\n            <br />\n            <p>This screen shows all Block wise energy meter PAC (MW) value. To check one of the Block PAC graph for\n                analysis click on the name given in right side.</p>\n            <br />\n            <div style=\"text-align: center;\">\n                <img src=\"data:image/jpeg;base64,{{{payload.a10}}}\"width=\"500\" height=\"300\">\n            </div>\n            <br />\n            <br />\n            <p style=\"page-break-after: always\"></p>\n            <br /></br /><br /><br /><br /><br /><br /><br />\n            <h3>12. c.Alarm Screen ST3_W2</h3>\n            <br />\n            <p>This screen shows the Block wise Active power (kW) of all inverters with solar radiation (W/m2).</p>\n            <br />\n            <div style=\"text-align: center;\">\n                <img src=\"data:image/jpeg;base64,{{{payload.a11}}}\"width=\"500\" height=\"300\">\n            </div>\n            <br />\n            <h3>12. d.Alarm Screen ST3_W3</h3>\n            <br />\n            <p>This screen shows the Generation (kWh) of each block wise inverter with irradiation (kWh/m2)</p>\n            <br />\n            <div style=\"text-align: center;\">\n                <img src=\"data:image/jpeg;base64,{{{payload.a12}}}\"width=\"500\" height=\"300\">\n            </div>\n            <br />\n            <p style=\"page-break-after: always\"></p>\n            <br /></br /><br /><br /><br /><br /><br /><br />\n            <h3>12. e.Alarm Screen ST3_W4</h3>\n            <br />\n            <p>This screen shows the Block wise Active power (kW) of all inverters with solar radiation (W/m2).</p>\n            <br />\n            <div style=\"text-align: center;\">\n                <img src=\"data:image/jpeg;base64,{{{payload.a13}}}\"width=\"500\" height=\"300\">\n            </div>\n            <br />\n            <h3>12. f.Alarm Screen ST3_W6</h3>\n            <br />\n            <p>This screen shows the Block wise Active power (kW) of all inverters with solar radiation (W/m2).</p>\n            <br />\n            <div style=\"text-align: center;\">\n                <img src=\"data:image/jpeg;base64,{{{payload.a14}}}\"width=\"500\" height=\"300\">\n            </div>\n            <br />\n            <p style=\"page-break-after: always\"></p>\n            <br /></br /><br /><br /><br /><br /><br /><br />\n            <h3>13. Monthly/Yearly_Report</h3>\n            <br />\n            <p>This Monthly/Yearly report comprises per day generation of each inverters and aggregating into total inv\n                generation and\n                plant end generation for month wise and cumulated to year.</p>\n            <br />\n            <div style=\"text-align: center;\">\n                <img src=\"data:image/jpeg;base64,{{{payload.a15}}}\"width=\"500\" height=\"300\">\n            </div>\n            <br />\n\n</html>",
        "output": "str",
        "x": 1340,
        "y": 300,
        "wires": [
            [
                "2f7a0476aa6380a2"
            ]
        ]
    },
    {
        "id": "fb711a05356d8bfc",
        "type": "change",
        "z": "75028d37abb5aa92",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "a6",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1010,
        "y": 520,
        "wires": [
            [
                "6d87c7ba7336583d"
            ]
        ]
    },
    {
        "id": "e7dfe0167ac38335",
        "type": "change",
        "z": "75028d37abb5aa92",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "a7",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1010,
        "y": 580,
        "wires": [
            [
                "6d87c7ba7336583d"
            ]
        ]
    },
    {
        "id": "60548cee996ace28",
        "type": "change",
        "z": "75028d37abb5aa92",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "a8",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1010,
        "y": 640,
        "wires": [
            [
                "6d87c7ba7336583d"
            ]
        ]
    },
    {
        "id": "121c5666fd6096a5",
        "type": "change",
        "z": "75028d37abb5aa92",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "a9",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1010,
        "y": 700,
        "wires": [
            [
                "6d87c7ba7336583d"
            ]
        ]
    },
    {
        "id": "ee2dc36b1842246d",
        "type": "change",
        "z": "75028d37abb5aa92",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "a10",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1010,
        "y": 760,
        "wires": [
            [
                "6d87c7ba7336583d"
            ]
        ]
    },
    {
        "id": "29b99b714bec7d80",
        "type": "change",
        "z": "75028d37abb5aa92",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "a11",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1010,
        "y": 820,
        "wires": [
            [
                "6d87c7ba7336583d"
            ]
        ]
    },
    {
        "id": "8b75ef7262d87ca8",
        "type": "file in",
        "z": "75028d37abb5aa92",
        "name": "12",
        "filename": "/home/output/12.png",
        "filenameType": "str",
        "format": "",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 670,
        "y": 880,
        "wires": [
            [
                "cf0a1f4d8fbfda79"
            ]
        ]
    },
    {
        "id": "e0fd96632c48a67c",
        "type": "exec",
        "z": "75028d37abb5aa92",
        "command": "cd /home/ && node grafana_screenshot.js \"https://igrafana.iplon.co.in/d/-6PYviP4k/09-d-alarm-screen-st3_w3?orgId=27\" arjun123:arjun123 output/12.png",
        "addpay": "",
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "12",
        "x": 490,
        "y": 900,
        "wires": [
            [
                "8b75ef7262d87ca8"
            ],
            [],
            []
        ]
    },
    {
        "id": "efe7a002f389e743",
        "type": "change",
        "z": "75028d37abb5aa92",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "a12",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1010,
        "y": 880,
        "wires": [
            [
                "6d87c7ba7336583d"
            ]
        ]
    },
    {
        "id": "2668fbe054d62de3",
        "type": "function",
        "z": "75028d37abb5aa92",
        "name": "merge",
        "func": "const merger = new pdfMergerJs();\n\n(async () => {\n    await merger.add('/home/output/Frontpage.pdf');  //merge all pages. parameter is the path to file and filename.\n    await merger.add('/home/output/arjun.pdf');\n\n    await merger.save('/home/output/Arjun_2MW.pdf'); //save under given name and reset the internal document\n})();\nreturn msg\n\n\n\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [
            {
                "var": "pdfMergerJs",
                "module": "pdf-merger-js"
            },
            {
                "var": "pdfLib",
                "module": "pdf-lib"
            },
            {
                "var": "path",
                "module": "path"
            }
        ],
        "x": 910,
        "y": 100,
        "wires": [
            [
                "755b9bee2c3cdb09"
            ]
        ]
    },
    {
        "id": "df249dba5fc5d6c1",
        "type": "file in",
        "z": "75028d37abb5aa92",
        "name": "13",
        "filename": "/home/output/13.png",
        "filenameType": "str",
        "format": "",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 670,
        "y": 940,
        "wires": [
            [
                "42b696c96b011548"
            ]
        ]
    },
    {
        "id": "2882451ece8b8e7e",
        "type": "exec",
        "z": "75028d37abb5aa92",
        "command": "cd /home/ && node grafana_screenshot.js \"https://igrafana.iplon.co.in/d/gUeYDmEVz/09-e-alarm-screen-st3_w4?orgId=27\" arjun123:arjun123 output/13.png",
        "addpay": "",
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "13",
        "x": 490,
        "y": 960,
        "wires": [
            [
                "df249dba5fc5d6c1"
            ],
            [],
            []
        ]
    },
    {
        "id": "0737a35325166a21",
        "type": "change",
        "z": "75028d37abb5aa92",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "a13",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1010,
        "y": 940,
        "wires": [
            [
                "6d87c7ba7336583d"
            ]
        ]
    },
    {
        "id": "e502ee9b4695b843",
        "type": "file in",
        "z": "75028d37abb5aa92",
        "name": "14",
        "filename": "/home/output/14.png",
        "filenameType": "str",
        "format": "",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 670,
        "y": 1000,
        "wires": [
            [
                "6ad98893b17ac647"
            ]
        ]
    },
    {
        "id": "51afeeb6d3246a1d",
        "type": "exec",
        "z": "75028d37abb5aa92",
        "command": "cd /home/ && node grafana_screenshot.js \"https://igrafana.iplon.co.in/d/Qm2EviE4z/09-f-alarm-screen-st3_w6?orgId=27\" arjun123:arjun123 output/14.png",
        "addpay": "",
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "14",
        "x": 490,
        "y": 1020,
        "wires": [
            [
                "e502ee9b4695b843"
            ],
            [],
            []
        ]
    },
    {
        "id": "eeb8504f7aa04170",
        "type": "change",
        "z": "75028d37abb5aa92",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "a14",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1010,
        "y": 1000,
        "wires": [
            [
                "6d87c7ba7336583d"
            ]
        ]
    },
    {
        "id": "1bc3c8ca43424e37",
        "type": "file in",
        "z": "75028d37abb5aa92",
        "name": "15",
        "filename": "/home/output/15.png",
        "filenameType": "str",
        "format": "",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 670,
        "y": 1060,
        "wires": [
            [
                "07fbbca22e7694ab"
            ]
        ]
    },
    {
        "id": "0f13dce7b15531d9",
        "type": "exec",
        "z": "75028d37abb5aa92",
        "command": "cd /home/ && node grafana_screenshot.js \"https://igrafana.iplon.co.in/d/hFjJcpLVz/10-monthly-yearly_report?orgId=27\" arjun123:arjun123 output/15.png",
        "addpay": "",
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "15",
        "x": 490,
        "y": 1080,
        "wires": [
            [
                "1bc3c8ca43424e37"
            ],
            [],
            []
        ]
    },
    {
        "id": "6e5f6dbd6e347153",
        "type": "change",
        "z": "75028d37abb5aa92",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "a15",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1010,
        "y": 1060,
        "wires": [
            [
                "6d87c7ba7336583d"
            ]
        ]
    },
    {
        "id": "05df4c1698fe602f",
        "type": "inject",
        "z": "75028d37abb5aa92",
        "name": "",
        "props": [],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 210,
        "y": 320,
        "wires": [
            [
                "e2717efcc6fb5483",
                "c6016de6c7d4c48a",
                "b1281bf0b048ea28",
                "c4b4cc6a117d12a4",
                "8372fa48007fd677",
                "a92562a1a6863891",
                "eda1d71a5b186f3b",
                "bce877d3db8e248c"
            ]
        ]
    },
    {
        "id": "8372fa48007fd677",
        "type": "delay",
        "z": "75028d37abb5aa92",
        "name": "",
        "pauseType": "delay",
        "timeout": "1",
        "timeoutUnits": "minutes",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 220,
        "y": 500,
        "wires": [
            [
                "76c7f66660966c94",
                "0fc3af2954a85e48",
                "4e588b3538466a22",
                "879b33ea41aa0f71"
            ]
        ]
    },
    {
        "id": "a92562a1a6863891",
        "type": "delay",
        "z": "75028d37abb5aa92",
        "name": "",
        "pauseType": "delay",
        "timeout": "2",
        "timeoutUnits": "minutes",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 220,
        "y": 860,
        "wires": [
            [
                "2a9d445a3e24f08a",
                "e0fd96632c48a67c",
                "deb20e7faaf4db05",
                "495b913380ce820e"
            ]
        ]
    },
    {
        "id": "eda1d71a5b186f3b",
        "type": "delay",
        "z": "75028d37abb5aa92",
        "name": "",
        "pauseType": "delay",
        "timeout": "150",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 230,
        "y": 1080,
        "wires": [
            [
                "0f13dce7b15531d9",
                "51afeeb6d3246a1d",
                "2882451ece8b8e7e"
            ]
        ]
    },
    {
        "id": "da4d5d7b38108d63",
        "type": "delay",
        "z": "75028d37abb5aa92",
        "name": "",
        "pauseType": "delay",
        "timeout": "1",
        "timeoutUnits": "minutes",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 740,
        "y": 100,
        "wires": [
            [
                "2668fbe054d62de3"
            ]
        ]
    },
    {
        "id": "7ce757f416c3405b",
        "type": "base64",
        "z": "75028d37abb5aa92",
        "name": "",
        "action": "str",
        "property": "payload",
        "x": 860,
        "y": 280,
        "wires": [
            [
                "3b47663c24d7c52d"
            ]
        ]
    },
    {
        "id": "a56ed2f57596d993",
        "type": "base64",
        "z": "75028d37abb5aa92",
        "name": "",
        "action": "str",
        "property": "payload",
        "x": 860,
        "y": 340,
        "wires": [
            [
                "17da67cba4fbade5"
            ]
        ]
    },
    {
        "id": "a628708de89c7033",
        "type": "base64",
        "z": "75028d37abb5aa92",
        "name": "",
        "action": "str",
        "property": "payload",
        "x": 860,
        "y": 400,
        "wires": [
            [
                "761d57a4333edaaf"
            ]
        ]
    },
    {
        "id": "92ebd866c69c7b1f",
        "type": "base64",
        "z": "75028d37abb5aa92",
        "name": "",
        "action": "str",
        "property": "payload",
        "x": 860,
        "y": 460,
        "wires": [
            [
                "95775d25c6e8dd1f"
            ]
        ]
    },
    {
        "id": "d47b1d3881009002",
        "type": "base64",
        "z": "75028d37abb5aa92",
        "name": "",
        "action": "str",
        "property": "payload",
        "x": 860,
        "y": 520,
        "wires": [
            [
                "fb711a05356d8bfc"
            ]
        ]
    },
    {
        "id": "87b18eae96a4a253",
        "type": "base64",
        "z": "75028d37abb5aa92",
        "name": "",
        "action": "str",
        "property": "payload",
        "x": 860,
        "y": 580,
        "wires": [
            [
                "e7dfe0167ac38335"
            ]
        ]
    },
    {
        "id": "7366c653eab226c9",
        "type": "base64",
        "z": "75028d37abb5aa92",
        "name": "",
        "action": "str",
        "property": "payload",
        "x": 860,
        "y": 640,
        "wires": [
            [
                "60548cee996ace28"
            ]
        ]
    },
    {
        "id": "8b8770d099247a6a",
        "type": "base64",
        "z": "75028d37abb5aa92",
        "name": "",
        "action": "str",
        "property": "payload",
        "x": 860,
        "y": 700,
        "wires": [
            [
                "121c5666fd6096a5"
            ]
        ]
    },
    {
        "id": "b13bbf83bbf90c9d",
        "type": "base64",
        "z": "75028d37abb5aa92",
        "name": "",
        "action": "str",
        "property": "payload",
        "x": 860,
        "y": 760,
        "wires": [
            [
                "ee2dc36b1842246d"
            ]
        ]
    },
    {
        "id": "42d5f26079bc1c6b",
        "type": "base64",
        "z": "75028d37abb5aa92",
        "name": "",
        "action": "str",
        "property": "payload",
        "x": 860,
        "y": 820,
        "wires": [
            [
                "29b99b714bec7d80"
            ]
        ]
    },
    {
        "id": "25ebeac5c88a26c9",
        "type": "base64",
        "z": "75028d37abb5aa92",
        "name": "",
        "action": "str",
        "property": "payload",
        "x": 860,
        "y": 220,
        "wires": [
            [
                "969ffbf8ca0716c4"
            ]
        ]
    },
    {
        "id": "cf0a1f4d8fbfda79",
        "type": "base64",
        "z": "75028d37abb5aa92",
        "name": "",
        "action": "str",
        "property": "payload",
        "x": 860,
        "y": 880,
        "wires": [
            [
                "efe7a002f389e743"
            ]
        ]
    },
    {
        "id": "42b696c96b011548",
        "type": "base64",
        "z": "75028d37abb5aa92",
        "name": "",
        "action": "str",
        "property": "payload",
        "x": 860,
        "y": 940,
        "wires": [
            [
                "0737a35325166a21"
            ]
        ]
    },
    {
        "id": "6ad98893b17ac647",
        "type": "base64",
        "z": "75028d37abb5aa92",
        "name": "",
        "action": "str",
        "property": "payload",
        "x": 860,
        "y": 1000,
        "wires": [
            [
                "eeb8504f7aa04170"
            ]
        ]
    },
    {
        "id": "07fbbca22e7694ab",
        "type": "base64",
        "z": "75028d37abb5aa92",
        "name": "",
        "action": "str",
        "property": "payload",
        "x": 860,
        "y": 1060,
        "wires": [
            [
                "6e5f6dbd6e347153"
            ]
        ]
    },
    {
        "id": "e76e87af276ce58e",
        "type": "inject",
        "z": "75028d37abb5aa92",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 260,
        "y": 1280,
        "wires": [
            [
                "8abf2a5951086769"
            ]
        ]
    },
    {
        "id": "8abf2a5951086769",
        "type": "exec",
        "z": "75028d37abb5aa92",
        "command": "cd /home && node grafana_screenshot.js \"https://igrafana.iplon.co.in/d/nLgWkIlGk/01-plant-overview-sunalpha_vibrant_chittor_480-60kwp-400kw?orgId=20\" vibrantpolymer_admin:Admin@321 output/test.png",
        "addpay": "",
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "exec",
        "x": 430,
        "y": 1280,
        "wires": [
            [
                "f83013dc83c84e6f"
            ],
            [
                "441628bec58c7312"
            ],
            []
        ]
    },
    {
        "id": "f83013dc83c84e6f",
        "type": "debug",
        "z": "75028d37abb5aa92",
        "name": "debug 96",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 680,
        "y": 1280,
        "wires": []
    },
    {
        "id": "441628bec58c7312",
        "type": "debug",
        "z": "75028d37abb5aa92",
        "name": "error",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 650,
        "y": 1380,
        "wires": []
    },
    {
        "id": "1ec22094e2862e6f",
        "type": "html-to-pdf",
        "z": "75028d37abb5aa92",
        "name": "",
        "format": "A4",
        "zoom": 100,
        "orientation": "Portrait",
        "width": "",
        "height": "",
        "widthUnit": "cm",
        "heightUnit": "cm",
        "marginTop": 1,
        "marginLeft": 1,
        "marginBottom": 1,
        "marginRight": 1,
        "marginTopUnits": "cm",
        "marginLeftUnits": "cm",
        "marginBottomUnits": "cm",
        "marginRightUnits": "cm",
        "omitBackground": false,
        "printGraphics": true,
        "x": 410,
        "y": 100,
        "wires": [
            [
                "0a2c3e89fc70d10e"
            ]
        ]
    },
    {
        "id": "2f7a0476aa6380a2",
        "type": "html-to-pdf",
        "z": "75028d37abb5aa92",
        "name": "",
        "format": "A4",
        "zoom": 100,
        "orientation": "Portrait",
        "width": "",
        "height": "",
        "widthUnit": "cm",
        "heightUnit": "cm",
        "marginTop": 1,
        "marginLeft": 1,
        "marginBottom": 1,
        "marginRight": 1,
        "marginTopUnits": "cm",
        "marginLeftUnits": "cm",
        "marginBottomUnits": "cm",
        "marginRightUnits": "cm",
        "omitBackground": false,
        "printGraphics": true,
        "x": 1490,
        "y": 300,
        "wires": [
            [
                "3bd22eef9fb2d8bb"
            ]
        ]
    },
    {
        "id": "bac5f3301bf243a7",
        "type": "inject",
        "z": "75028d37abb5aa92",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 80,
        "y": 40,
        "wires": [
            [
                "bce877d3db8e248c"
            ]
        ]
    },
    {
        "id": "04c95c3981dac59b",
        "type": "debug",
        "z": "75028d37abb5aa92",
        "name": "debug 97",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 360,
        "y": 40,
        "wires": []
    },
    {
        "id": "4f29845c4894551c",
        "type": "inject",
        "z": "b9b3963f10f4b55a",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 240,
        "y": 240,
        "wires": [
            [
                "d48b0cdbe3ea5396"
            ]
        ]
    },
    {
        "id": "d48b0cdbe3ea5396",
        "type": "file in",
        "z": "b9b3963f10f4b55a",
        "name": "read",
        "filename": "/home/iplon/Downloads/1352332036_2023-04-01_2023-04-30.csv",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 410,
        "y": 240,
        "wires": [
            [
                "b95d9ad4386e5805",
                "de18f51f0059ae51"
            ]
        ]
    },
    {
        "id": "de18f51f0059ae51",
        "type": "csv",
        "z": "b9b3963f10f4b55a",
        "name": "",
        "sep": ",",
        "hdrin": true,
        "hdrout": "none",
        "multi": "mult",
        "ret": "\\n",
        "temp": "",
        "skip": "0",
        "strings": true,
        "include_empty_strings": false,
        "include_null_values": true,
        "x": 570,
        "y": 240,
        "wires": [
            [
                "56930cac3f971f47"
            ]
        ]
    },
    {
        "id": "6d3c447bc842038b",
        "type": "function",
        "z": "b9b3963f10f4b55a",
        "name": "function 9",
        "func": "let plantObj\nplantObj = []\n{\n    var time = msg.payload[1]._time;\n    var eaemin = msg.payload[0]._value;\n    var eae = msg.payload[1]._value;\n    if (eae >= eaemin) {\n        var EAE_DAY = eae - eaemin\n    }\n    var obj =\n    {\n        time,\n        eaemin,\n        eae,\n        EAE_DAY\n    }\n    plantObj.push(obj)\n}\nmsg.payload = plantObj\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 740,
        "y": 180,
        "wires": [
            [
                "3b4842af2768b7c8"
            ]
        ]
    },
    {
        "id": "3b4842af2768b7c8",
        "type": "function",
        "z": "b9b3963f10f4b55a",
        "name": "function 10",
        "func": "{\n    //var dateUTC = new Date(msg.payload[0].time).getTime();\n    var obj = {};\n    obj.payload = [{\n        measurement: \"v\",\n        fields: {\n            value: msg.payload[0].EAE_DAY,\n            text: \"0\",\n            qu: \"0\"\n        },\n        tags: {\n            meter_id: \"75568\",\n            plant: \"egauge75568\",\n            device: \"EM\",\n            field: \"EAE_DAY\"\n        },\n        //timestamp: dateUTC\n    }];\n    node.send(obj);\n}\nreturn null;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 890,
        "y": 180,
        "wires": [
            []
        ]
    },
    {
        "id": "610a2a5267c12782",
        "type": "debug",
        "z": "b9b3963f10f4b55a",
        "name": "debug 128",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1050,
        "y": 240,
        "wires": []
    },
    {
        "id": "bda90b8ea72678cc",
        "type": "inject",
        "z": "b9b3963f10f4b55a",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "300",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 150,
        "y": 440,
        "wires": [
            [
                "a0a089fa745184fc",
                "61ba6afa3cbd5dc4"
            ]
        ]
    },
    {
        "id": "f6977b3bdf4f359a",
        "type": "influxdb in",
        "z": "b9b3963f10f4b55a",
        "influxdb": "3bca187f56a227bf",
        "name": "B01_INV2",
        "query": "",
        "rawOutput": false,
        "precision": "",
        "retentionPolicy": "",
        "org": "organisation",
        "x": 530,
        "y": 440,
        "wires": [
            [
                "efef380d246ce472"
            ]
        ]
    },
    {
        "id": "9e054811b138d696",
        "type": "function",
        "z": "b9b3963f10f4b55a",
        "name": "PR",
        "func": "let plantObj\nplantObj = []\n\n\n     for (i =0; i < msg.payload.cum.length;i++)\n     for(j =0; j < msg.payload.radiation.length;j++)\n\n        {      \n    var  edctime= new Date(msg.payload.cum[i].time).getTime();\n      var soltime= new Date(msg.payload.radiation[j].time).getTime();\n      if (edctime==soltime)\n      {\n       var CUM_EDC=msg.payload.cum[i].cumulative_sum\n       var CUM_RADIATION=msg.payload.radiation[j].last\n       var pr = \"PR\" +\"_\" + msg.payload.cum[i].f;\n var PR;\n    if (CUM_RADIATION==0)\n    { \n        PR =0;\n    }\n    else\n    {\n        PR = ((CUM_EDC)/(1717.2 *CUM_RADIATION))*100;\n    }\n//node.send(obj);\nvar obj={\n            edctime,\n            CUM_EDC,\n            CUM_RADIATION,\n            pr,\n            PR,\n            field:msg.payload.cum[i].f,\n            device:msg.payload.cum[i].d,\n            \n\n}\n\nplantObj.push(obj)\n}\n}\nmsg.payload =plantObj\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 830,
        "y": 500,
        "wires": [
            [
                "9a0ad86c9ed87cd4"
            ]
        ]
    },
    {
        "id": "a0a089fa745184fc",
        "type": "function",
        "z": "b9b3963f10f4b55a",
        "name": "solar radiation",
        "func": "\n\n var $today = new Date();\n var d = new Date($today);\n d.setDate($today.getDate());\n d.setHours(0,0,0,0);\n \n var $tommarow = new Date();\n var d1 = new Date($tommarow);\n d1.setDate($tommarow.getDate());\n d1.setHours(23,59,0,0);\n \n  var tstart=d.getTime();\n  var tend= d1.getTime();\n  var q = \"SELECT last(value) FROM scaback_csv WHERE (d = 'CR_EM01' AND f = 'RADIATION_CUM') AND time >= \"+ tstart +\"ms and time <= \"+ tend + \"ms GROUP BY time(5m),d,f fill(0);\";\n \n msg.query = q\n msg.topic=\"radiation\";\n\n// msg.payload=tend\n return msg;\n \n \n \n ",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 320,
        "y": 500,
        "wires": [
            [
                "6bc66676ef4303ab"
            ]
        ]
    },
    {
        "id": "6bc66676ef4303ab",
        "type": "influxdb in",
        "z": "b9b3963f10f4b55a",
        "influxdb": "705b30eaab2edcd3",
        "name": "RADIATION",
        "query": "",
        "rawOutput": false,
        "precision": "",
        "retentionPolicy": "",
        "org": "organisation",
        "x": 510,
        "y": 500,
        "wires": [
            [
                "efef380d246ce472"
            ]
        ]
    },
    {
        "id": "61ba6afa3cbd5dc4",
        "type": "function",
        "z": "b9b3963f10f4b55a",
        "name": "cum_edc",
        "func": "\n var $today = new Date();\n var d = new Date($today);\n d.setDate($today.getDate());\n d.setHours(0,0,0,0);\n \n var $tommarow = new Date();\n var d1 = new Date($tommarow);\n d1.setDate($tommarow.getDate());\n d1.setHours(23,59,0,0);\n \n  var tstart=d.getTime();\n  var tend= d1.getTime();\n  \n  var q = \"SELECT cumulative_sum(sum(value)) FROM energydc_test WHERE (d = 'B01_INV2' AND f !~ /.*PR_EDC*./ AND f != 'UB_ALARM') AND time >= \"+ tstart +\"ms and time <= \"+ tend + \"ms GROUP BY time(5m),d,f fill(0);\";\n // var q1=\"SELECT last(value) FROM energydc_test WHERE (d = 'B01_INV2') AND time >= \"+ tstart +\"ms and time <= \"+ tend + \"ms GROUP BY time(1m),d,f fill(0);\";\n \n msg.query = q\nmsg.topic=\"cum\";\n //msg.payload=tend\n return msg;\n \n \n \n ",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 340,
        "y": 440,
        "wires": [
            [
                "f6977b3bdf4f359a"
            ]
        ]
    },
    {
        "id": "efef380d246ce472",
        "type": "function",
        "z": "b9b3963f10f4b55a",
        "name": "combine",
        "func": "context.data = context.data || {};\nswitch(msg.topic){\n    case \"cum\":\n        context.data.cum = msg.payload;\n        msg = null;\n        break;\n    case \"radiation\":\n        context.data.radiation = msg.payload;\n        msg = null;\n        break;\n}\nif(context.data.cum != null && context.data.radiation != null){\n    var data_combine = {\n        \"cum\": context.data.cum,\n        \"radiation\": context.data.radiation\n       \n    }\n    context.data = null\n    return {payload: data_combine};\n}  ",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 680,
        "y": 480,
        "wires": [
            [
                "9e054811b138d696",
                "d821974a25b0f263"
            ]
        ]
    },
    {
        "id": "36c23e58bc518661",
        "type": "influxdb batch",
        "z": "b9b3963f10f4b55a",
        "influxdb": "ccc431de9f0d8ff2",
        "precision": "",
        "retentionPolicy": "",
        "name": "EDC OUT",
        "database": "",
        "retentionPolicyV18Flux": "",
        "org": "",
        "bucket": "",
        "x": 1180,
        "y": 480,
        "wires": []
    },
    {
        "id": "9a0ad86c9ed87cd4",
        "type": "function",
        "z": "b9b3963f10f4b55a",
        "name": "INFLUX OUT",
        "func": "\nfor (i =0; i < msg.payload.length ;i++)\n{\nvar obj={};\nobj.payload=\n\n[\n    {\n        measurement: \"energydc_test\",\n        \n fields: {\n            \n           value:msg.payload[i].PR\n        \n        },\n        tags:{\n         \n        \n           f:msg.payload[i].pr,\n           d:msg.payload[i].device\n        \n        },\n        \n        timestamp:new Date(msg.payload[i].edctime)\n    }\n];\n\nnode.send(obj);\n}\n\nreturn null;\n\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 990,
        "y": 480,
        "wires": [
            [
                "36c23e58bc518661"
            ]
        ]
    },
    {
        "id": "d821974a25b0f263",
        "type": "debug",
        "z": "b9b3963f10f4b55a",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 810,
        "y": 580,
        "wires": []
    },
    {
        "id": "26eb98892670fe48",
        "type": "inject",
        "z": "b9b3963f10f4b55a",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "300",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 150,
        "y": 760,
        "wires": [
            [
                "05cfc0af6d5ba02f"
            ]
        ]
    },
    {
        "id": "05cfc0af6d5ba02f",
        "type": "influxdb in",
        "z": "b9b3963f10f4b55a",
        "influxdb": "a26a60a1b0efa0e4",
        "name": "B01_INV2",
        "query": "SELECT last(\"value\"),d FROM \"energydc_test\" WHERE (\"d\" = 'B01_INV2' AND \"f\" =~ /.*PR_EDC*./) AND time >= now() - 5m GROUP BY time(5m), \"f\" fill(none)",
        "rawOutput": false,
        "precision": "",
        "retentionPolicy": "",
        "org": "organisation",
        "x": 330,
        "y": 760,
        "wires": [
            [
                "fd2f023001af6fd8"
            ]
        ]
    },
    {
        "id": "e9377360cfa681b0",
        "type": "influxdb batch",
        "z": "b9b3963f10f4b55a",
        "influxdb": "7c33df7798517679",
        "precision": "",
        "retentionPolicy": "",
        "name": "EDC OUT",
        "database": "",
        "retentionPolicyV18Flux": "",
        "org": "",
        "bucket": "",
        "x": 1160,
        "y": 820,
        "wires": []
    },
    {
        "id": "81db097f954a8711",
        "type": "function",
        "z": "b9b3963f10f4b55a",
        "name": "UB_ALARM",
        "func": "\n//let plantObj\n//plantObj = []\n\n\nfor (i =0; i < msg.payload.length ;i++)\n{\nvar obj={};\nobj.payload=\n\n[\n    {\n        measurement: \"energydc_test\",\n        \n fields: {\n            \n           value:msg.payload[i].REMARKS\n        \n        },\n        tags:{\n         \n        \n           f:\"UB_ALARM\",\n           d:msg.payload[i].d\n    \n        },\n        \n        timestamp:msg.payload[i].time\n    }\n];\n\n//plantObj.push(obj)\nnode.send(obj);\n}\n\n//msg.payload = plantObj\n\n//return msg;\nreturn null;\n\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 930,
        "y": 760,
        "wires": [
            [
                "d42bd8079d2a898b",
                "e9377360cfa681b0"
            ]
        ]
    },
    {
        "id": "d42bd8079d2a898b",
        "type": "debug",
        "z": "b9b3963f10f4b55a",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1150,
        "y": 760,
        "wires": []
    },
    {
        "id": "5a786d02e22be03f",
        "type": "function",
        "z": "b9b3963f10f4b55a",
        "name": "STANDARD DEVIATION",
        "func": "let plantObj\n\nplantObj = []\nvar array= msg.payload;\nvar sum=0\nfor(var i = 0; i < array.length; i++)\n{ \n    var AVG= array[(array.length)-1].avg\n    var MAX=array[(array.length)-1].max\n    var max_70 =0.7*MAX;\n    var PR=array[i].PR\n    var Std_deviation =Math.pow((AVG-PR),2);\n     sum +=Std_deviation\n    var  SD_MEAN =sum/array.length\n      var SD=Math.sqrt(SD_MEAN)\n      var REMARKS;\n       if(SD<1)\n       {REMARKS=0}// BALENCED\n       else{REMARKS=1}//UNBALENCED\n    var sd_field =array[i].SD\n    obj={\n    time:array[i].time,    \n    AVG,\n    MAX,\n    PR,\n    max_70,\n    Std_deviation,\n    sum,\n    sd_field,\n    SD_MEAN,\n    SD,\n    d:array[i].d,\n    REMARKS\n    }\n    plantObj.push(obj)\n}\n msg.payload=plantObj;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 710,
        "y": 760,
        "wires": [
            [
                "81db097f954a8711"
            ]
        ]
    },
    {
        "id": "fd2f023001af6fd8",
        "type": "function",
        "z": "b9b3963f10f4b55a",
        "name": "mean and max",
        "func": "let plantObj\n\nplantObj = []\n\nvar grades = msg.payload\nvar total = 0;\nvar max =grades[0].last\nfor(var i = 0; i < grades.length; i++)\n{  var time=grades[i].time\n    {\n    var RESULT;\n    var PR = grades[i].last\n    total += PR;\n    if (PR>max)\n    {max=PR}\n\nvar avg = total / grades.length;\n\nRESULT=grades[i].f.split(\"PR_EDC\");\n  var SD=\"SD\"+RESULT[1]\n\n\nOBJ={time,avg,max,PR,\n    SD,\n    d:grades[i].d\n    \n}\n\nplantObj.push(OBJ)\n}\n}\nmsg.payload =plantObj\n//return null;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 500,
        "y": 760,
        "wires": [
            [
                "5a786d02e22be03f"
            ]
        ]
    },
    {
        "id": "53b622fd1772b7cd",
        "type": "comment",
        "z": "b9b3963f10f4b55a",
        "name": "PR CALCULATION",
        "info": "",
        "x": 310,
        "y": 360,
        "wires": []
    },
    {
        "id": "3ee3953aaa668621",
        "type": "comment",
        "z": "b9b3963f10f4b55a",
        "name": "STANDARD DEVIATION FOR UNBALANCED ALARM",
        "info": "",
        "x": 380,
        "y": 680,
        "wires": []
    },
    {
        "id": "3b7f4495131a190d",
        "type": "function",
        "z": "b9b3963f10f4b55a",
        "name": "function 11",
        "func": "for (var i = 0; i < msg.payload.length; i++) {\n    var newMsg = {};\n    newMsg.payload = {\n        var date = msg.payload[0].Date ;\n        WR 1: msg.payload[i][\"Month & Year\"]\n        Specific Yield1 :\n    }\n\n    node.send(newMsg);\n\n}\nreturn msg;\n\n\n\nlet plantObj\nplantObj = []\n{\n    var date = msg.payload[i].Date;\n    var ag1 = msg.payload[i][\"WR 1 (Wh)\"];\n    var specificyield1 = msg.payload[i][\"Specific Yield (kWh / kWp)\"];\n    var ag2 = msg.payload[i][\"WR 2 (Wh)\"];\n    var specificyield2 = msg.payload[i][\"Specific Yield (kWh / kWp)\"];\n    \n    var max1 = Math.max(msg.payload[i][\"Specific Yield (kWh / kWp)\"]);\n    var max2 = Math.max(msg.payload[i][\"Specific Yield (kWh / kWp)\"]);\n\n    var eg1 = max1 * capacity1;\n    var eg2 = max2 * capacity2;\n\n    var gl1 = eg1 - ag1;\n    var gl2 = eg2 - ag2;\n\n\n\n\n    if (eae >= eaemin) {\n        var EAE_DAY = eae - eaemin\n    }\n    var obj =\n    {\n        time,\n        eaemin,\n        eae,\n        EAE_DAY\n    }\n    plantObj.push(obj)\n}\nmsg.payload = plantObj\nreturn msg;",
        "outputs": 1,
        "noerr": 18,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 770,
        "y": 240,
        "wires": [
            [
                "610a2a5267c12782"
            ]
        ]
    },
    {
        "id": "56930cac3f971f47",
        "type": "debug",
        "z": "b9b3963f10f4b55a",
        "name": "debug 129",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 750,
        "y": 300,
        "wires": []
    },
    {
        "id": "b95d9ad4386e5805",
        "type": "debug",
        "z": "b9b3963f10f4b55a",
        "name": "debug 130",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 470,
        "y": 300,
        "wires": []
    },
    {
        "id": "e2d44583b3233890",
        "type": "file in",
        "z": "0c1b1859b9604edf",
        "name": "31 oct",
        "filename": "C:\\Users\\MALAVIKA\\Downloads\\31_Oct.csv",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 450,
        "y": 540,
        "wires": [
            [
                "112627f2a2efef63"
            ]
        ]
    },
    {
        "id": "57af9ec477af1fbc",
        "type": "inject",
        "z": "0c1b1859b9604edf",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "v": "",
                "vt": "date"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payloadType": "date",
        "x": 310,
        "y": 540,
        "wires": [
            [
                "e2d44583b3233890"
            ]
        ]
    },
    {
        "id": "c443bfe9e25f2bc7",
        "type": "debug",
        "z": "0c1b1859b9604edf",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1010,
        "y": 580,
        "wires": []
    },
    {
        "id": "87453be4fe960141",
        "type": "file in",
        "z": "0c1b1859b9604edf",
        "name": "all-india-renewable-gene",
        "filename": "/home/ubuntu/Downloads/all-india-renewable-gene.csv",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 590,
        "y": 280,
        "wires": [
            [
                "ed0eeee912247d06"
            ]
        ]
    },
    {
        "id": "c515274dc842be0e",
        "type": "inject",
        "z": "0c1b1859b9604edf",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "v": "",
                "vt": "date"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payloadType": "date",
        "x": 360,
        "y": 280,
        "wires": [
            [
                "87453be4fe960141"
            ]
        ]
    },
    {
        "id": "ed0eeee912247d06",
        "type": "csv",
        "z": "0c1b1859b9604edf",
        "name": "",
        "sep": ",",
        "hdrin": true,
        "hdrout": "none",
        "multi": "mult",
        "ret": "\\n",
        "temp": "",
        "skip": "0",
        "strings": true,
        "include_empty_strings": "",
        "include_null_values": "",
        "x": 770,
        "y": 280,
        "wires": [
            [
                "87f4a7314cfe1826",
                "53b85f476fae4e1f",
                "74fc0e56edbbeb35"
            ]
        ]
    },
    {
        "id": "87f4a7314cfe1826",
        "type": "function",
        "z": "0c1b1859b9604edf",
        "name": "",
        "func": "for (var i = 0; i < msg.payload.length;i++)\n{\n    var newMsg = {};\n    newMsg.payload = {\n        solar:msg.payload[i].Solar,\n        date:msg.payload[i][\"Month & Year\"]\n    }\n        \n    node.send(newMsg);\n\n}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 880,
        "y": 240,
        "wires": [
            [
                "5ff97ed93b3e6f70"
            ]
        ]
    },
    {
        "id": "53b85f476fae4e1f",
        "type": "debug",
        "z": "0c1b1859b9604edf",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 970,
        "y": 340,
        "wires": []
    },
    {
        "id": "5ff97ed93b3e6f70",
        "type": "debug",
        "z": "0c1b1859b9604edf",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1030,
        "y": 220,
        "wires": []
    },
    {
        "id": "74fc0e56edbbeb35",
        "type": "influxdb out",
        "z": "0c1b1859b9604edf",
        "influxdb": "74084a2821e07143",
        "name": "",
        "measurement": "details",
        "precision": "",
        "retentionPolicy": "",
        "database": "database",
        "precisionV18FluxV20": "ms",
        "retentionPolicyV18Flux": "",
        "org": "organisation",
        "bucket": "bucket",
        "x": 980,
        "y": 280,
        "wires": []
    },
    {
        "id": "3819693c332b011a",
        "type": "function",
        "z": "0c1b1859b9604edf",
        "name": "",
        "func": "\n    for (var i = 0; i < msg.payload.length;i++)\n{\n    var newMsg = {};\n    newMsg.payload = {\n        plantName:msg.payload[i][\"Station\"],\n        capacity:msg.payload[i][\"Installed Capacity\"],\n        generated:msg.payload[i][\"Actual Generation\"]\n    }\n    node.send(newMsg);\n}\nreturn null;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 720,
        "y": 540,
        "wires": [
            [
                "93d6bed0ea8dcf38",
                "b07ebaa7e459da83"
            ]
        ]
    },
    {
        "id": "93d6bed0ea8dcf38",
        "type": "function",
        "z": "0c1b1859b9604edf",
        "name": "condition",
        "func": "var capacity = msg.payload.capacity\nvar PlantName = msg.payload.plantName\nvar generated = msg.payload.generated\nif(capacity >=\"1000.00\")\n{\n    msg.payload =\n    {\n       PlantName,\n       capacity,\n        note:\"high capacity\",\n        generated,\n        \n    }\n    \n}else\n{\n    msg.payload =\n    {\n       PlantName,\n       capacity,\n       note:\"low capacity\",\n       generated,\n        \n    }\n    \n}\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 820,
        "y": 580,
        "wires": [
            [
                "c443bfe9e25f2bc7",
                "83febc1f741ea4ab"
            ]
        ]
    },
    {
        "id": "fcd81f12f6796142",
        "type": "debug",
        "z": "0c1b1859b9604edf",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 730,
        "y": 460,
        "wires": []
    },
    {
        "id": "b07ebaa7e459da83",
        "type": "debug",
        "z": "0c1b1859b9604edf",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 890,
        "y": 540,
        "wires": []
    },
    {
        "id": "a669bba3ccf00845",
        "type": "file in",
        "z": "0c1b1859b9604edf",
        "name": "31 oct",
        "filename": "C:\\Users\\MALAVIKA\\Downloads\\31_Oct.csv",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 590,
        "y": 1060,
        "wires": [
            [
                "681557dd5b3920f2",
                "a9619ad15f778d3d"
            ]
        ]
    },
    {
        "id": "681557dd5b3920f2",
        "type": "csv",
        "z": "0c1b1859b9604edf",
        "name": "",
        "sep": ",",
        "hdrin": true,
        "hdrout": "none",
        "multi": "mult",
        "ret": "\\n",
        "temp": "",
        "skip": "0",
        "strings": false,
        "include_empty_strings": "",
        "include_null_values": "",
        "x": 750,
        "y": 1100,
        "wires": [
            [
                "97e69dd357025726",
                "51e8937b6b90901f"
            ]
        ]
    },
    {
        "id": "53341a965992cbad",
        "type": "debug",
        "z": "0c1b1859b9604edf",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1130,
        "y": 1120,
        "wires": []
    },
    {
        "id": "c565d6e4755bfecb",
        "type": "inject",
        "z": "0c1b1859b9604edf",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "v": "29",
                "vt": "num"
            },
            {
                "p": "uv",
                "v": "5",
                "vt": "num"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payloadType": "date",
        "x": 490,
        "y": 860,
        "wires": [
            [
                "a669bba3ccf00845"
            ]
        ]
    },
    {
        "id": "a9619ad15f778d3d",
        "type": "debug",
        "z": "0c1b1859b9604edf",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 750,
        "y": 960,
        "wires": []
    },
    {
        "id": "97e69dd357025726",
        "type": "function",
        "z": "0c1b1859b9604edf",
        "name": "",
        "func": "\n    for (var i = 63; i < msg.payload.length;i++)\n{\n    var newMsg = {};\n    newMsg.payload = {\n        plantName:msg.payload[i][\"Station\"],\n        capacity:msg.payload[i][\"Installed Capacity\"],\n        generated:msg.payload[i][\"Actual Generation\"]\n    }\n    node.send(newMsg);\n}\nreturn null;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 940,
        "y": 1100,
        "wires": [
            [
                "53341a965992cbad"
            ]
        ]
    },
    {
        "id": "51e8937b6b90901f",
        "type": "debug",
        "z": "0c1b1859b9604edf",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 950,
        "y": 1040,
        "wires": []
    },
    {
        "id": "112627f2a2efef63",
        "type": "csv",
        "z": "0c1b1859b9604edf",
        "name": "",
        "sep": ",",
        "hdrin": true,
        "hdrout": "none",
        "multi": "mult",
        "ret": "\\n",
        "temp": "",
        "skip": "0",
        "strings": true,
        "include_empty_strings": "",
        "include_null_values": "",
        "x": 570,
        "y": 540,
        "wires": [
            [
                "fcd81f12f6796142",
                "3819693c332b011a"
            ]
        ]
    },
    {
        "id": "83febc1f741ea4ab",
        "type": "switch",
        "z": "0c1b1859b9604edf",
        "name": "",
        "property": "payload.capacity",
        "propertyType": "msg",
        "rules": [
            {
                "t": "gt",
                "v": "4000",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 830,
        "y": 620,
        "wires": [
            [
                "4191975b27a14990"
            ]
        ]
    },
    {
        "id": "8a4a868bb8e9ebd3",
        "type": "file in",
        "z": "0c1b1859b9604edf",
        "name": "new",
        "filename": "C:\\Users\\MALAVIKA\\Downloads\\5286_INV03_1638437408_3.csv",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 490,
        "y": 1540,
        "wires": [
            [
                "e44582f862341e2b"
            ]
        ]
    },
    {
        "id": "f6fceb8a292a05e5",
        "type": "inject",
        "z": "0c1b1859b9604edf",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "v": "",
                "vt": "date"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payloadType": "date",
        "x": 360,
        "y": 1540,
        "wires": [
            [
                "8a4a868bb8e9ebd3"
            ]
        ]
    },
    {
        "id": "6e90e218df2de495",
        "type": "function",
        "z": "0c1b1859b9604edf",
        "name": "",
        "func": "\n    for (var i = 0; i < msg.payload.length;i++)\n{\n    var newMsg = {};\n    newMsg.payload = {\n        \n        DG01:msg.payload[i].DG01_PAC,\n        DGO2:msg.payload[i].DG02_PAC,\n        DG03:msg.payload[i].DG03_PAC\n    }\n    node.send(newMsg);\n}\nreturn null;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 720,
        "y": 1580,
        "wires": [
            [
                "935dd5238c4b76a1",
                "cc419216190607af"
            ]
        ]
    },
    {
        "id": "935dd5238c4b76a1",
        "type": "function",
        "z": "0c1b1859b9604edf",
        "name": "condition",
        "func": "var capacity = msg.payload.capacity\nvar PlantName = msg.payload.plantName\nvar generated = msg.payload.generated\nif(capacity >=\"1000.00\")\n{\n    msg.payload =\n    {\n       PlantName,\n       capacity,\n        note:\"high capacity\",\n        generated,\n        \n    }\n    \n}else\n{\n    msg.payload =\n    {\n       PlantName,\n       capacity,\n       note:\"low capacity\",\n       generated,\n        \n    }\n    \n}\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 880,
        "y": 1620,
        "wires": [
            []
        ]
    },
    {
        "id": "a3e6b19a8b5df2c8",
        "type": "debug",
        "z": "0c1b1859b9604edf",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 790,
        "y": 1520,
        "wires": []
    },
    {
        "id": "cc419216190607af",
        "type": "debug",
        "z": "0c1b1859b9604edf",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 970,
        "y": 1580,
        "wires": []
    },
    {
        "id": "e44582f862341e2b",
        "type": "csv",
        "z": "0c1b1859b9604edf",
        "name": "",
        "sep": ",",
        "hdrin": true,
        "hdrout": "none",
        "multi": "mult",
        "ret": "\\n",
        "temp": "",
        "skip": "1",
        "strings": true,
        "include_empty_strings": "",
        "include_null_values": "",
        "x": 630,
        "y": 1540,
        "wires": [
            [
                "a3e6b19a8b5df2c8",
                "6e90e218df2de495"
            ]
        ]
    },
    {
        "id": "4191975b27a14990",
        "type": "debug",
        "z": "0c1b1859b9604edf",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1010,
        "y": 620,
        "wires": []
    },
    {
        "id": "b14954fb859aa1fa",
        "type": "cronplus",
        "z": "3b83b93404c8b14f",
        "name": "",
        "outputField": "payload",
        "timeZone": "",
        "persistDynamic": false,
        "commandResponseMsgOutput": "output1",
        "outputs": 1,
        "options": [
            {
                "name": "schedule1",
                "topic": "topic1",
                "payloadType": "default",
                "payload": "",
                "expressionType": "cron",
                "expression": "0 */5 * * * *",
                "location": "",
                "offset": "0",
                "solarType": "all",
                "solarEvents": "sunrise,sunset"
            }
        ],
        "x": 360,
        "y": 100,
        "wires": [
            [
                "20ba7bbedd8c5226"
            ]
        ]
    },
    {
        "id": "9c396b8e25ac45e6",
        "type": "function",
        "z": "3b83b93404c8b14f",
        "name": "function 115",
        "func": "\nvar plant = msg.payload.plant;\n//var iid = msg.payload.iid;\nvar device = msg.payload.device;\nvar field = msg.payload.field;\nvar measurement = msg.payload.measurement;\nvar factor = msg.payload.factor;\n\nvar $today = new Date();\nvar d = new Date($today);\nd.setDate($today.getDate());\nd.setHours(0, 0, 0, 0);\nvar d1 = new Date($today);\nvar tstart = new Date(d).toISOString();\nvar tend = new Date(d1).toISOString();\n\n\n\n//var q = ' from(bucket: \"hysolwin\") |> range(start:-10d)  |>filter(fn: =>r[\"_measurement\"]== \\\"' + measurement + '\\\")|>filter(fn:=>r[\"p\"]== \\\"' + plant + '\\\")|>filter(fn:=>r[\"dt\"]== \\\"' + device + '\\\")|>filter(fn:=>r[\"f\"]== \\\"' + field + '\\\") |> aggregateWindow(every: 5m, fn: last, createEmpty: false)|>yield(name:\"last\")'\nvar q = ' from(bucket: \"hysolwin\")|> range(start: -10d) |> filter(fn:  => r[\"_measurement\"] == \"v\") |> filter(fn:  => r[\"p\"] == \\\"' + plant + '\\\") |> filter(fn:  => r[\"d\"] == \\\"' + device + '\\\") |> filter(fn:  => r[\"f\"] == \\\"' + field +'\\\") |> filter(fn:  => r[\"_field\"] == \"value\") |> aggregateWindow(every: 5m,fn: last,)|> fill(column: \"_value\", usePrevious: true) |> yield(name: \"last\")'\n\nmsg.query = q\nmsg.payload=d\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 690,
        "y": 180,
        "wires": [
            [
                "98ae925539d83e7e"
            ]
        ]
    },
    {
        "id": "25480b3f5090c831",
        "type": "csv",
        "z": "3b83b93404c8b14f",
        "name": "",
        "sep": ",",
        "hdrin": true,
        "hdrout": "once",
        "multi": "one",
        "ret": "\\n",
        "temp": "",
        "skip": "0",
        "strings": false,
        "include_empty_strings": "",
        "include_null_values": "",
        "x": 550,
        "y": 180,
        "wires": [
            [
                "9c396b8e25ac45e6"
            ]
        ]
    },
    {
        "id": "20ba7bbedd8c5226",
        "type": "template",
        "z": "3b83b93404c8b14f",
        "name": "CSV data",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "plant,measurement,iid,device,field,factor\nhysolwin,v,5231,INV01,TOTAL_INV_EAE_DAY,1.0\nhysolwin,v,5231,INV22,TOTAL_INV_EAE_DAY,1.0\nhysolwin,v,5231,INV08,TOTAL_INV_EAE_DAY,1.0\nhysolwin,v,5231,INV14,TOTAL_INV_EAE_DAY,1.0",
        "output": "str",
        "x": 420,
        "y": 180,
        "wires": [
            [
                "25480b3f5090c831"
            ]
        ]
    },
    {
        "id": "98ae925539d83e7e",
        "type": "debug",
        "z": "3b83b93404c8b14f",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 730,
        "y": 240,
        "wires": []
    },
    {
        "id": "a66ff063bba02b51",
        "type": "inject",
        "z": "3b83b93404c8b14f",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 160,
        "y": 420,
        "wires": [
            [
                "581124f3cace473a"
            ]
        ]
    },
    {
        "id": "581124f3cace473a",
        "type": "template",
        "z": "3b83b93404c8b14f",
        "name": "",
        "field": "payload",
        "fieldType": "msg",
        "format": "javascript",
        "syntax": "mustache",
        "template": "const puppeteer = require('puppeteer');\n\nasync function fetchMonthlySummaryValues() {\n  const url = 'https://egauge75568.d.egauge.net/616DC/l/en_GB/stats.html'; // Replace with the actual URL of your eGauge meter UI\n  const selector = '#monthlySummaryBody > tr:nth-child(3) > td:nth-child(2) > span > a'; // Replace with the actual selector for the monthly summary values\n\n  try {\n    const browser = await puppeteer.launch();\n    const page = await browser.newPage();\n    await page.goto(url);\n\n    // Wait for the selector to be available in the DOM\n    await page.waitForSelector(selector);\n\n    // Fetch all the monthly summary values\n    const monthlySummaryValues = await page.$$eval(selector, elements =>\n      elements.map(element => element.textContent)\n    );\n\n    // Do something with the monthly summary values\n    console.log('Monthly Summary Values:', monthlySummaryValues);\n\n    await browser.close();\n  } catch (error) {\n    console.error('Error:', error);\n  }\n}\n\nfetchMonthlySummaryValues();\n\n\n\n",
        "output": "str",
        "x": 320,
        "y": 420,
        "wires": [
            [
                "fe1d1a7ffc55b382"
            ]
        ]
    },
    {
        "id": "fe1d1a7ffc55b382",
        "type": "file",
        "z": "3b83b93404c8b14f",
        "name": "",
        "filename": "/home/iplon/test.js",
        "filenameType": "str",
        "appendNewline": true,
        "createDir": false,
        "overwriteFile": "true",
        "encoding": "none",
        "x": 510,
        "y": 420,
        "wires": [
            [
                "30736f8af2358ab5"
            ]
        ]
    },
    {
        "id": "30736f8af2358ab5",
        "type": "exec",
        "z": "3b83b93404c8b14f",
        "command": "cd /home/iplon && node test.js",
        "addpay": "",
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "",
        "x": 770,
        "y": 420,
        "wires": [
            [
                "92d5d178fbc0865c"
            ],
            [
                "bb2e1aa0981a2f09"
            ],
            []
        ]
    },
    {
        "id": "92d5d178fbc0865c",
        "type": "debug",
        "z": "3b83b93404c8b14f",
        "name": "debug 195",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1130,
        "y": 380,
        "wires": []
    },
    {
        "id": "bb2e1aa0981a2f09",
        "type": "debug",
        "z": "3b83b93404c8b14f",
        "name": "error",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1050,
        "y": 540,
        "wires": []
    },
    {
        "id": "293ff932076e130b",
        "type": "csv",
        "z": "3b83b93404c8b14f",
        "name": "",
        "sep": ",",
        "hdrin": "",
        "hdrout": "none",
        "multi": "one",
        "ret": "\\n",
        "temp": "",
        "skip": "0",
        "strings": true,
        "include_empty_strings": "",
        "include_null_values": true,
        "x": 830,
        "y": 300,
        "wires": [
            [
                "34c6e624194d4996"
            ]
        ]
    },
    {
        "id": "34c6e624194d4996",
        "type": "join",
        "z": "3b83b93404c8b14f",
        "name": "",
        "mode": "auto",
        "build": "object",
        "property": "payload",
        "propertyType": "msg",
        "key": "topic",
        "joiner": "\\n",
        "joinerType": "str",
        "accumulate": "false",
        "timeout": "",
        "count": "",
        "reduceRight": false,
        "x": 990,
        "y": 300,
        "wires": [
            []
        ]
    },
    {
        "id": "902f93d762e52bf7",
        "type": "inject",
        "z": "3b83b93404c8b14f",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 160,
        "y": 620,
        "wires": [
            [
                "9b6c76154d4b9aba"
            ]
        ]
    },
    {
        "id": "9b6c76154d4b9aba",
        "type": "template",
        "z": "3b83b93404c8b14f",
        "name": "",
        "field": "payload",
        "fieldType": "msg",
        "format": "javascript",
        "syntax": "mustache",
        "template": "const puppeteer = require('puppeteer');\n\nasync function fetchMonthlySummaryValues() {\n  const url = 'https://egauge75568.d.egauge.net/616DC/l/en_GB/stats.html'; // Replace with the actual URL of your eGauge meter UI\n  const tasks = [\n    { selector: 'td.year.right_border', label: 'Year' },\n    //{ selector: '#monthlySummaryBody > tr: nth - child(4) > td.year.right_border', label: 'year' },\n    { selector: '#monthlySummaryBody > tr:nth-child(3) > td:nth-child(2) > span > a', label:'jan' },\n    { selector: '#monthlySummaryBody > tr:nth-child(3) > td:nth-child(3) > span > a', label:'feb' },\n    { selector: '#monthlySummaryBody > tr:nth-child(3) > td:nth-child(4) > span > a', label:'mar' },\n    { selector: '#monthlySummaryBody > tr:nth-child(3) > td:nth-child(5) > span > a', label:'apr' },\n    { selector: '#monthlySummaryBody > tr:nth-child(3) > td:nth-child(6) > span > a', label:'may' },\n    { selector: '#monthlySummaryBody > tr:nth-child(3) > td:nth-child(7) > span > a', label:'jun' },\n    //{ selector: '#monthlySummaryBody > tr:nth-child(3) > td:nth-child(8) > span > a', label:'jul' },\n    //{ selector: '#monthlySummaryBody > tr:nth-child(3) > td:nth-child(9) > span > a', label:'aug' },\n    //{ selector: '#monthlySummaryBody > tr:nth-child(3) > td:nth-child(10) > span > a', label:'sep' },\n    //{ selector: '#monthlySummaryBody > tr:nth-child(3) > td:nth-child(11) > span > a', label:'oct' },\n    //{ selector: '#monthlySummaryBody > tr:nth-child(3) > td:nth-child(12) > span > a', label:'nov' },\n    //{ selector: '#monthlySummaryBody > tr:nth-child(3) > td:nth-child(13) > span > a', label:'dec' },\n    { selector: '#monthlySummaryBody > tr:nth-child(3) > td.total.left_border > span > a', label:'Total' },\n    // Add more tasks as needed\n  ];\n\n  try {\n    const browser = await puppeteer.launch();\n    const page = await browser.newPage();\n    await page.goto(url);\n\n    for (const task of tasks) {\n      // Wait for the selector to be available in the DOM\n      await page.waitForSelector(task.selector);\n\n      // Fetch the value\n      const value = await page.$eval(task.selector, element => element.textContent);\n\n      // Do something with the value\n      console.log(`${task.label}:`, value);\n    }\n\n    await browser.close();\n  } catch (error) {\n    console.error('Error:', error);\n  }\n}\n\nfetchMonthlySummaryValues();\n\n\n\n\n",
        "output": "str",
        "x": 320,
        "y": 620,
        "wires": [
            [
                "8e4610a835be502b"
            ]
        ]
    },
    {
        "id": "8e4610a835be502b",
        "type": "file",
        "z": "3b83b93404c8b14f",
        "name": "",
        "filename": "/home/iplon/test.js",
        "filenameType": "str",
        "appendNewline": true,
        "createDir": false,
        "overwriteFile": "true",
        "encoding": "none",
        "x": 510,
        "y": 620,
        "wires": [
            [
                "f51ca2172a66d191"
            ]
        ]
    },
    {
        "id": "f51ca2172a66d191",
        "type": "exec",
        "z": "3b83b93404c8b14f",
        "command": "cd /home/iplon && node test.js",
        "addpay": "",
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "",
        "x": 770,
        "y": 620,
        "wires": [
            [
                "c5f7e878061633da"
            ],
            [
                "b32abe77e3dbb7e1"
            ],
            []
        ]
    },
    {
        "id": "b32abe77e3dbb7e1",
        "type": "debug",
        "z": "3b83b93404c8b14f",
        "name": "error",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1050,
        "y": 740,
        "wires": []
    },
    {
        "id": "c5f7e878061633da",
        "type": "debug",
        "z": "3b83b93404c8b14f",
        "name": "debug 196",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1050,
        "y": 620,
        "wires": []
    },
    {
        "id": "438437befb729268",
        "type": "function",
        "z": "9def7eb5ccec2475",
        "name": "Meter API's",
        "func": "// Array of URLs\nvar urls = [\n    \"https://egauge75568.d.egauge.net/cgi-bin/egauge-show?d&a&c\"\n    //\"https://egauge75569.d.egauge.net/cgi-bin/egauge-show?d&a&c\",\n    //\"https://egauge75570.d.egauge.net/cgi-bin/egauge-show?d&a&c\",\n    //\"https://egauge77153.d.egauge.net/cgi-bin/egauge-show?d&a&c\",\n    //\"https://egauge77154.d.egauge.net/cgi-bin/egauge-show?d&a&c\",\n    //\"https://egauge83559.d.egauge.net/cgi-bin/egauge-show?d&a&c\"\n\n];\n\n// Set the array of URLs as a property of the message\nmsg.payload = urls;\n\n// Return the modified message\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 210,
        "y": 160,
        "wires": [
            [
                "65298175bd50c067"
            ]
        ]
    },
    {
        "id": "50a45005d5a80fb9",
        "type": "influxdb batch",
        "z": "9def7eb5ccec2475",
        "influxdb": "bd932ff2.1cb77",
        "precision": "",
        "retentionPolicy": "",
        "name": "",
        "database": "database",
        "precisionV18FluxV20": "s",
        "retentionPolicyV18Flux": "",
        "org": "Test",
        "bucket": "egaugemeter",
        "x": 1330,
        "y": 160,
        "wires": []
    },
    {
        "id": "a687f79a6b8e19b8",
        "type": "inject",
        "z": "9def7eb5ccec2475",
        "name": "",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 100,
        "y": 100,
        "wires": [
            [
                "438437befb729268"
            ]
        ]
    },
    {
        "id": "655620bc3d8e4424",
        "type": "http request",
        "z": "9def7eb5ccec2475",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 650,
        "y": 160,
        "wires": [
            [
                "7f74908a6807df88"
            ]
        ]
    },
    {
        "id": "65298175bd50c067",
        "type": "split",
        "z": "9def7eb5ccec2475",
        "name": "",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 350,
        "y": 160,
        "wires": [
            [
                "162dab55dfba09c3"
            ]
        ]
    },
    {
        "id": "162dab55dfba09c3",
        "type": "change",
        "z": "9def7eb5ccec2475",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "url",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 490,
        "y": 160,
        "wires": [
            [
                "655620bc3d8e4424"
            ]
        ]
    },
    {
        "id": "7f74908a6807df88",
        "type": "csv",
        "z": "9def7eb5ccec2475",
        "name": "",
        "sep": ",",
        "hdrin": true,
        "hdrout": "none",
        "multi": "mult",
        "ret": "\\n",
        "temp": "",
        "skip": "0",
        "strings": true,
        "include_empty_strings": "",
        "include_null_values": true,
        "x": 790,
        "y": 160,
        "wires": [
            [
                "730c34d8b2dfc772",
                "ac1f6044005ce927"
            ]
        ]
    },
    {
        "id": "a895bf4742497650",
        "type": "function",
        "z": "9def7eb5ccec2475",
        "name": "Influx 2.0",
        "func": "// Extract the meter name from API\nvar url = msg.url\nvar parsedValue = url.split(\"https://\")[1].split(\".\")[0];\n\nfor (var i = 0; i < msg.payload.length; i++) {\n    var dateUTC = new Date(msg.payload[i].timestamp).getTime();\n    var obj = {};\n    obj.payload = [{\n        measurement: \"report\",\n        fields: {\n            value: msg.payload[i].result,\n            text: \"0\",\n            qu: \"0\"\n        },\n        tags: {\n            \n            b: \"B\",\n            bd: \"B_EM\",\n            d: parsedValue,\n            dd: \"EM\",\n            dt: \"EM\",\n            f: \"EAE_DAY\",\n            fd: \"generation\",\n            h: parsedValue,\n            iid: parsedValue,\n            m: \"1\",\n            p: \"egauge\",\n            u: \"kwh\"\n        },\n        timestamp: dateUTC\n    }];\n    node.send(obj);\n}\nreturn null;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1120,
        "y": 160,
        "wires": [
            [
                "1eb2e08041f17d5a",
                "50a45005d5a80fb9"
            ]
        ]
    },
    {
        "id": "d00e0d4b41fab196",
        "type": "debug",
        "z": "9def7eb5ccec2475",
        "name": "debug 192",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1070,
        "y": 240,
        "wires": []
    },
    {
        "id": "ac1f6044005ce927",
        "type": "debug",
        "z": "9def7eb5ccec2475",
        "name": "debug 193",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 870,
        "y": 240,
        "wires": []
    },
    {
        "id": "730c34d8b2dfc772",
        "type": "function",
        "z": "9def7eb5ccec2475",
        "name": "function 116",
        "func": "let time = [];\nlet value = [];\n\nfor (var i = 0; i < msg.payload.length; i++) {\n    var timestamp = msg.payload[i][\"Date & Time\"];\n    var generation = msg.payload[i][\"Generation [kWh]\"];\n\n    // Push the values to the respective arrays\n    time.push(timestamp);\n    value.push(generation);\n}\n\nvar objArray = [];\nfor (var j = 0; j < msg.payload.length - 1; j++) {\n    var obj = {\n        timestamp: time[j],\n        result: value[j] - value[j + 1]\n    };\n    objArray.push(obj);\n}\n\nmsg.payload = objArray;\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 950,
        "y": 160,
        "wires": [
            [
                "d00e0d4b41fab196",
                "a895bf4742497650"
            ]
        ]
    },
    {
        "id": "1eb2e08041f17d5a",
        "type": "debug",
        "z": "9def7eb5ccec2475",
        "name": "debug 194",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1290,
        "y": 240,
        "wires": []
    },
    {
        "id": "bda13ea9082c8057",
        "type": "function",
        "z": "a2e6272886e0a355",
        "name": "plantname_collect",
        "func": "\nvar name = msg.payload.name\nmsg.payload = name\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 350,
        "y": 260,
        "wires": [
            [
                "8c0883fca46f4ccd"
            ]
        ]
    },
    {
        "id": "6c71cff11e33d0bd",
        "type": "function",
        "z": "a2e6272886e0a355",
        "name": "pdf to hex",
        "func": "\nvar hex = Buffer.from(msg.payload).toString('hex');\nmsg.payload = \"\\\\x\" + hex;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 360,
        "y": 380,
        "wires": [
            [
                "8e7958374857c71c"
            ]
        ]
    },
    {
        "id": "601c8cd5a1d65a7f",
        "type": "debug",
        "z": "a2e6272886e0a355",
        "name": "debug 124",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 790,
        "y": 380,
        "wires": []
    },
    {
        "id": "75d4248264377306",
        "type": "debug",
        "z": "a2e6272886e0a355",
        "name": "debug 125",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1010,
        "y": 260,
        "wires": []
    },
    {
        "id": "8c0883fca46f4ccd",
        "type": "function",
        "z": "a2e6272886e0a355",
        "name": "plantname_collect",
        "func": "let content4\nvar content5 = 0;\ncontent4 = []\ncontent4.length = 0;\n\nvar today = new Date();\nvar date = today.getDate() + '-' + (today.getMonth() + 1) + '-' + today.getFullYear();\nvar time = today.getHours() + \":\" + today.getMinutes() + \":\" + today.getSeconds();\nvar nowTime3 = date + ' ' + time;\n\ncontent4 = flow.get(\"plant_pdf\")\n{\n    var value1 = msg.payload\n    var value2 = {\n        value1,\n        nowTime3\n    }\n    content4.push(value2)\n}\n\nflow.set(\"pdf_details\", content4)\nmsg.payload = content4\n\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 570,
        "y": 260,
        "wires": [
            [
                "f901d063d7549ad8"
            ]
        ]
    },
    {
        "id": "8e7958374857c71c",
        "type": "function",
        "z": "a2e6272886e0a355",
        "name": "push pdf data",
        "func": "let content3\n\ncontent3 = []\ncontent3.length = 0;\n\n\nvar pdfdata = msg.payload\n\n//content3.push(nowTime1)\n\n\n{\nvar value = {\n    pdfdata\n}\ncontent3.push(value)\n\n}\n\n\nflow.set(\"plant_pdf\", content3)\nmsg.payload = content3\n\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 580,
        "y": 380,
        "wires": [
            [
                "601c8cd5a1d65a7f"
            ]
        ]
    },
    {
        "id": "cf62b3d0dc736e86",
        "type": "template",
        "z": "a2e6272886e0a355",
        "name": "",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "INSERT INTO public.documentations(\"plantname\" , \"documents\")\nVALUES ( '{{payload.plantname}}' , '{{payload.pdfdata}}')",
        "output": "str",
        "x": 1060,
        "y": 320,
        "wires": [
            [
                "932623650a0f1c32",
                "5601f515810b6cd6"
            ]
        ]
    },
    {
        "id": "932623650a0f1c32",
        "type": "debug",
        "z": "a2e6272886e0a355",
        "name": "debug 126",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1250,
        "y": 260,
        "wires": []
    },
    {
        "id": "f901d063d7549ad8",
        "type": "function",
        "z": "a2e6272886e0a355",
        "name": "plantname_group",
        "func": "let result = []\n\nvar time = msg.payload[1].nowTime3\nvar plantname = msg.payload[1].value1\nvar pdfdata = msg.payload[0].pdfdata\n\nresult = {\n    time,\n    plantname,\n    pdfdata\n}\nmsg.payload = result\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 790,
        "y": 260,
        "wires": [
            [
                "75d4248264377306",
                "cf62b3d0dc736e86"
            ]
        ]
    },
    {
        "id": "73489992fa057b4e",
        "type": "ui_upload",
        "z": "a2e6272886e0a355",
        "group": "4178bf61.05d97",
        "title": "upload",
        "accept": "",
        "name": "",
        "order": 2,
        "width": 0,
        "height": "0",
        "chunk": "1000",
        "transfer": "binary",
        "x": 150,
        "y": 380,
        "wires": [
            [
                "6c71cff11e33d0bd"
            ]
        ]
    },
    {
        "id": "5601f515810b6cd6",
        "type": "postgres",
        "z": "a2e6272886e0a355",
        "postgresdb": "5b3dccc565744020",
        "name": "",
        "output": false,
        "perrow": false,
        "rowspermsg": "1",
        "return_on_error": false,
        "limit_queries": "0",
        "limit_by": "payload",
        "limit_value": "1",
        "limit_drop_intermediate": false,
        "limit_drop_if_in_queue": false,
        "outputs": false,
        "x": 1200,
        "y": 400,
        "wires": []
    },
    {
        "id": "4402d24c6ba0d9fb",
        "type": "ui_form",
        "z": "a2e6272886e0a355",
        "name": "plant_name",
        "label": "",
        "group": "4178bf61.05d97",
        "order": 3,
        "width": 0,
        "height": 0,
        "options": [
            {
                "label": "Plant Name",
                "value": "name",
                "type": "multiline",
                "required": true,
                "rows": 2
            },
            {
                "label": "Attachment",
                "value": "details",
                "type": "multiline",
                "required": true,
                "rows": 2
            }
        ],
        "formValue": {
            "name": "",
            "details": ""
        },
        "payload": "",
        "submit": "submit",
        "cancel": "cancel",
        "topic": "topic",
        "topicType": "msg",
        "splitLayout": "",
        "className": "",
        "x": 150,
        "y": 260,
        "wires": [
            [
                "bda13ea9082c8057"
            ]
        ]
    },
    {
        "id": "a16d9f911a0f2124",
        "type": "inject",
        "z": "7c1a1b3ec858efce",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 250,
        "y": 60,
        "wires": [
            [
                "d0f41aaa9a5e8176"
            ]
        ]
    },
    {
        "id": "7dbc47e265429e4c",
        "type": "function",
        "z": "7c1a1b3ec858efce",
        "name": "filename",
        "func": "var filename = msg.payload.filename\nfunction getDate(d) {\n    var day, month, year;\n\n    var result = d.match(\"[0-9]{2}([\\-/ \\.])[0-9]{2}[\\-/ \\.][0-9]{4}\");\n    if (null != result) {\n        var dateSplitted = result[0].split(result[1]);\n        day = dateSplitted[0];\n        month = dateSplitted[1];\n        year = dateSplitted[2];\n    }\n    result = d.match(\"[0-9]{4}([\\-/ \\.])[0-9]{2}[\\-/ \\.][0-9]{2}\");\n    if (null != result) {\n        dateSplitted = result[0].split(result[1]);\n        day = dateSplitted[2];\n        month = dateSplitted[1];\n        year = dateSplitted[0];\n    }\n\n    if (month > 12) {\n        var aux = day;\n        day = month;\n        month = aux;\n    }\n    //return year + \"/\" + month + \"/\" + day;\n\n    function getMonthName(monthNumber) {\n        const date = new Date();\n        date.setMonth(monthNumber - 1);\n\n        return date.toLocaleString('en-US', { month: 'long' });\n    }\n    return getMonthName(month)\n}\n\nvar month_name = getDate(filename)\n\nvar currentTime = new Date();\nvar currentOffset = currentTime.getTimezoneOffset();\n\nvar ISTOffset = 330;   // IST offset UTC +5:30 \n\nvar today = new Date(currentTime.getTime() + (ISTOffset + currentOffset)*60000);\nvar dd = String(today.getDate()).padStart(2, '0');\nvar mm = String(today.getMonth() + 1).padStart(2, '0'); //January is 0!\nvar yyyy = today.getFullYear();\nvar today1 = dd + '_' + mm + '_' + yyyy;\n\nvar c =today1;\ncontext.set('c',c)\n\nmsg.filename = \"/home/iplon/Downloads/IGOP/Ezeeben  may month csv file/\" + filename\nflow.set(\"month\", month_name);\nflow.set(\"filename\", filename);\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 770,
        "y": 60,
        "wires": [
            [
                "ccf4216c4089cfea",
                "0bb94a78a57f4430",
                "d4c4a68928a4d323",
                "7b0460dd157a000d",
                "0a33bc95fc5a853f",
                "28f51a3fe2e810df"
            ]
        ]
    },
    {
        "id": "f8a7c9d60bee905b",
        "type": "function",
        "z": "7c1a1b3ec858efce",
        "name": "seperate array",
        "func": "\nfunction sleep(ms) {\n   return new Promise(resolve => setTimeout(resolve, ms));\n}\nfor (var i = 0; i < msg.payload.length; i++) {\n   \nvar obj={};\n    obj.payload = { filename: msg.payload[i]}\n\nnode.send(obj)\n    await sleep(15000);\n}\nreturn null ;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 590,
        "y": 60,
        "wires": [
            [
                "7dbc47e265429e4c"
            ]
        ]
    },
    {
        "id": "ccf4216c4089cfea",
        "type": "debug",
        "z": "7c1a1b3ec858efce",
        "name": "debug 15",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 990,
        "y": 60,
        "wires": []
    },
    {
        "id": "067ec493605c2967",
        "type": "file in",
        "z": "7c1a1b3ec858efce",
        "name": "REF data",
        "filename": "/home/iplon/Downloads/PLANT CAPACITY REF FILE/Ezee_Ben_Plants_List 04.07.2023.csv",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 430,
        "y": 520,
        "wires": [
            [
                "870345b490011c60"
            ]
        ]
    },
    {
        "id": "870345b490011c60",
        "type": "csv",
        "z": "7c1a1b3ec858efce",
        "name": "",
        "sep": ",",
        "hdrin": true,
        "hdrout": "none",
        "multi": "mult",
        "ret": "\\n",
        "temp": "",
        "skip": "0",
        "strings": false,
        "include_empty_strings": false,
        "include_null_values": false,
        "x": 560,
        "y": 520,
        "wires": [
            [
                "b0e1de9e2f6ebae8"
            ]
        ]
    },
    {
        "id": "b0e1de9e2f6ebae8",
        "type": "function",
        "z": "7c1a1b3ec858efce",
        "name": "comaprison with ref file",
        "func": "var live_plant=flow.get(\"live_plant\")\nvar column = flow.get(\"column\")\nvar payload = flow.get(\"payload\");\nvar array=[]\nvar payload_array = []\nvar inv_array=[]\nfor (var k = 0; k < payload.length; k++)\n{\n    var final = [payload[k].col1, payload[k].col2, payload[k].col3, payload[k].col4, payload[k].col5, payload[k].col6, payload[k].col7, payload[k].col8, payload[k].col9, payload[k].col10, payload[k].col11, payload[k].col12, payload[k].col13, payload[k].col14, payload[k].col15, payload[k].col16, payload[k].col17, payload[k].col18, payload[k].col19, payload[k].col20, payload[k].col21]\npayload_array.push(final)\n}\nfor (var i = 0; i <msg.payload.length; i++)\n{\n    var Plant_Name = msg.payload[i][\"PLANT NAME\"]\n    var S_NO = msg.payload[i][\"SERIAL NUMBER\"]\n    var INV_NO=parseInt(msg.payload[i][\"NO OF INVERTER\"])\n    var PLANT_SIZE = parseInt(msg.payload[i][\"PLANT SIZE\"])\n  \n    if (live_plant == S_NO) \n      {\n        var capacity = [parseFloat(msg.payload[i][\"WR 1\"]) || \"null\",\n                        parseFloat(msg.payload[i][\"WR 2\"]) || \"null\",\n                        parseFloat(msg.payload[i].wechselrichter) || \"null\",\n                        parseFloat(msg.payload[i][\"WR delta M15A_220\"]) || \"null\",\n                        parseFloat(msg.payload[i][\"ABB WR1\"]) || \"null\",\n                        parseFloat(msg.payload[i].Delta) || \"null\",]\n                                                        \n         \n        for (var j = 1; j <= INV_NO; j++) {\n            inv_array.push(\"WR\" + j)\n        }\n                \n   var obj={\n    Plant_Name,\n    S_NO,\n    INV_NO,\n    PLANT_SIZE\n    \n}\n      \narray.push(obj)     \n      }\n}\nmsg.columns = column\nmsg.payload=payload_array\nflow.set(\"inv_array\", inv_array)\nflow.set(\"INV_CAPACITY\", capacity);\nflow.set(\"plant_info\",array) \nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 750,
        "y": 520,
        "wires": [
            [
                "52a43a47b14dbc9c"
            ]
        ]
    },
    {
        "id": "28f51a3fe2e810df",
        "type": "file in",
        "z": "7c1a1b3ec858efce",
        "name": "Meter data",
        "filename": "filename",
        "filenameType": "msg",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": true,
        "x": 320,
        "y": 200,
        "wires": [
            [
                "ec3942fc0db54eab"
            ]
        ]
    },
    {
        "id": "779a01f132fca52b",
        "type": "function",
        "z": "7c1a1b3ec858efce",
        "name": "main calculation",
        "func": "var inv_cap=flow.get(\"INV_CAPACITY\");\nvar array=[]\n var Total_exp_WR1=0\n var Total_exp_WR2=0\nvar Total_exp_wechselrichter=0\nvar Total_exp_WR_delta_M15A_220=0\nvar Total_exp_ABB_WR1=0\nvar Total_exp_Delta=0\n \nvar Total_ACT_WR1 = 0\nvar Total_ACT_WR2 = 0\nvar Total_ACT_wechselrichter = 0\nvar Total_ACT_WR_delta_M15A_220 = 0\nvar Total_ACT_ABB_WR1 = 0\nvar Total_ACT_Delta = 0\n\nvar Total_gen_loss_WR1=0\nvar Total_gen_loss_WR2 = 0\nvar Total_gen_loss_wechselrichter = 0\nvar Total_gen_loss_WR_delta_M15A_220 = 0\nvar Total_gen_loss_ABB_WR1 = 0\nvar Total_gen_loss_Delta = 0\n\nvar obj\nfor (var i = 0; i < msg.payload.length; i++)\n{  if(i<msg.payload.length){\n    var DATE = msg.payload[i].date\n    var WR_1_kwh = (msg.payload[i][\"WR 1\"])/1000 \n    var WR_1_Sp_Y = msg.payload[i][\"Specific Yield_WR 1\"]\n    var WR_2_kwh = (msg.payload[i][\"WR 2\"])/1000 \n    var WR_2_Sp_Y = msg.payload[i][\"Specific Yield_WR 2\"]\n    var wechselrichter_kwh = (msg.payload[i].Wechselrichter)/1000\n    var WR_delta_M15A_220_kwh = (msg.payload[i][\"WR Delta M15A_220\"]) / 1000\n    var ABB_WR1_kwh = (msg.payload[i][\"ABB WR 1\"])/1000\n    var Delta_kwh = (msg.payload[i].Delta)/1000\n    var wechselrichter_Sp_Y = msg.payload[i][\"Specific Yield_Wechselrichter\"]\n    var WR_delta_M15A_220_Sp_Y = msg.payload[i][\"Specific Yield_WR Delta M15A_220\"]\n    var ABB_WR1_Sp_Y = msg.payload[i][\"Specific Yield_ABB WR 1\"]\n    var Delta_Sp_Y = msg.payload[i][\"Specific Yield_Delta\"]\n   \n\n    var Max_sy = Math.max(WR_1_Sp_Y || 0, WR_2_Sp_Y || 0, wechselrichter_Sp_Y || 0, WR_delta_M15A_220_Sp_Y || 0, ABB_WR1_Sp_Y || 0, Delta_Sp_Y || 0)\n\n    var WR1_INV_CAPACITY=inv_cap[0]\n    var WR2_INV_CAPACITY = inv_cap[1]\n    var wechselrichter_CAPACITY = inv_cap[2]\n    var WR_delta_M15A_220_CAPACITY = inv_cap[3]\n    var ABB_WR1_CAPACITY = inv_cap[4]\n    var Delta_CAPACITY = inv_cap[5]\n\n    var Expected_gen_WR1 = Max_sy * WR1_INV_CAPACITY\n    var Expected_gen_WR2 =Max_sy * WR2_INV_CAPACITY\n    var Expected_gen_wechselrichter =Max_sy* wechselrichter_CAPACITY\n    var Expected_gen_WR_delta_M15A_220 =Max_sy* WR_delta_M15A_220_CAPACITY\n    var Expected_gen_ABB_WR1 =Max_sy* ABB_WR1_CAPACITY\n    var Expected_gen_Delta =Max_sy* Delta_CAPACITY\n\n    Total_exp_WR1 = Total_exp_WR1 + Expected_gen_WR1\n    Total_exp_WR2 = Total_exp_WR2 + Expected_gen_WR2\n    Total_exp_wechselrichter= Total_exp_wechselrichter +Expected_gen_wechselrichter\n    Total_exp_WR_delta_M15A_220= Total_exp_WR_delta_M15A_220 +Expected_gen_WR_delta_M15A_220\n    Total_exp_ABB_WR1= Total_exp_ABB_WR1 +Expected_gen_ABB_WR1\n    Total_exp_Delta= Total_exp_Delta +Expected_gen_Delta\n\n    Total_ACT_WR1 = Total_ACT_WR1 + WR_1_kwh\n    Total_ACT_WR2 = Total_ACT_WR2 + WR_2_kwh\n    Total_ACT_wechselrichter=Total_ACT_wechselrichter+wechselrichter_kwh\n    Total_ACT_WR_delta_M15A_220=Total_ACT_WR_delta_M15A_220+WR_delta_M15A_220_kwh\n    Total_ACT_ABB_WR1=Total_ACT_ABB_WR1+ABB_WR1_kwh\n    Total_ACT_Delta=Total_ACT_Delta+Delta_kwh\n    \n    if ((Expected_gen_WR1 != WR_1_kwh ) || (WR_1_kwh==0)){ var GEN_LOSS_WR1 = (Expected_gen_WR1 - WR_1_kwh) } else { GEN_LOSS_WR1 = \"0\"}\n    if ((Expected_gen_WR2 != WR_2_kwh) || (WR_2_kwh == 0)) { var GEN_LOSS_WR2 = (Expected_gen_WR2 - WR_2_kwh) } else { GEN_LOSS_WR2 = \"0\" }\n    if ((Expected_gen_wechselrichter !=wechselrichter_kwh ) || (wechselrichter_kwh)) {var GEN_LOSS_wechselrichter=(Expected_gen_wechselrichter -wechselrichter_kwh)} else {GEN_LOSS_wechselrichter =\"0\"}\n    if ((Expected_gen_WR_delta_M15A_220 !=WR_delta_M15A_220_kwh ) || (WR_delta_M15A_220_kwh)) {var GEN_LOSS_WR_delta_M15A_220=(Expected_gen_WR_delta_M15A_220 -WR_delta_M15A_220_kwh)} else {GEN_LOSS_WR_delta_M15A_220 =\"0\"}\n    if ((Expected_gen_ABB_WR1 !=ABB_WR1_kwh ) || (ABB_WR1_kwh)) {var GEN_LOSS_ABB_WR1=(Expected_gen_ABB_WR1 -ABB_WR1_kwh)} else {GEN_LOSS_ABB_WR1 =\"0\"}\n    if ((Expected_gen_Delta !=Delta_kwh ) || (Delta_kwh)) {var GEN_LOSS_Delta=(Expected_gen_Delta -Delta_kwh)} else {GEN_LOSS_Delta =\"0\"}\n\n\n    Total_gen_loss_WR1 = Total_gen_loss_WR1 + (Expected_gen_WR1 - WR_1_kwh)\n    Total_gen_loss_WR2 = Total_gen_loss_WR2 + (Expected_gen_WR2 - WR_2_kwh)\n    Total_gen_loss_wechselrichter = Total_gen_loss_wechselrichter + (Expected_gen_wechselrichter -wechselrichter_kwh  )\n    Total_gen_loss_WR_delta_M15A_220 = Total_gen_loss_WR_delta_M15A_220 + (Expected_gen_WR_delta_M15A_220 -WR_delta_M15A_220_kwh  )\n    Total_gen_loss_ABB_WR1 = Total_gen_loss_ABB_WR1 + (Expected_gen_ABB_WR1 -ABB_WR1_kwh  )\n    Total_gen_loss_Delta = Total_gen_loss_Delta + (Expected_gen_Delta -Delta_kwh  )\n\n\n    var total_act_gen = [{\n        Total_ACT_WR1, Total_ACT_WR2, Total_ACT_wechselrichter,Total_ACT_WR_delta_M15A_220,Total_ACT_ABB_WR1,Total_ACT_Delta}]\n    var total_exp_gen = [Total_exp_WR1, Total_exp_WR2, Total_exp_wechselrichter,Total_exp_WR_delta_M15A_220,Total_exp_ABB_WR1,Total_exp_Delta]\n    var totalgen_loss = [Total_gen_loss_WR1, Total_gen_loss_WR2,Total_gen_loss_wechselrichter,Total_gen_loss_WR_delta_M15A_220,Total_gen_loss_ABB_WR1,Total_gen_loss_Delta]\n\n\n    obj = {\n        DATE,\n         WR_1_kwh,\n         WR_1_Sp_Y,\n         WR_2_kwh,\n        WR_2_Sp_Y,\n        wechselrichter_kwh,\n        wechselrichter_Sp_Y,\nWR_delta_M15A_220_kwh,\nWR_delta_M15A_220_Sp_Y,\nABB_WR1_kwh,\nABB_WR1_Sp_Y,\nDelta_kwh,\nDelta_Sp_Y,\n         Max_sy,\n        Expected_gen_WR1:Expected_gen_WR1.toFixed(2),\n        Expected_gen_WR2:Expected_gen_WR2.toFixed(2),\n        Expected_gen_wechselrichter:Expected_gen_wechselrichter.toFixed(2),\n        Expected_gen_WR_delta_M15A_220:Expected_gen_WR_delta_M15A_220.toFixed(2),\n        Expected_gen_ABB_WR1:Expected_gen_ABB_WR1.toFixed(2),\n        Expected_gen_Delta:Expected_gen_Delta.toFixed(2),\n\n        \n        GEN_LOSS_WR1:parseFloat(GEN_LOSS_WR1).toFixed(2),\n        GEN_LOSS_WR2:parseFloat(GEN_LOSS_WR2).toFixed(2),\n        GEN_LOSS_wechselrichter:parseFloat(GEN_LOSS_wechselrichter).toFixed(2),\n        GEN_LOSS_WR_delta_M15A_220:parseFloat(GEN_LOSS_WR_delta_M15A_220).toFixed(2),\n        GEN_LOSS_ABB_WR1:parseFloat(GEN_LOSS_ABB_WR1).toFixed(2),\n        GEN_LOSS_Delta:parseFloat(GEN_LOSS_Delta).toFixed(2),\n        \n    }\n}\n   /* if (i == msg.payload.length) {\n        obj = {\n            DATE: \"null\" + '\\n' +\"TOTAL\",\"WR 1 (kWh)\": \"null\" + '\\n' + Total_ACT_WR1, \"Specific Yield (kWh / kWp)\": \"null\" + '\\n' + \"null\", \"WR 2 (kWh)\": \"null\" + '\\n' + Total_ACT_WR2, \"Specific Yield2 (kWh / kWp)\": \"null\" + '\\n' + \"null\", \"Total Yield Wh\": \"null\" + '\\n' + \"null\", \"average specific yield (kWh / kWp)\": \"null\" + '\\n' + \"null\", \"Max_sy\": \"null\", \"Expected_gen_WR1\": \"null\" + '\\n' + Total_exp_WR1.toFixed(2), \"Expected_gen_WR2\": \"null\" + '\\n' + Total_exp_WR2.toFixed(2), \"GEN_LOSS_WR1\": \"null\" + '\\n' + Total_gen_loss_WR1.toFixed(2), \"GEN_LOSS_WR2\": \"null\" + '\\n' + Total_gen_loss_WR2.toFixed(2)\n        }\n    }*/\n\n    array.push(obj)\n    \n}\nflow.set(\"out\", array);\nflow.set(\"totalgen_loss\",totalgen_loss)\nflow.set(\"total_act_gen\",total_act_gen)\nflow.set(\"total_exp_gen\", total_exp_gen)\n\nmsg.payload=array\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 990,
        "y": 580,
        "wires": [
            [
                "2a8770f75d3becb7"
            ]
        ]
    },
    {
        "id": "c4652687297e6228",
        "type": "csv",
        "z": "7c1a1b3ec858efce",
        "name": "",
        "sep": ",",
        "hdrin": true,
        "hdrout": "all",
        "multi": "mult",
        "ret": "\\n",
        "temp": "",
        "skip": "0",
        "strings": true,
        "include_empty_strings": "",
        "include_null_values": true,
        "x": 660,
        "y": 680,
        "wires": [
            [
                "90eac257b0068f04"
            ]
        ]
    },
    {
        "id": "bb540c40b66553ba",
        "type": "file",
        "z": "7c1a1b3ec858efce",
        "name": "TEST O/P",
        "filename": "filename",
        "filenameType": "msg",
        "appendNewline": true,
        "createDir": true,
        "overwriteFile": "false",
        "encoding": "none",
        "x": 960,
        "y": 680,
        "wires": [
            [
                "35db06fbae30e3b8"
            ]
        ]
    },
    {
        "id": "2a8770f75d3becb7",
        "type": "debug",
        "z": "7c1a1b3ec858efce",
        "name": "debug 6",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1170,
        "y": 580,
        "wires": []
    },
    {
        "id": "c6b408e58080b59b",
        "type": "comment",
        "z": "7c1a1b3ec858efce",
        "name": "header correction",
        "info": "",
        "x": 910,
        "y": 160,
        "wires": []
    },
    {
        "id": "5b445f04cb2ebb6f",
        "type": "debug",
        "z": "7c1a1b3ec858efce",
        "name": "debug 7",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1170,
        "y": 520,
        "wires": []
    },
    {
        "id": "2417f4ca45ea9633",
        "type": "function",
        "z": "7c1a1b3ec858efce",
        "name": "set header",
        "func": "var results = []\nvar filename = flow.get(\"filename\");\nconst plant = filename.substring(0, filename.indexOf('_'));\nvar column = msg.columns.split(',');\n var column_header=\"date\"\nfor (var i = 1; i < column.length; i++) {\n    var check = column[i].match(\"WR\")\n    var inv_re = column[i].substring(0, column[i].indexOf('('));\n    if (column[i].match(\"WR\")) {\n        var num = column[i].match(/\\d+/g).map(Number);\n        var sy = \",Specific Yield_\" + inv_re\n        var WR = \",\" + inv_re\n        column_header = column_header.concat(WR, sy);\n    }\n    if ((inv_re != \"average specific yield \") && (inv_re != \"Specific Yield \") && (inv_re != \"\") && (check == null)) {\n        var sy = \",Specific Yield_\" + inv_re\n        var WR = \",\" + inv_re\n        column_header = column_header.concat(WR, sy);\n    }\nvar obj={\n    num, \n    sy,\n    column_header\n}\nresults.push(obj)\n}\nmsg.payload=results\nflow.set(\"column\", column_header)\nflow.set(\"live_plant\", plant);\nmsg.columns=column_header\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 900,
        "y": 200,
        "wires": [
            [
                "2a2ab9bd17525c6e"
            ]
        ]
    },
    {
        "id": "6eeaf5d2e141a3ec",
        "type": "csv",
        "z": "7c1a1b3ec858efce",
        "name": "header",
        "sep": ";",
        "hdrin": true,
        "hdrout": "none",
        "multi": "mult",
        "ret": "\\n",
        "temp": "",
        "skip": "0",
        "strings": false,
        "include_empty_strings": false,
        "include_null_values": false,
        "x": 730,
        "y": 200,
        "wires": [
            [
                "2417f4ca45ea9633"
            ]
        ]
    },
    {
        "id": "52a43a47b14dbc9c",
        "type": "csv",
        "z": "7c1a1b3ec858efce",
        "name": "",
        "sep": ",",
        "hdrin": false,
        "hdrout": "all",
        "multi": "one",
        "ret": "\\n",
        "temp": "",
        "skip": "0",
        "strings": false,
        "include_empty_strings": false,
        "include_null_values": false,
        "x": 920,
        "y": 520,
        "wires": [
            [
                "8e0bcfa2192d09f9"
            ]
        ]
    },
    {
        "id": "8e0bcfa2192d09f9",
        "type": "csv",
        "z": "7c1a1b3ec858efce",
        "name": "",
        "sep": ",",
        "hdrin": true,
        "hdrout": "all",
        "multi": "mult",
        "ret": "\\n",
        "temp": "",
        "skip": "0",
        "strings": false,
        "include_empty_strings": false,
        "include_null_values": false,
        "x": 1040,
        "y": 520,
        "wires": [
            [
                "5b445f04cb2ebb6f",
                "779a01f132fca52b"
            ]
        ]
    },
    {
        "id": "0bb94a78a57f4430",
        "type": "delay",
        "z": "7c1a1b3ec858efce",
        "name": "",
        "pauseType": "delay",
        "timeout": "2",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 290,
        "y": 520,
        "wires": [
            [
                "067ec493605c2967"
            ]
        ]
    },
    {
        "id": "7b5ea1dfc019e8dd",
        "type": "comment",
        "z": "7c1a1b3ec858efce",
        "name": "calculation",
        "info": "",
        "x": 730,
        "y": 460,
        "wires": []
    },
    {
        "id": "35db06fbae30e3b8",
        "type": "debug",
        "z": "7c1a1b3ec858efce",
        "name": "debug 10",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1110,
        "y": 680,
        "wires": []
    },
    {
        "id": "7b0460dd157a000d",
        "type": "delay",
        "z": "7c1a1b3ec858efce",
        "name": "",
        "pauseType": "delay",
        "timeout": "4",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 290,
        "y": 680,
        "wires": [
            [
                "3cfa53df5ab5d558"
            ]
        ]
    },
    {
        "id": "832afbd3a4e26298",
        "type": "comment",
        "z": "7c1a1b3ec858efce",
        "name": "report generation 1st TABLE",
        "info": "",
        "x": 690,
        "y": 600,
        "wires": []
    },
    {
        "id": "2a2ab9bd17525c6e",
        "type": "debug",
        "z": "7c1a1b3ec858efce",
        "name": "debug 11",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1110,
        "y": 200,
        "wires": []
    },
    {
        "id": "3cfa53df5ab5d558",
        "type": "function",
        "z": "7c1a1b3ec858efce",
        "name": "eliminating null values",
        "func": "var array = flow.get(\"out\");\nvar result=[] \nvar final_out=[]\nvar column_header = \"DATE\"\nvar num;\nfor(var j = 0;j < array.length; j++ ){\n    result = []\n    const values = Object.values(array[j]);\n    const value_l = Object.values(array[0]).length;\n    const keys = Object.keys(array[0]);\n    for (let i = 0; i <value_l ; i++) {\n         if ((isNaN(values[i])&&(i!=0)))\n         {}\n         else{\n            result.push(values[i])\n            if(j==0){\n            var key=keys[i]\n            if(i!=0){\n            var column_header = column_header.concat(\",\",key); \n            }       \n            }   \n        }  \n    }\n    final_out.push(result)\n}\n\nmsg.payload=final_out\nmsg.columns = column_header\nreturn msg; ",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 490,
        "y": 680,
        "wires": [
            [
                "c4652687297e6228"
            ]
        ]
    },
    {
        "id": "474e21e7598e2303",
        "type": "csv",
        "z": "7c1a1b3ec858efce",
        "name": "value",
        "sep": ";",
        "hdrin": false,
        "hdrout": "none",
        "multi": "mult",
        "ret": "\\n",
        "temp": "",
        "skip": "1",
        "strings": false,
        "include_empty_strings": false,
        "include_null_values": false,
        "x": 720,
        "y": 240,
        "wires": [
            [
                "8c2c98fae3428b44"
            ]
        ]
    },
    {
        "id": "ec4357fde3995213",
        "type": "debug",
        "z": "7c1a1b3ec858efce",
        "name": "debug 13",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1090,
        "y": 240,
        "wires": []
    },
    {
        "id": "8c2c98fae3428b44",
        "type": "change",
        "z": "7c1a1b3ec858efce",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "flow",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 890,
        "y": 240,
        "wires": [
            [
                "ec4357fde3995213"
            ]
        ]
    },
    {
        "id": "13c65ab4617e272d",
        "type": "comment",
        "z": "7c1a1b3ec858efce",
        "name": "report generation 2nd TABLE",
        "info": "",
        "x": 690,
        "y": 760,
        "wires": []
    },
    {
        "id": "90eac257b0068f04",
        "type": "function",
        "z": "7c1a1b3ec858efce",
        "name": "filename",
        "func": "var plant=flow.get(\"live_plant\");\nvar month = flow.get(\"month\");\nvar currentTime = new Date();\nvar currentOffset = currentTime.getTimezoneOffset();\n\nvar ISTOffset = 330;   // IST offset UTC +5:30 \n\nvar today = new Date(currentTime.getTime() + (ISTOffset + currentOffset)*60000);\nvar dd = String(today.getDate()).padStart(2, '0');\nvar mm = String(today.getMonth() + 1).padStart(2, '0'); //January is 0!\nvar yyyy = today.getFullYear();\nvar today1 = dd + '_' + mm + '_' + yyyy;\n\nvar c =today1;\ncontext.set('c',c)\n\n\nmsg.filename = \"/home/iplon/Downloads/IGOP/Ezeeben_plants_\" + month + \"_report/\" + plant + \"_\" + month + \"_report.csv\"\n//msg.payload.filename=\"/ftp/solarlog/archive\"\n//msg.filename=\"Medak_\"+c+\".csv\"\n\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 790,
        "y": 680,
        "wires": [
            [
                "bb540c40b66553ba"
            ]
        ]
    },
    {
        "id": "0a33bc95fc5a853f",
        "type": "delay",
        "z": "7c1a1b3ec858efce",
        "name": "",
        "pauseType": "delay",
        "timeout": "6",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 290,
        "y": 800,
        "wires": [
            [
                "1c6f857e229d84cc"
            ]
        ]
    },
    {
        "id": "ed26dd38bd7acb67",
        "type": "csv",
        "z": "7c1a1b3ec858efce",
        "name": "",
        "sep": ",",
        "hdrin": true,
        "hdrout": "all",
        "multi": "mult",
        "ret": "\\n",
        "temp": "",
        "skip": "0",
        "strings": true,
        "include_empty_strings": "",
        "include_null_values": true,
        "x": 640,
        "y": 800,
        "wires": [
            [
                "299203aebe95fe4b"
            ]
        ]
    },
    {
        "id": "299203aebe95fe4b",
        "type": "function",
        "z": "7c1a1b3ec858efce",
        "name": "filename",
        "func": "var plant=flow.get(\"live_plant\");\nvar month = flow.get(\"month\");\nvar currentTime = new Date();\nvar currentOffset = currentTime.getTimezoneOffset();\n\nvar ISTOffset = 330;   // IST offset UTC +5:30 \n\nvar today = new Date(currentTime.getTime() + (ISTOffset + currentOffset)*60000);\nvar dd = String(today.getDate()).padStart(2, '0');\nvar mm = String(today.getMonth() + 1).padStart(2, '0'); //January is 0!\nvar yyyy = today.getFullYear();\nvar today1 = dd + '_' + mm + '_' + yyyy;\n\nvar c =today1;\ncontext.set('c',c)\n\n\nmsg.filename = \"/home/iplon/Downloads/IGOP/Ezeeben_plants_\" + month + \"_report/\" + plant + \"_\" + month + \"_report.csv\"\n//msg.payload.filename=\"/ftp/solarlog/archive\"\n//msg.filename=\"Medak_\"+c+\".csv\"\n\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 790,
        "y": 800,
        "wires": [
            [
                "6ccdbcd549e20237"
            ]
        ]
    },
    {
        "id": "6ccdbcd549e20237",
        "type": "file",
        "z": "7c1a1b3ec858efce",
        "name": "TEST O/P",
        "filename": "filename",
        "filenameType": "msg",
        "appendNewline": true,
        "createDir": true,
        "overwriteFile": "false",
        "encoding": "none",
        "x": 940,
        "y": 800,
        "wires": [
            [
                "7c91a2f489ef905f"
            ]
        ]
    },
    {
        "id": "7c91a2f489ef905f",
        "type": "debug",
        "z": "7c1a1b3ec858efce",
        "name": "debug 19",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1110,
        "y": 800,
        "wires": []
    },
    {
        "id": "29fcd5578a01d278",
        "type": "function",
        "z": "7c1a1b3ec858efce",
        "name": "plant info table",
        "func": "\nvar plant =flow.get(\"plant_info\")\nvar array = [\n    {   HEADER:\"PLANT_NAME\",\n        plant_info: plant[0].Plant_Name\n    },\n    {\n        HEADER: \"S.NO \" ,\n        plant_info: plant[0].S_NO,       \n    },\n    {\n        HEADER: \"No of Inverters \",\n        plant_info: plant[0].INV_NO\n    }\n];\nmsg.payload=array\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 450,
        "y": 400,
        "wires": [
            [
                "49f9413de20c6527"
            ]
        ]
    },
    {
        "id": "3d768cfe0c41218e",
        "type": "comment",
        "z": "7c1a1b3ec858efce",
        "name": "report generation plant info table",
        "info": "",
        "x": 740,
        "y": 340,
        "wires": []
    },
    {
        "id": "a380ebc014e1736d",
        "type": "debug",
        "z": "7c1a1b3ec858efce",
        "name": "debug 20",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1130,
        "y": 400,
        "wires": []
    },
    {
        "id": "d4c4a68928a4d323",
        "type": "delay",
        "z": "7c1a1b3ec858efce",
        "name": "",
        "pauseType": "delay",
        "timeout": "3",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 270,
        "y": 400,
        "wires": [
            [
                "29fcd5578a01d278"
            ]
        ]
    },
    {
        "id": "a4324ebda681c6d8",
        "type": "function",
        "z": "7c1a1b3ec858efce",
        "name": "filename",
        "func": "var plant=flow.get(\"live_plant\");\nvar month = flow.get(\"month\");\nvar currentTime = new Date();\nvar currentOffset = currentTime.getTimezoneOffset();\n\nvar ISTOffset = 330;   // IST offset UTC +5:30 \n\nvar today = new Date(currentTime.getTime() + (ISTOffset + currentOffset)*60000);\nvar dd = String(today.getDate()).padStart(2, '0');\nvar mm = String(today.getMonth() + 1).padStart(2, '0'); //January is 0!\nvar yyyy = today.getFullYear();\nvar today1 = dd + '_' + mm + '_' + yyyy;\n\nvar c =today1;\ncontext.set('c',c)\n\n\nmsg.filename = \"/home/iplon/Downloads/IGOP/Ezeeben_plants_\" + month + \"_report/\" + plant + \"_\" + month + \"_report.csv\"\n//msg.payload.filename=\"/ftp/solarlog/archive\"\n//msg.filename=\"Medak_\"+c+\".csv\"\n\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 750,
        "y": 400,
        "wires": [
            [
                "5d58b0a018d846b0"
            ]
        ]
    },
    {
        "id": "5d58b0a018d846b0",
        "type": "file",
        "z": "7c1a1b3ec858efce",
        "name": "TEST O/P",
        "filename": "filename",
        "filenameType": "msg",
        "appendNewline": true,
        "createDir": true,
        "overwriteFile": "true",
        "encoding": "none",
        "x": 960,
        "y": 400,
        "wires": [
            [
                "a380ebc014e1736d"
            ]
        ]
    },
    {
        "id": "49f9413de20c6527",
        "type": "csv",
        "z": "7c1a1b3ec858efce",
        "name": "",
        "sep": ",",
        "hdrin": true,
        "hdrout": "none",
        "multi": "mult",
        "ret": "\\n",
        "temp": "",
        "skip": "0",
        "strings": true,
        "include_empty_strings": true,
        "include_null_values": true,
        "x": 600,
        "y": 400,
        "wires": [
            [
                "a4324ebda681c6d8"
            ]
        ]
    },
    {
        "id": "ec3942fc0db54eab",
        "type": "function",
        "z": "7c1a1b3ec858efce",
        "name": "seperator replace",
        "func": "\nlet text=msg.payload\nlet check = text.includes(\";\")\nif(check==false)\n{\n    var result = text.replaceAll(\",\", \";\");\n}\nelse{result=text}\n\nmsg.payload = result\nreturn (msg);",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 500,
        "y": 200,
        "wires": [
            [
                "6eeaf5d2e141a3ec",
                "474e21e7598e2303"
            ]
        ]
    },
    {
        "id": "b551510deea9e470",
        "type": "debug",
        "z": "7c1a1b3ec858efce",
        "name": "debug 183",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 920,
        "y": 460,
        "wires": []
    },
    {
        "id": "1c6f857e229d84cc",
        "type": "function",
        "z": "7c1a1b3ec858efce",
        "name": "setup 2nd Table",
        "func": "\n\nvar totalgen_loss =flow.get(\"totalgen_loss\")\nvar total_act_gen=flow.get(\"total_act_gen\")\nvar total_exp_gen=flow.get(\"total_exp_gen\")\nvar INV_CAPACITY = flow.get(\"INV_CAPACITY\")\nvar inverter = flow.get(\"inv_array\")\nvar result\n\nvar array=[]\nvar loss=[]\n\nconst values = Object.values(total_act_gen[0])\nconst keys = Object.keys(total_act_gen[0]);\n\nfunction calculateSum(arr) {\n    var sum = 0;\n\n    for (var i = 0; i < arr.length; i++) {\n        if (typeof arr[i] === 'number' && !isNaN(arr[i])) {\n            sum += arr[i];\n        }\n    }\n    return sum;\n}\n\nvar plant_CAPACITY = calculateSum(INV_CAPACITY)\nvar Total_Actual_Generation_in_kWh = calculateSum(values)\nvar Total_Expected_Generation_in_kWh =calculateSum(total_exp_gen)\nvar Total_Generation_Loss_in_kWh = calculateSum(totalgen_loss)\n\nfor (var i = 0; i <= totalgen_loss.length; i++)\n{\n\n    if(i == totalgen_loss.length) {\n\n        var Total_Loss_in_currency_Euro = calculateSum(loss)\n\n        var obj = {\n            INVERTERS: \"TOTAL\",\n            Capacity_in_kWp: plant_CAPACITY.toFixed(2),\n            Actual_Generation_in_kWh: Total_Actual_Generation_in_kWh.toFixed(2),\n            Expected_Generation_in_kWh: Total_Expected_Generation_in_kWh.toFixed(2),\n            Generation_Loss_in_kWh: Total_Generation_Loss_in_kWh.toFixed(2),\n            Loss_in_currency_Euro_: Total_Loss_in_currency_Euro.toFixed(2),\n            \n        }\n        array.push(obj)\n    }\n    if (isNaN(totalgen_loss[i])) {}\n\n    else {\n        \n        const prefix = \"Total_ACT_\";\n        const inv_name = keys[i].replace(prefix, \"\");\n\n        if (plant_CAPACITY >=50)\n    {\n        var LOSS_IN_CURRENCY=totalgen_loss[i]*0.075\n    }\n        if (plant_CAPACITY < 50) {\n        var LOSS_IN_CURRENCY = totalgen_loss[i] * 0.10\n    }\n       loss.push(LOSS_IN_CURRENCY)\n obj={\n    INVERTERS:inv_name,\n     Capacity_in_kWp: INV_CAPACITY[i].toFixed(2),\n     Actual_Generation_in_kWh: values[i].toFixed(2),\n     Expected_Generation_in_kWh: total_exp_gen[i].toFixed(2),\n     Generation_Loss_in_kWh: totalgen_loss[i].toFixed(2),\n     Loss_in_currency_Euro_: LOSS_IN_CURRENCY.toFixed(2)\n  \n}   \narray.push(obj)\n}\n}\nmsg.payload=array\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 450,
        "y": 800,
        "wires": [
            [
                "ed26dd38bd7acb67"
            ]
        ]
    },
    {
        "id": "d0f41aaa9a5e8176",
        "type": "fs-ops-dir",
        "z": "7c1a1b3ec858efce",
        "name": "",
        "path": "/home/iplon/Downloads/IGOP/Ezeeben  may month csv file",
        "pathType": "str",
        "filter": "*",
        "filterType": "str",
        "dir": "payload",
        "dirType": "msg",
        "x": 410,
        "y": 60,
        "wires": [
            [
                "f8a7c9d60bee905b"
            ]
        ]
    },
    {
        "id": "c77f15e2cf556f3b",
        "type": "comment",
        "z": "226efa8990661b8c",
        "name": "data scraping of kongu",
        "info": "",
        "x": 160,
        "y": 280,
        "wires": []
    },
    {
        "id": "ad5c238089a81e15",
        "type": "html",
        "z": "226efa8990661b8c",
        "name": "",
        "property": "payload",
        "outproperty": "payload",
        "tag": "body > div > form > div",
        "ret": "text",
        "as": "single",
        "x": 940,
        "y": 280,
        "wires": [
            [
                "4dcb1181cef356a7"
            ]
        ]
    },
    {
        "id": "4dcb1181cef356a7",
        "type": "split",
        "z": "226efa8990661b8c",
        "name": "",
        "splt": "/n",
        "spltType": "str",
        "arraySplt": "1",
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 1110,
        "y": 280,
        "wires": [
            [
                "553769484e889256",
                "ad2bdf9eea1229e9"
            ]
        ]
    },
    {
        "id": "6693856d766c61f2",
        "type": "function",
        "z": "226efa8990661b8c",
        "name": "function 117",
        "func": "// Assuming msg.payload contains the input string\nvar lines = msg.payload.split('\\n');\nvar data = [];\nvar company = '';\nvar contactPerson = '';\nvar address = '';\nvar contactNumber = '';\nvar email = '';\n\nlines.forEach(function (line) {\n    var lineContent = line.trim();\n    if (lineContent !== '') {\n        if (lineContent.startsWith(\"A Blues Clothing\")) {\n            company = lineContent;\n        } else if (lineContent.startsWith(\"Shri.\")) {\n            contactPerson = lineContent;\n        } else if (lineContent.startsWith(\"Address:\")) {\n            address = lineContent.replace('Address:', '').trim();\n        } else if (lineContent.startsWith(\"Contact Number:\")) {\n            contactNumber = lineContent.replace('Contact Number:', '').trim();\n        } else if (lineContent.startsWith(\"Email:\")) {\n            email = lineContent.replace('Email:', '').trim();\n        }\n    } else {\n        if (company !== '') {\n            var obj = {\n                Company: company,\n                ContactPerson: contactPerson,\n                Address: address,\n                ContactNumber: contactNumber,\n                Email: email\n            };\n            data.push(obj);\n\n            // Reset fields for the next entry\n            company = '';\n            contactPerson = '';\n            address = '';\n            contactNumber = '';\n            email = '';\n        }\n    }\n});\n\n// Push the last entry if exists\nif (company !== '') {\n    var obj = {\n        Company: company,\n        ContactPerson: contactPerson,\n        Address: address,\n        ContactNumber: contactNumber,\n        Email: email\n    };\n    data.push(obj);\n}\n\nmsg.payload = data;\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 230,
        "y": 480,
        "wires": [
            []
        ]
    },
    {
        "id": "2487eff39778da56",
        "type": "debug",
        "z": "226efa8990661b8c",
        "name": "debug 198",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1050,
        "y": 520,
        "wires": []
    },
    {
        "id": "823774c2c9fbdd91",
        "type": "function",
        "z": "226efa8990661b8c",
        "name": "Meter API's",
        "func": "// Initialize the array of URLs outside the loop\nvar urls = [];\n\nfor (var i = 1; i <= 5; i++) {\n    // Construct the URL and push it to the array\n    urls.push(\"https://pin-code.org.in/companies/sector/textiles/tamil-nadu/coimbatore/page:\" + i);\n}\n\n// Set the array of URLs as a property of the message\nmsg.payload = urls;\n\n// Return the modified message after the loop\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 290,
        "y": 340,
        "wires": [
            [
                "0555a163635b27af"
            ]
        ]
    },
    {
        "id": "7ded2d4bb08e01a1",
        "type": "inject",
        "z": "226efa8990661b8c",
        "name": "",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 540,
        "y": 280,
        "wires": [
            [
                "3ca16ddc0b568b76"
            ]
        ]
    },
    {
        "id": "3ca16ddc0b568b76",
        "type": "http request",
        "z": "226efa8990661b8c",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://tea-india.org/ercmembers/index1.php",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 730,
        "y": 280,
        "wires": [
            [
                "ad5c238089a81e15"
            ]
        ]
    },
    {
        "id": "0555a163635b27af",
        "type": "split",
        "z": "226efa8990661b8c",
        "name": "",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 430,
        "y": 340,
        "wires": [
            [
                "b4ac17510f9ce4c8"
            ]
        ]
    },
    {
        "id": "b4ac17510f9ce4c8",
        "type": "change",
        "z": "226efa8990661b8c",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "url",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 570,
        "y": 340,
        "wires": [
            []
        ]
    },
    {
        "id": "12f40e31a5a2e712",
        "type": "excel",
        "z": "226efa8990661b8c",
        "name": "",
        "file": "/home/iplon/Music/textile_companies_cbe.xlsx",
        "x": 1050,
        "y": 460,
        "wires": [
            [
                "2487eff39778da56"
            ]
        ]
    },
    {
        "id": "32b0cfaae220879a",
        "type": "function",
        "z": "226efa8990661b8c",
        "name": "function 119",
        "func": "// Combine the individual arrays from the join node\nvar combinedArray = msg.payload.reduce(function (result, currentArray) {\n    return result.concat(currentArray);\n}, []);\n\nmsg.payload = combinedArray;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 870,
        "y": 460,
        "wires": [
            [
                "12f40e31a5a2e712"
            ]
        ]
    },
    {
        "id": "aab788ddabc8f8f4",
        "type": "join",
        "z": "226efa8990661b8c",
        "name": "",
        "mode": "custom",
        "build": "array",
        "property": "payload",
        "propertyType": "msg",
        "key": "",
        "joiner": "\\n",
        "joinerType": "str",
        "accumulate": false,
        "timeout": "",
        "count": "5",
        "reduceRight": false,
        "reduceExp": "",
        "reduceInit": "",
        "reduceInitType": "",
        "reduceFixup": "",
        "x": 730,
        "y": 460,
        "wires": [
            [
                "32b0cfaae220879a"
            ]
        ]
    },
    {
        "id": "f0296b70d7797908",
        "type": "debug",
        "z": "226efa8990661b8c",
        "name": "debug 199",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1230,
        "y": 340,
        "wires": []
    },
    {
        "id": "1ff77bfb7d35646f",
        "type": "split",
        "z": "226efa8990661b8c",
        "name": "",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 930,
        "y": 180,
        "wires": [
            []
        ]
    },
    {
        "id": "ca48e62d8dac3780",
        "type": "inject",
        "z": "226efa8990661b8c",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 240,
        "y": 960,
        "wires": [
            [
                "49c7d3dec16ff1e5"
            ]
        ]
    },
    {
        "id": "49c7d3dec16ff1e5",
        "type": "http request",
        "z": "226efa8990661b8c",
        "name": "",
        "method": "GET",
        "ret": "bin",
        "paytoqs": "ignore",
        "url": "https://mein-senec.de/installateur/vaadinServlet/PUSH?v-uiId=1&v-pushId=32a9345d-e3b3-4836-bbb7-2b5a46c5c682&X-Atmosphere-tracking-id=c2c5d925-29e6-4e33-b247-6a01d8616e63&X-Atmosphere-Framework=2.3.2.vaadin2-javascript&X-Atmosphere-Transport=long-polling&X-Atmosphere-TrackMessageSize=true&Content-Type=application%2Fjson%3B%20charset%3DUTF-8&X-atmo-protocol=true&X-Vaadin-LastSeenServerSyncId=28&_=1692337128350",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "basic",
        "senderr": false,
        "headers": [
            {
                "keyType": "Accept",
                "keyValue": "",
                "valueType": "other",
                "valueValue": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/web"
            },
            {
                "keyType": "Accept-Encoding",
                "keyValue": "",
                "valueType": "other",
                "valueValue": "gzip, deflate, br"
            },
            {
                "keyType": "Accept-Language",
                "keyValue": "",
                "valueType": "other",
                "valueValue": "en-GB,en-US;q=0.9,en;q=0.8,ta;q=0.7"
            },
            {
                "keyType": "User-Agent",
                "keyValue": "",
                "valueType": "other",
                "valueValue": "Chrome/116.0.0.0 Safari/537.36"
            }
        ],
        "x": 430,
        "y": 960,
        "wires": [
            [
                "aee8951e819b503a"
            ]
        ]
    },
    {
        "id": "af6ad40c2b976cb8",
        "type": "debug",
        "z": "226efa8990661b8c",
        "name": "debug 199",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1150,
        "y": 960,
        "wires": []
    },
    {
        "id": "223e10e332cb0635",
        "type": "file",
        "z": "226efa8990661b8c",
        "name": "",
        "filename": "/home/iplon/Music/export.pdf",
        "filenameType": "str",
        "appendNewline": false,
        "createDir": false,
        "overwriteFile": "true",
        "encoding": "binary",
        "x": 880,
        "y": 960,
        "wires": [
            [
                "af6ad40c2b976cb8"
            ]
        ]
    },
    {
        "id": "833d43d6ae3194da",
        "type": "function",
        "z": "226efa8990661b8c",
        "name": "function 121",
        "func": "// Convert binary data to Base64\nvar binaryData = msg.payload;\nvar base64Data = Buffer.from(binaryData).toString('base64');\n\n// Set the Base64 data as the output payload\nmsg.payload = base64Data;\n\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 650,
        "y": 960,
        "wires": [
            [
                "223e10e332cb0635"
            ]
        ]
    },
    {
        "id": "3acd999d76d2d77d",
        "type": "inject",
        "z": "226efa8990661b8c",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 280,
        "y": 720,
        "wires": [
            [
                "3b8a7be83d33a20a"
            ]
        ]
    },
    {
        "id": "3b8a7be83d33a20a",
        "type": "http request",
        "z": "226efa8990661b8c",
        "name": "URL",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://www.foxesscloud.com/c/v0/errors/message",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "basic",
        "senderr": false,
        "headers": [],
        "x": 430,
        "y": 720,
        "wires": [
            [
                "b1d91f97d7e8af5d"
            ]
        ]
    },
    {
        "id": "5ed40c58388dfa9f",
        "type": "html",
        "z": "226efa8990661b8c",
        "name": "",
        "property": "payload",
        "outproperty": "payload",
        "tag": "div.v-slot.v-slot-meinsenec-table.v-slot-meinsenec-table-wda",
        "ret": "text",
        "as": "single",
        "x": 760,
        "y": 720,
        "wires": [
            []
        ]
    },
    {
        "id": "b1d91f97d7e8af5d",
        "type": "debug",
        "z": "226efa8990661b8c",
        "name": "debug 201",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 750,
        "y": 640,
        "wires": []
    },
    {
        "id": "aee8951e819b503a",
        "type": "debug",
        "z": "226efa8990661b8c",
        "name": "debug 202",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 550,
        "y": 1120,
        "wires": []
    },
    {
        "id": "a8a3e5adff2c4980",
        "type": "comment",
        "z": "226efa8990661b8c",
        "name": "Foxess",
        "info": "",
        "x": 130,
        "y": 660,
        "wires": []
    },
    {
        "id": "5c79e3203f4e1e5b",
        "type": "comment",
        "z": "226efa8990661b8c",
        "name": "senec",
        "info": "",
        "x": 130,
        "y": 860,
        "wires": []
    },
    {
        "id": "ae4dd80e3f9ea70f",
        "type": "inject",
        "z": "226efa8990661b8c",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 280,
        "y": 800,
        "wires": [
            [
                "ec1a0b1769ce59e7"
            ]
        ]
    },
    {
        "id": "ec1a0b1769ce59e7",
        "type": "http request",
        "z": "226efa8990661b8c",
        "name": "URL",
        "method": "POST",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://www.foxesscloud.com/c/v0/plant/history/raw",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": true,
        "authType": "bearer",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Accept",
                "valueType": "other",
                "valueValue": "application/json, text/plain, */*"
            },
            {
                "keyType": "other",
                "keyValue": "Accept-Encoding",
                "valueType": "other",
                "valueValue": "gzip, deflate, br"
            },
            {
                "keyType": "other",
                "keyValue": "Accept-Language",
                "valueType": "other",
                "valueValue": "en-GB,en-US;q=0.9,en;q=0.8"
            },
            {
                "keyType": "other",
                "keyValue": "User-Agent",
                "valueType": "other",
                "valueValue": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36"
            }
        ],
        "x": 430,
        "y": 800,
        "wires": [
            [
                "06ba950d581f758a"
            ]
        ]
    },
    {
        "id": "c71d0c368cfc4e40",
        "type": "html",
        "z": "226efa8990661b8c",
        "name": "",
        "property": "payload",
        "outproperty": "payload",
        "tag": "div.v-slot.v-slot-meinsenec-table.v-slot-meinsenec-table-wda",
        "ret": "text",
        "as": "single",
        "x": 760,
        "y": 800,
        "wires": [
            []
        ]
    },
    {
        "id": "06ba950d581f758a",
        "type": "debug",
        "z": "226efa8990661b8c",
        "name": "debug 203",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 610,
        "y": 860,
        "wires": []
    },
    {
        "id": "c07f0710.91bf68",
        "type": "http request",
        "z": "226efa8990661b8c",
        "name": "Login Request",
        "method": "POST",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "https://www.foxesscloud.com/login",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "basic",
        "senderr": false,
        "headers": [],
        "x": 240,
        "y": 1200,
        "wires": [
            [
                "6f1a7688.f55f18",
                "283f02cbfd4e9cf9"
            ]
        ]
    },
    {
        "id": "6f1a7688.f55f18",
        "type": "function",
        "z": "226efa8990661b8c",
        "name": "Extract Token",
        "func": "var response = msg.payload;\nvar authToken = response.authToken; // Adjust this based on actual response structure\n\nif (authToken) {\n    return { authToken: authToken };\n} else {\n    return null; // Handle authentication error\n}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 460,
        "y": 1200,
        "wires": [
            [
                "abafcc89.d43d6"
            ]
        ]
    },
    {
        "id": "abafcc89.d43d6",
        "type": "http request",
        "z": "226efa8990661b8c",
        "name": "Scraping Request",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://www.foxesscloud.com/bus/dataView",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "bearer",
        "senderr": false,
        "headers": [],
        "x": 280,
        "y": 1340,
        "wires": [
            [
                "8188b89e.696b68"
            ]
        ]
    },
    {
        "id": "8188b89e.696b68",
        "type": "function",
        "z": "226efa8990661b8c",
        "name": "Parse HTML",
        "func": "var cheerio = require('cheerio');\nvar $ = cheerio.load(msg.payload);\n\nvar extractedData = [];\n\n// Use Cheerio selectors to extract data\n$('selector').each(function(index, element) {\n    var item = $(element).text();\n    extractedData.push(item);\n});\n\nreturn { extractedData: extractedData };",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 460,
        "y": 1340,
        "wires": [
            [
                "e6ec3d1c.7cb6b8"
            ]
        ]
    },
    {
        "id": "e6ec3d1c.7cb6b8",
        "type": "debug",
        "z": "226efa8990661b8c",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 660,
        "y": 1340,
        "wires": []
    },
    {
        "id": "1d49355ab5896473",
        "type": "inject",
        "z": "226efa8990661b8c",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 100,
        "y": 1140,
        "wires": [
            [
                "c07f0710.91bf68"
            ]
        ]
    },
    {
        "id": "283f02cbfd4e9cf9",
        "type": "debug",
        "z": "226efa8990661b8c",
        "name": "debug 204",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 350,
        "y": 1080,
        "wires": []
    },
    {
        "id": "4e7cf023a5549adb",
        "type": "fs-ops-dir",
        "z": "226efa8990661b8c",
        "name": "",
        "path": "/home/iplon/Videos/iGOP plus/senec_ezee/S28836531194348556540356920-week-34-2023.csv",
        "pathType": "str",
        "filter": "*",
        "filterType": "str",
        "dir": "files",
        "dirType": "msg",
        "x": 620,
        "y": 1420,
        "wires": [
            []
        ]
    },
    {
        "id": "88f7bfc4e6184a58",
        "type": "function",
        "z": "226efa8990661b8c",
        "name": "function 122",
        "func": "const input = msg.payload;\n\n// Split by semicolon\nconst semicolonSplit = input.split(';');\n\n// Extract the first item as headers (assuming it contains field names)\nconst headers = semicolonSplit[0].split(',');\n\n// Initialize an object to hold the final results\nconst results = {};\n\n// Loop through the headers and semicolon-split array\nfor (let i = 0; i < headers.length; i++) {\n    const field = headers[i];\n    const values = semicolonSplit.slice(1).map(item => item.split(',')[i]);\n\n    results[field] = values.map(value => parseFloat(value));\n}\n\nconsole.log(results);\n\nreturn { payload: results };\n\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 410,
        "y": 1480,
        "wires": [
            []
        ]
    },
    {
        "id": "3d867451036e3679",
        "type": "comment",
        "z": "226efa8990661b8c",
        "name": "data scraping - Test FoxESS",
        "info": "",
        "x": 240,
        "y": 1620,
        "wires": []
    },
    {
        "id": "56232bd0d88f1115",
        "type": "html",
        "z": "226efa8990661b8c",
        "name": "",
        "property": "payload",
        "outproperty": "payload",
        "tag": "div.row.addressWrap.mt-2",
        "ret": "text",
        "as": "single",
        "x": 1010,
        "y": 1680,
        "wires": [
            [
                "b1cc8fcd3265bc3a"
            ]
        ]
    },
    {
        "id": "b1cc8fcd3265bc3a",
        "type": "split",
        "z": "226efa8990661b8c",
        "name": "",
        "splt": "/n",
        "spltType": "str",
        "arraySplt": "1",
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 1190,
        "y": 1680,
        "wires": [
            [
                "55775702256960be"
            ]
        ]
    },
    {
        "id": "55775702256960be",
        "type": "function",
        "z": "226efa8990661b8c",
        "name": "function 117",
        "func": "// Assuming msg.payload contains a single line of text\nvar lines = msg.payload.split('\\n');\nvar data = [];\n\nvar company = '';\nvar address = '';\n\nlines.forEach(function (line) {\n    if (line.trim() === '') {\n        if (company !== '' && address !== '') {\n            var obj = {\n                Company: company,\n                Address: address\n            };\n            data.push(obj);\n\n            // Reset company and address for the next entry\n            company = '';\n            address = '';\n        }\n    } else if (line.includes('Contact Address:')) {\n        address = line.replace('Contact Address:', '').trim();\n    } else {\n        company = line.trim();\n    }\n});\n\n// Push the last entry if exists\nif (company !== '' && address !== '') {\n    var obj = {\n        Company: company,\n        Address: address\n    };\n    data.push(obj);\n}\nmsg.payload = data;\nreturn msg;\n\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1330,
        "y": 1680,
        "wires": [
            [
                "5efae6c0d65f598c"
            ]
        ]
    },
    {
        "id": "c81f1f772b17e5a2",
        "type": "function",
        "z": "226efa8990661b8c",
        "name": "Meter API's",
        "func": "// Initialize the array of URLs outside the loop\nvar urls = [];\n\nfor (var i = 1; i <= 5; i++) {\n    // Construct the URL and push it to the array\n    urls.push(\"https://pin-code.org.in/companies/sector/textiles/tamil-nadu/coimbatore/page:\" + i);\n}\n\n// Set the array of URLs as a property of the message\nmsg.payload = urls;\n\n// Return the modified message after the loop\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 350,
        "y": 1680,
        "wires": [
            [
                "77436d8f175ec464"
            ]
        ]
    },
    {
        "id": "328b6d449c7f2034",
        "type": "inject",
        "z": "226efa8990661b8c",
        "name": "",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 200,
        "y": 1680,
        "wires": [
            [
                "c81f1f772b17e5a2"
            ]
        ]
    },
    {
        "id": "090743b25d5f08ea",
        "type": "http request",
        "z": "226efa8990661b8c",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 790,
        "y": 1680,
        "wires": [
            [
                "56232bd0d88f1115"
            ]
        ]
    },
    {
        "id": "77436d8f175ec464",
        "type": "split",
        "z": "226efa8990661b8c",
        "name": "",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 490,
        "y": 1680,
        "wires": [
            [
                "83a95089f9534288"
            ]
        ]
    },
    {
        "id": "83a95089f9534288",
        "type": "change",
        "z": "226efa8990661b8c",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "url",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 630,
        "y": 1680,
        "wires": [
            [
                "090743b25d5f08ea"
            ]
        ]
    },
    {
        "id": "b42bd60be8b0ca65",
        "type": "function",
        "z": "226efa8990661b8c",
        "name": "function 119",
        "func": "// Combine the individual arrays from the join node\nvar combinedArray = msg.payload.reduce(function (result, currentArray) {\n    return result.concat(currentArray);\n}, []);\n\nmsg.payload = combinedArray;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1610,
        "y": 1680,
        "wires": [
            [
                "4e38ef36e1e99963"
            ]
        ]
    },
    {
        "id": "5efae6c0d65f598c",
        "type": "join",
        "z": "226efa8990661b8c",
        "name": "",
        "mode": "custom",
        "build": "array",
        "property": "payload",
        "propertyType": "msg",
        "key": "",
        "joiner": "\\n",
        "joinerType": "str",
        "accumulate": false,
        "timeout": "",
        "count": "5",
        "reduceRight": false,
        "reduceExp": "",
        "reduceInit": "",
        "reduceInitType": "",
        "reduceFixup": "",
        "x": 1470,
        "y": 1680,
        "wires": [
            [
                "b42bd60be8b0ca65"
            ]
        ]
    },
    {
        "id": "4e38ef36e1e99963",
        "type": "debug",
        "z": "226efa8990661b8c",
        "name": "debug 199",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1770,
        "y": 1680,
        "wires": []
    },
    {
        "id": "5aaae10f593b5219",
        "type": "inject",
        "z": "226efa8990661b8c",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 220,
        "y": 1780,
        "wires": [
            [
                "aea465869c888caf"
            ]
        ]
    },
    {
        "id": "aea465869c888caf",
        "type": "http request",
        "z": "226efa8990661b8c",
        "name": "URL",
        "method": "GET",
        "ret": "bin",
        "paytoqs": "ignore",
        "url": "https://www.foxesscloud.com/bus/dataReport",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 350,
        "y": 1780,
        "wires": [
            [
                "b7e516f66d81e5a4",
                "b18ec4fcbaef6605"
            ]
        ]
    },
    {
        "id": "b7e516f66d81e5a4",
        "type": "html",
        "z": "226efa8990661b8c",
        "name": "selector",
        "property": "payload",
        "outproperty": "payload",
        "tag": "#pane-bus-dataReport > div > div.tab-scrollbar-wrapper.el-scrollbar__wrap > div > div > section > div.sys-table-container > div.function-container > div:nth-child(2) > div",
        "ret": "text",
        "as": "single",
        "x": 500,
        "y": 1780,
        "wires": [
            [
                "4538a126371f6dba"
            ]
        ]
    },
    {
        "id": "a3a86ecb65e41cc5",
        "type": "debug",
        "z": "226efa8990661b8c",
        "name": "debug 197",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1150,
        "y": 1860,
        "wires": []
    },
    {
        "id": "61d1f376d1416c10",
        "type": "split",
        "z": "226efa8990661b8c",
        "name": "",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": "1",
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 790,
        "y": 1780,
        "wires": [
            [
                "903be44b33885637"
            ]
        ]
    },
    {
        "id": "903be44b33885637",
        "type": "function",
        "z": "226efa8990661b8c",
        "name": "function 117",
        "func": "// Assuming msg.payload contains a single line of text\nvar lines = msg.payload.split('\\n');\nvar data = [];\n\nvar company = '';\nvar address = '';\n\nlines.forEach(function (line) {\n    if (line.trim() === '') {\n        if (company !== '' && address !== '') {\n            var obj = {\n                Company: company,\n                Address: address\n            };\n            data.push(obj);\n\n            // Reset company and address for the next entry\n            company = '';\n            address = '';\n        }\n    } else if (line.includes('Contact Address:')) {\n        address = line.replace('Contact Address:', '').trim();\n    } else {\n        company = line.trim();\n    }\n});\n\n// Push the last entry if exists\nif (company !== '' && address !== '') {\n    var obj = {\n        Company: company,\n        Address: address\n    };\n    data.push(obj);\n}\n\nmsg.payload = data;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 950,
        "y": 1780,
        "wires": [
            [
                "a3a86ecb65e41cc5"
            ]
        ]
    },
    {
        "id": "b18ec4fcbaef6605",
        "type": "debug",
        "z": "226efa8990661b8c",
        "name": "debug 198",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 330,
        "y": 1900,
        "wires": []
    },
    {
        "id": "4538a126371f6dba",
        "type": "debug",
        "z": "226efa8990661b8c",
        "name": "debug 200",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 570,
        "y": 1880,
        "wires": []
    },
    {
        "id": "da988bec587eaba0",
        "type": "csv",
        "z": "226efa8990661b8c",
        "name": "",
        "sep": ",",
        "hdrin": true,
        "hdrout": "none",
        "multi": "mult",
        "ret": "\\n",
        "temp": "",
        "skip": "0",
        "strings": true,
        "include_empty_strings": true,
        "include_null_values": true,
        "x": 570,
        "y": 1820,
        "wires": [
            []
        ]
    },
    {
        "id": "7c9901c373bc7ef1",
        "type": "inject",
        "z": "226efa8990661b8c",
        "name": "",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 200,
        "y": 2220,
        "wires": [
            [
                "96d76caac6274d31"
            ]
        ]
    },
    {
        "id": "6576f3bbff508d5c",
        "type": "http request",
        "z": "226efa8990661b8c",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://mein-senec.de/installateur/vaadinServlet/APP/connector/0/527/dl",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 450,
        "y": 2080,
        "wires": [
            [
                "11bc867c2c900ac8"
            ]
        ]
    },
    {
        "id": "ac2346b8ad40b6ff",
        "type": "csv",
        "z": "226efa8990661b8c",
        "name": "",
        "sep": ",",
        "hdrin": true,
        "hdrout": "none",
        "multi": "mult",
        "ret": "\\n",
        "temp": "",
        "skip": "0",
        "strings": true,
        "include_empty_strings": "",
        "include_null_values": true,
        "x": 610,
        "y": 2080,
        "wires": [
            []
        ]
    },
    {
        "id": "700c363498e374ee",
        "type": "function",
        "z": "226efa8990661b8c",
        "name": "Influx 2.0",
        "func": "for (var i = 0; i < msg.payload.length; i++) {\n    var customTimestamp = msg.payload[i].timestamp; // Example: \"2023-08-18 00:02:26 CEST+0200\"\n\n    // Extract the date and time portion\n    var dateAndTime = customTimestamp.split(' ')[0]; // \"2023-08-18\"\n    var time = customTimestamp.split(' ')[1]; // \"00:02:26\"\n\n    // Construct a date string in ISO format (YYYY-MM-DDTHH:mm:ss)\n    var isoTimestamp = dateAndTime + 'T' + time;\n\n    // Parse the ISO timestamp into a JavaScript Date object\n    var dateUTC = new Date(isoTimestamp).getTime();\n\n    var sn = msg.payload[i].sn\n\n    var fields = [\n        { field: \"value\", value: msg.payload[i].eae, d: \"INV01\", dd: \"Inverter\",f: \"EAE\", fd: \"EAE\", u: \"kwh\" },\n        { field: \"value\", value: msg.payload[i].eae_day, d: \"INV01\", dd: \"Inverter\", f: \"EAE_DAY\", fd: \"EAE_DAY\", u: \"kwh\" },\n        { field: \"value\", value: msg.payload[i].pac, d: \"INV01\", dd: \"Inverter\",f: \"PAC\", fd: \"PAC\", u: \"kw\" },\n        { field: \"value\", value: msg.payload[i].fac, d: \"INV01\", dd: \"Inverter\",f: \"FAC\", fd: \"FAC\", u: \"Hz\" },\n        { field: \"value\", value: msg.payload[i].eai, d: \"INV01\", dd: \"Inverter\",f: \"EAI\", fd: \"EAI\", u: \"kwh\" },\n        { field: \"value\", value: msg.payload[i].em_pac1, d: \"EM01\", dd: \"Meter\", f: \"PAC1\", fd: \"PAC1\", u: \"kw\" },\n        { field: \"value\", value: msg.payload[i].em_pac2, d: \"EM01\", dd: \"Meter\", f: \"PAC2\", fd: \"PAC2\", u: \"kw\" },\n        { field: \"value\", value: msg.payload[i].em_pac3, d: \"EM01\", dd: \"Meter\", f: \"PAC3\", fd: \"PAC3\", u: \"kw\" },\n        { field: \"value\", value: msg.payload[i].load_pac1, d: \"LOAD\", dd: \"load\", f: \"PAC1\", fd: \"PAC1\", u: \"kw\" },\n        { field: \"value\", value: msg.payload[i].load_pac2, d: \"LOAD\", dd: \"load\", f: \"PAC2\", fd: \"PAC2\", u: \"kw\" },\n        { field: \"value\", value: msg.payload[i].load_pac3, d: \"LOAD\", dd: \"load\", f: \"PAC3\", fd: \"PAC3\", u: \"kw\" },\n        { field: \"value\", value: msg.payload[i].grid_pac1, d: \"GRID\", dd: \"grid\", f: \"PAC1\", fd: \"PAC1\", u: \"kw\" },\n        { field: \"value\", value: msg.payload[i].grid_pac2, d: \"GRID\", dd: \"grid\", f: \"PAC2\", fd: \"PAC2\", u: \"kw\" },\n        { field: \"value\", value: msg.payload[i].soc, d: \"BATTERY\", dd: \"battery\", f: \"SOC\", fd: \"SOC\", u: \"%\" },\n    ];\n\n    for (var j = 0; j < fields.length; j++) {\n        var fieldInfo = fields[j];\n\n        var obj = {\n            measurement: \"v\",\n            fields: {\n                value: fieldInfo.value,\n                text: \"0\",\n                qu: \"0\"\n            },\n            tags: {\n                b: \"B01\",\n                bd: \"B01\",\n                d: fieldInfo.d,\n                dd: fieldInfo.dd,\n                dt: \"FoxESS\",\n                f: fieldInfo.f,\n                fd: fieldInfo.fd,\n                h: \"FoxESS\",\n                iid: sn,\n                m: \"1\",\n                p: \"FoxESS\",\n                u: fieldInfo.u\n            },\n            timestamp: dateUTC\n        };\n\n        node.send({ payload: [obj] });\n    }\n}\nreturn null;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 940,
        "y": 2080,
        "wires": [
            [
                "3d2467e4b8f440ac"
            ]
        ]
    },
    {
        "id": "2f2737d25c9c721f",
        "type": "function",
        "z": "226efa8990661b8c",
        "name": "function 121",
        "func": "let plantObj\nplantObj = []\n\nfor (var i = 0; i < msg.payload.length; i++) {\n    var sn = msg.payload[i].sn;\n    var timestamp = msg.payload[i].time; \n    var eae_day = msg.payload[i][\"YieldToday/kWh\"];\n    var eae = msg.payload[i][\"YieldTotal/kWh\"];\n    var pac = msg.payload[i][\"InvPower(GenerationPower)/kW\"];\n    var fac = msg.payload[i][\"GridFrequency/V\"];\n    var eai = msg.payload[i][\"InputEnergyTotal/kWh\"];\n    var em_pac1 = msg.payload[i][\"MeterPowerR/kW\"];\n    var em_pac2 = msg.payload[i][\"MeterPowerS/kW\"];\n    var em_pac3 = msg.payload[i][\"MeterPowerT/kW\"];\n    var load_pac1 = msg.payload[i][\"LoadspowerR/kW\"];\n    var load_pac2 = msg.payload[i][\"LoadspowerS/kW\"];\n    var load_pac3 = msg.payload[i][\"LoadspowerT/kW\"];\n    var grid_pac1 = msg.payload[i][\"GridPowerR/kW\"];\n    var grid_pac2 = msg.payload[i][\"GridPowerS/kW\"];\n    var grid_pac3 = msg.payload[i][\"GridPowerT/kW\"];\n    var soc = msg.payload[0][\"SoC/%\"];\n\n\n    var obj1 =\n    {\n        sn,\n        timestamp,\n        eae_day,\n        eae,\n        pac,\n        fac,\n        eai,\n        em_pac1,\n        em_pac2,\n        em_pac3,\n        load_pac1,\n        load_pac2,\n        load_pac3,\n        grid_pac1,\n        grid_pac2,\n        grid_pac3,\n        soc\n\n    }\n    plantObj.push(obj1)\n}\n\nmsg.payload = plantObj\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 770,
        "y": 2080,
        "wires": [
            [
                "0b10243331737f77",
                "700c363498e374ee"
            ]
        ]
    },
    {
        "id": "982170e419449de6",
        "type": "influxdb batch",
        "z": "226efa8990661b8c",
        "influxdb": "4a6a4ac55c60a4cc",
        "precision": "",
        "retentionPolicy": "",
        "name": "",
        "database": "database",
        "precisionV18FluxV20": "ms",
        "retentionPolicyV18Flux": "",
        "org": "mgleurope",
        "bucket": "foxess",
        "x": 1210,
        "y": 2080,
        "wires": []
    },
    {
        "id": "3d2467e4b8f440ac",
        "type": "debug",
        "z": "226efa8990661b8c",
        "name": "debug 207",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1070,
        "y": 2140,
        "wires": []
    },
    {
        "id": "0b10243331737f77",
        "type": "debug",
        "z": "226efa8990661b8c",
        "name": "debug 208",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 830,
        "y": 2140,
        "wires": []
    },
    {
        "id": "e387568a3c8bec87",
        "type": "debug",
        "z": "226efa8990661b8c",
        "name": "debug 209",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 510,
        "y": 2340,
        "wires": []
    },
    {
        "id": "e637798e34357dd7",
        "type": "fs-ops-dir",
        "z": "226efa8990661b8c",
        "name": "",
        "path": "/home/iplon/Videos/iGOP plus/senec_ezee/S28836531194348556540356920-week-34-2023.csv",
        "pathType": "str",
        "filter": "*",
        "filterType": "str",
        "dir": "payload",
        "dirType": "msg",
        "x": 400,
        "y": 2200,
        "wires": [
            []
        ]
    },
    {
        "id": "96d76caac6274d31",
        "type": "file in",
        "z": "226efa8990661b8c",
        "name": "read",
        "filename": "/home/iplon/Videos/iGOP plus/senec_ezee/S28836531194348556540356920-week-34-2023.csv",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 290,
        "y": 2400,
        "wires": [
            [
                "e387568a3c8bec87"
            ]
        ]
    },
    {
        "id": "926bcaeddf69cc34",
        "type": "inject",
        "z": "226efa8990661b8c",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 280,
        "y": 2080,
        "wires": [
            [
                "6576f3bbff508d5c"
            ]
        ]
    },
    {
        "id": "11bc867c2c900ac8",
        "type": "debug",
        "z": "226efa8990661b8c",
        "name": "debug 210",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 550,
        "y": 2160,
        "wires": []
    },
    {
        "id": "2cfe32f381014386",
        "type": "comment",
        "z": "226efa8990661b8c",
        "name": "data scraping - Test SENEC",
        "info": "",
        "x": 220,
        "y": 2000,
        "wires": []
    },
    {
        "id": "e6aad1962a48a486",
        "type": "inject",
        "z": "226efa8990661b8c",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 220,
        "y": 2560,
        "wires": [
            [
                "81c3e1ddedd4520a"
            ]
        ]
    },
    {
        "id": "81c3e1ddedd4520a",
        "type": "http request",
        "z": "226efa8990661b8c",
        "name": "URL",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://solarlog.ezee-energy.de/report-generator.html",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 350,
        "y": 2560,
        "wires": [
            [
                "5d5e393afe49791e"
            ]
        ]
    },
    {
        "id": "b30a02dc0abb68d4",
        "type": "html",
        "z": "226efa8990661b8c",
        "name": "selector",
        "property": "payload",
        "outproperty": "payload",
        "tag": "#listplantgroups > h2",
        "ret": "text",
        "as": "single",
        "x": 720,
        "y": 2520,
        "wires": [
            [
                "06368b65e5bff0aa"
            ]
        ]
    },
    {
        "id": "5d5e393afe49791e",
        "type": "debug",
        "z": "226efa8990661b8c",
        "name": "debug 216",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 330,
        "y": 2680,
        "wires": []
    },
    {
        "id": "06368b65e5bff0aa",
        "type": "debug",
        "z": "226efa8990661b8c",
        "name": "debug 217",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 570,
        "y": 2660,
        "wires": []
    },
    {
        "id": "553769484e889256",
        "type": "debug",
        "z": "226efa8990661b8c",
        "name": "debug 229",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1170,
        "y": 140,
        "wires": []
    },
    {
        "id": "74d340463f82c447",
        "type": "function",
        "z": "226efa8990661b8c",
        "name": "function 128",
        "func": "// Assuming msg.payload contains the input string with multiple companies\nvar companies = msg.payload.split(/\\n\\s*\\n/g); // Split by double line breaks\n\nvar data = [];\n\ncompanies.forEach(function (companyStr) {\n    var lines = companyStr.split('\\n');\n    var currentCompany = {};\n\n    lines.forEach(function (line) {\n        var lineContent = line.trim();\n        if (lineContent.startsWith(\"A Blues Clothing\")) {\n            // Push the currentCompany object to data if it's not empty\n            if (Object.keys(currentCompany).length > 0) {\n                data.push(currentCompany);\n                currentCompany = {}; // Reset for the next company\n            }\n            currentCompany.Company = lineContent;\n        } else if (lineContent.startsWith(\"Shri.\")) {\n            currentCompany.ContactPerson = lineContent;\n        } else if (lineContent.startsWith(\"Address:\")) {\n            currentCompany.Address = lineContent.replace('Address:', '').trim();\n        } else if (lineContent.startsWith(\"Contact Number:\")) {\n            currentCompany.ContactNumber = lineContent.replace('Contact Number:', '').trim();\n        } else if (lineContent.startsWith(\"Email:\")) {\n            currentCompany.Email = lineContent.replace('Email:', '').trim();\n        }\n    });\n\n    // Push the last company object if it's not empty\n    if (Object.keys(currentCompany).length > 0) {\n        data.push(currentCompany);\n    }\n});\n\nmsg.payload = data;\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 390,
        "y": 460,
        "wires": [
            []
        ]
    },
    {
        "id": "ad2bdf9eea1229e9",
        "type": "function",
        "z": "226efa8990661b8c",
        "name": "function 129",
        "func": "// Assuming msg.payload contains the input string with multiple companies\nvar companies = msg.payload.split('\\n\\n\\n\\n\\n\\n\\n\\n'); // Split by 8 consecutive line breaks\n\nvar data = [];\n\ncompanies.forEach(function (companyStr) {\n    var lines = companyStr.split('\\n');\n    var currentCompany = {};\n\n    lines.forEach(function (line) {\n        var lineContent = line.trim();\n        if (lineContent.startsWith(\"Shri.\")) {\n            currentCompany.ContactPerson = lineContent;\n        } else if (lineContent.startsWith(\"Address:\")) {\n            currentCompany.Address = lineContent.replace('Address:', '').trim();\n        } else if (lineContent.startsWith(\"Contact Number:\")) {\n            currentCompany.ContactNumber = lineContent.replace('Contact Number:', '').trim();\n        } else if (lineContent.startsWith(\"Email:\")) {\n            currentCompany.Email = lineContent.replace('Email:', '').trim();\n        } else {\n            // Assuming line is the company name\n            if (lineContent) {\n                currentCompany.Company = lineContent;\n            }\n        }\n    });\n\n    // Push the currentCompany object to data if it's not empty\n    if (Object.keys(currentCompany).length > 0) {\n        data.push(currentCompany);\n    }\n});\n\nmsg.payload = data;\n\nreturn msg;\n\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1270,
        "y": 280,
        "wires": [
            [
                "f0296b70d7797908"
            ]
        ]
    },
    {
        "id": "51abbf0b7b4cf74a",
        "type": "function",
        "z": "6c057ca0253f7c60",
        "name": "Influx 2.0",
        "func": "for (var i = 0; i < msg.payload.length; i++) {\n    \n    // Get the incoming time string from the message payload\n    var timeString = msg.payload[i].time; // Assuming you have an index \"i\" for the array\n\n    // Split the time string into components\n    var timeComponents = timeString.split(' ');\n\n    // Split the date component into day, month, and year\n    var dateComponents = timeComponents[0].split('.');\n    var day = dateComponents[0];\n    var month = dateComponents[1] - 1; // Months are 0-indexed in JavaScript Date objects\n    var year = dateComponents[2];\n\n    // Split the time component into hours, minutes, and seconds\n    var time = timeComponents[1].split(':');\n    var hours = time[0];\n    var minutes = time[1];\n    var seconds = time[2];\n\n    // Create a Date object using the parsed components\n    var dateUTC = new Date(Date.UTC(year, month, day, hours, minutes, seconds));\n\n    // Get the timestamp in milliseconds\n    var timestamp = dateUTC.getTime();\n\n    \n    var filename = msg.filename\n    var sn = filename.split(\"/home/iplon/Videos/iGOP plus/senec_ezee/\")[1].split(\"-\")[0];\n\n    var fields = [\n        { field: \"value\", value: msg.payload[i].gridpurchase, d: \"SENEC_HOMEDEVICE\", dd: \"SENEC_HOMEDEVICE\", f: \"gridpurchase\", fd: \"gridpurchase\", u: \"kW\" },\n        { field: \"value\", value: msg.payload[i].gridfeedin, d: \"SENEC_HOMEDEVICE\", dd: \"SENEC_HOMEDEVICE\", f: \"gridfeedin\", fd: \"gridfeedin\", u: \"kW\" },\n        { field: \"value\", value: msg.payload[i].powerconsumption, d: \"SENEC_HOMEDEVICE\", dd: \"SENEC_HOMEDEVICE\", f: \"powerconsumption\", fd: \"powerconsumption\", u: \"kW\" },\n        { field: \"value\", value: msg.payload[i].batterycharge, d: \"SENEC_HOMEDEVICE\", dd: \"SENEC_HOMEDEVICE\", f: \"batterycharge\", fd: \"batterycharge\", u: \"kW\" },\n        { field: \"value\", value: msg.payload[i].batteryconsumption, d: \"SENEC_HOMEDEVICE\", dd: \"SENEC_HOMEDEVICE\", f: \"batteryconsumption\", fd: \"batteryconsumption\", u: \"kW\" },\n        { field: \"value\", value: msg.payload[i].powergeneration, d: \"SENEC_HOMEDEVICE\", dd: \"SENEC_HOMEDEVICE\", f: \"powergeneration\", fd: \"powergeneration\", u: \"kW\" },\n        { field: \"value\", value: msg.payload[i].batteryvoltage, d: \"SENEC_HOMEDEVICE\", dd: \"SENEC_HOMEDEVICE\", f: \"batteryvoltage\", fd: \"batteryvoltage\", u: \"V\" },\n        { field: \"value\", value: msg.payload[i].batterycurrent, d: \"SENEC_HOMEDEVICE\", dd: \"SENEC_HOMEDEVICE\", f: \"batterycurrent\", fd: \"batterycurrent\", u: \"A\" },\n    ];\n\n    for (var j = 0; j < fields.length; j++) {\n        var fieldInfo = fields[j];\n\n        var obj = {\n            measurement: \"v\",\n            fields: {\n                value: fieldInfo.value,\n                text: \"0\",\n                qu: \"0\"\n            },\n            tags: {\n                b: \"BLOCK\",\n                bd: \"BLOCK\",\n                d: fieldInfo.d,\n                dd: fieldInfo.dd,\n                dt: \"SENEC\",\n                f: fieldInfo.f,\n                fd: fieldInfo.fd,\n                h: \"SENEC\",\n                iid: sn,\n                m: \"1\",\n                p: \"SENEC\",\n                u: fieldInfo.u\n            },\n            timestamp: dateUTC\n        };\n\n        node.send({ payload: [obj] });\n    }\n}\nreturn null;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1660,
        "y": 180,
        "wires": [
            [
                "255e8576fe56a284",
                "590d2f7b93dc9d44"
            ]
        ]
    },
    {
        "id": "01bdf0de246c8233",
        "type": "function",
        "z": "6c057ca0253f7c60",
        "name": "function 121",
        "func": "let plantObj\nplantObj = []\n\nfor (var i = 0; i < msg.payload.length; i++) {\n    var time = msg.payload[i].Uhrzeit;\n    var gridpurchase = msg.payload[i][\"Netzbezug [kW]\"]; \n    var gridfeedin = msg.payload[i][\"Netzeinspeisung [kW]\"];\n    var powerconsumption = msg.payload[i][\"Stromverbrauch [kW]\"];\n    var batterycharge = msg.payload[i][\"Akkubeladung [kW]\"];\n    var batteryconsumption = msg.payload[i][\"Akkuentnahme [kW]\"];\n    var powergeneration = msg.payload[i][\"Stromerzeugung [kW]\"];\n    var batteryvoltage = msg.payload[i][\"Akku Spannung [V]\"];\n    var batterycurrent = msg.payload[i][\"Akku Stromstrke [A]\"];\n\n\n    var obj1 =\n    {\n        time,\n        gridpurchase,\n        gridfeedin,\n        powerconsumption,\n        batterycharge,\n        batteryconsumption,\n        powergeneration,\n        batteryvoltage,\n        batterycurrent\n    }\n    plantObj.push(obj1)\n}\n\nmsg.payload = plantObj\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1490,
        "y": 180,
        "wires": [
            [
                "5b69d3eaa176deb9",
                "51abbf0b7b4cf74a"
            ]
        ]
    },
    {
        "id": "590d2f7b93dc9d44",
        "type": "influxdb batch",
        "z": "6c057ca0253f7c60",
        "influxdb": "4a6a4ac55c60a4cc",
        "precision": "",
        "retentionPolicy": "",
        "name": "",
        "database": "database",
        "precisionV18FluxV20": "ms",
        "retentionPolicyV18Flux": "",
        "org": "mgleurope",
        "bucket": "senecezee",
        "x": 1990,
        "y": 180,
        "wires": []
    },
    {
        "id": "255e8576fe56a284",
        "type": "debug",
        "z": "6c057ca0253f7c60",
        "name": "debug 207",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1810,
        "y": 260,
        "wires": []
    },
    {
        "id": "5b69d3eaa176deb9",
        "type": "debug",
        "z": "6c057ca0253f7c60",
        "name": "debug 208",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1570,
        "y": 260,
        "wires": []
    },
    {
        "id": "a19c60ce.f8d06",
        "type": "function",
        "z": "6c057ca0253f7c60",
        "name": "Split by Comma",
        "func": "// Get the input message payload\nvar inputPayload = msg.payload;\n\n// Replace commas with nothing (remove commas)\nvar modifiedString = inputPayload.replace(/,/g, '.');\n\n// Set the modified string as the output message payload\nmsg.payload = modifiedString;\n\n// Return the modified message\nreturn msg;\n\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1160,
        "y": 180,
        "wires": [
            [
                "d3345920ccb85bed"
            ]
        ]
    },
    {
        "id": "1739c1505e5f99e1",
        "type": "debug",
        "z": "6c057ca0253f7c60",
        "name": "debug 211",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1350,
        "y": 280,
        "wires": []
    },
    {
        "id": "d3345920ccb85bed",
        "type": "csv",
        "z": "6c057ca0253f7c60",
        "name": "",
        "sep": ";",
        "hdrin": true,
        "hdrout": "none",
        "multi": "mult",
        "ret": "\\n",
        "temp": "",
        "skip": "",
        "strings": true,
        "include_empty_strings": false,
        "include_null_values": true,
        "x": 1330,
        "y": 180,
        "wires": [
            [
                "1739c1505e5f99e1",
                "01bdf0de246c8233"
            ]
        ]
    },
    {
        "id": "fc48fa1b4c16b1bf",
        "type": "comment",
        "z": "6c057ca0253f7c60",
        "name": "SENEC (Ezee)",
        "info": "",
        "x": 200,
        "y": 120,
        "wires": []
    },
    {
        "id": "a1f46e7b.6a8558",
        "type": "fs-ops-dir",
        "z": "6c057ca0253f7c60",
        "name": "Read Folder",
        "path": "/home/iplon/Videos/iGOP plus/senec_ezee",
        "pathType": "str",
        "filter": "*",
        "filterType": "str",
        "dir": "true",
        "dirType": "msg",
        "x": 370,
        "y": 1680,
        "wires": [
            [
                "0778388fb6e58e02",
                "50e4d6c9.6b7f2c"
            ]
        ]
    },
    {
        "id": "50e4d6c9.6b7f2c",
        "type": "function",
        "z": "6c057ca0253f7c60",
        "name": "Process Files",
        "func": "for (const file of msg.payload) {\n    msg.payload = file;\n    node.send(msg);\n}\nreturn null;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 580,
        "y": 1680,
        "wires": [
            [
                "6066e7f3.3c4d2c"
            ]
        ]
    },
    {
        "id": "6066e7f3.3c4d2c",
        "type": "debug",
        "z": "6c057ca0253f7c60",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 830,
        "y": 1680,
        "wires": []
    },
    {
        "id": "a69170f7a7a29e7c",
        "type": "inject",
        "z": "6c057ca0253f7c60",
        "name": "",
        "props": [],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 170,
        "y": 1680,
        "wires": [
            [
                "a1f46e7b.6a8558"
            ]
        ]
    },
    {
        "id": "0778388fb6e58e02",
        "type": "debug",
        "z": "6c057ca0253f7c60",
        "name": "debug 213",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 610,
        "y": 1840,
        "wires": []
    },
    {
        "id": "97d13ddf43fc4d11",
        "type": "fs-ops-dir",
        "z": "6c057ca0253f7c60",
        "name": "Read Folder",
        "path": "/home/iplon/Videos/iGOP plus/senec_ezee/",
        "pathType": "str",
        "filter": "*",
        "filterType": "str",
        "dir": "true",
        "dirType": "msg",
        "x": 430,
        "y": 2000,
        "wires": [
            [
                "afe92314e144438a"
            ]
        ]
    },
    {
        "id": "70098e0f26ba03d2",
        "type": "split",
        "z": "6c057ca0253f7c60",
        "name": "",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "true",
        "x": 1130,
        "y": 1880,
        "wires": [
            [
                "631772b58859e427"
            ]
        ]
    },
    {
        "id": "631772b58859e427",
        "type": "function",
        "z": "6c057ca0253f7c60",
        "name": "Format File Path",
        "func": "msg.payload = msg.payload.trim();\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1280,
        "y": 1880,
        "wires": [
            [
                "5647b111821ee787"
            ]
        ]
    },
    {
        "id": "5647b111821ee787",
        "type": "debug",
        "z": "6c057ca0253f7c60",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1490,
        "y": 1880,
        "wires": []
    },
    {
        "id": "3fead6d6549cf20c",
        "type": "inject",
        "z": "6c057ca0253f7c60",
        "name": "",
        "props": [],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 230,
        "y": 2000,
        "wires": [
            [
                "97d13ddf43fc4d11"
            ]
        ]
    },
    {
        "id": "ec6640a2d0810128",
        "type": "debug",
        "z": "6c057ca0253f7c60",
        "name": "debug 214",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1370,
        "y": 2100,
        "wires": []
    },
    {
        "id": "b9afd4a81b766940",
        "type": "fs-ops-dir",
        "z": "6c057ca0253f7c60",
        "name": "Read Folder",
        "path": "/home/iplon/Videos/iGOP plus/senec_ezee",
        "pathType": "str",
        "filter": "*",
        "filterType": "str",
        "dir": "true",
        "dirType": "msg",
        "x": 1370,
        "y": 1780,
        "wires": [
            [
                "5cd3060f95add1f0"
            ]
        ]
    },
    {
        "id": "5cd3060f95add1f0",
        "type": "function",
        "z": "6c057ca0253f7c60",
        "name": "Format File Paths",
        "func": "msg.payload = msg.payload.map(file => file.name);\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1580,
        "y": 1780,
        "wires": [
            [
                "e6fcec15a3261901"
            ]
        ]
    },
    {
        "id": "e6fcec15a3261901",
        "type": "debug",
        "z": "6c057ca0253f7c60",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1790,
        "y": 1780,
        "wires": []
    },
    {
        "id": "0a2785cc00b2a2ec",
        "type": "inject",
        "z": "6c057ca0253f7c60",
        "name": "",
        "props": [],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 1170,
        "y": 1780,
        "wires": [
            [
                "b9afd4a81b766940"
            ]
        ]
    },
    {
        "id": "c7241d8a25b44347",
        "type": "file in",
        "z": "6c057ca0253f7c60",
        "name": "",
        "filename": "",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 1140,
        "y": 2000,
        "wires": [
            [
                "ec6640a2d0810128"
            ]
        ]
    },
    {
        "id": "afe92314e144438a",
        "type": "function",
        "z": "6c057ca0253f7c60",
        "name": "function 123",
        "func": "// Initialize the array of URLs outside the loop\nvar files = [];\n\nfor (var i = 1; i <= msg.true.length; i++) {\n    // Construct the URL and push it to the array\n    files.push(\"/home/iplon/Videos/iGOP plus/senec_ezee/\" + msg.true[i] );\n}\n\n// Set the array of URLs as a property of the message\nmsg.payload = files;\n\n// Return the modified message after the loop\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 590,
        "y": 2000,
        "wires": [
            [
                "83fe88c76596052d"
            ]
        ]
    },
    {
        "id": "83fe88c76596052d",
        "type": "split",
        "z": "6c057ca0253f7c60",
        "name": "",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 750,
        "y": 2000,
        "wires": [
            [
                "98a4dbf593cc4c94"
            ]
        ]
    },
    {
        "id": "98a4dbf593cc4c94",
        "type": "change",
        "z": "6c057ca0253f7c60",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "filename",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 950,
        "y": 2000,
        "wires": [
            [
                "c7241d8a25b44347"
            ]
        ]
    },
    {
        "id": "3c7583c3337b4a79",
        "type": "fs-ops-dir",
        "z": "6c057ca0253f7c60",
        "name": "Read Folder",
        "path": "/home/iplon/Videos/iGOP plus/senec_ezee/",
        "pathType": "str",
        "filter": "*",
        "filterType": "str",
        "dir": "true",
        "dirType": "msg",
        "x": 250,
        "y": 180,
        "wires": [
            [
                "178e095f782959d7"
            ]
        ]
    },
    {
        "id": "6e4f3952f7c81dc7",
        "type": "inject",
        "z": "6c057ca0253f7c60",
        "name": "",
        "props": [],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 90,
        "y": 180,
        "wires": [
            [
                "3c7583c3337b4a79"
            ]
        ]
    },
    {
        "id": "988cf6a615ae9719",
        "type": "debug",
        "z": "6c057ca0253f7c60",
        "name": "debug 214",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1070,
        "y": 300,
        "wires": []
    },
    {
        "id": "178e095f782959d7",
        "type": "function",
        "z": "6c057ca0253f7c60",
        "name": "function 123",
        "func": "// Initialize the array of URLs outside the loop\nvar files = [];\n\nfor (var i = 1; i < msg.true.length; i++) {\n    // Construct the full file path and push it to the array\n    files.push(\"/home/iplon/Videos/iGOP plus/senec_ezee/\" + msg.true[i]);\n}\n\n// Set the array of file paths as the payload\nmsg.payload = files;\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 450,
        "y": 180,
        "wires": [
            [
                "aa83e418d29ce56d"
            ]
        ]
    },
    {
        "id": "aa83e418d29ce56d",
        "type": "split",
        "z": "6c057ca0253f7c60",
        "name": "",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 610,
        "y": 180,
        "wires": [
            [
                "e98af85b5e596a7e"
            ]
        ]
    },
    {
        "id": "e98af85b5e596a7e",
        "type": "change",
        "z": "6c057ca0253f7c60",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "filename",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 770,
        "y": 180,
        "wires": [
            []
        ]
    },
    {
        "id": "0861cebe623b47ea",
        "type": "file in",
        "z": "6c057ca0253f7c60",
        "name": "path",
        "filename": "/home/iplon/Videos/iGOP plus/senec_ezee/194348556540356920-week-34-2023.csv",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 890,
        "y": 260,
        "wires": [
            []
        ]
    },
    {
        "id": "35574451dc5ffb34",
        "type": "delay",
        "z": "6c057ca0253f7c60",
        "name": "",
        "pauseType": "delay",
        "timeout": "10",
        "timeoutUnits": "minutes",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 250,
        "y": 280,
        "wires": [
            [
                "286ef41ff8b6cbf1"
            ]
        ]
    },
    {
        "id": "485c1c744764b31f",
        "type": "debug",
        "z": "6c057ca0253f7c60",
        "name": "debug 215",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 610,
        "y": 280,
        "wires": []
    },
    {
        "id": "950d334ec83a2948",
        "type": "function",
        "z": "6c057ca0253f7c60",
        "name": "Influx 2.0",
        "func": "for (var i = 0; i < msg.payload.length; i++) {\n    \n    // Get the incoming time string from the message payload\n    var timeString = msg.payload[i].time; // Assuming you have an index \"i\" for the array\n\n    // Split the time string into components\n    var timeComponents = timeString.split(' ');\n\n    // Split the date component into day, month, and year\n    var dateComponents = timeComponents[0].split('.');\n    var day = dateComponents[0];\n    var month = dateComponents[1] - 1; // Months are 0-indexed in JavaScript Date objects\n    var year = dateComponents[2];\n\n    // Split the time component into hours, minutes, and seconds\n    var time = timeComponents[1].split(':');\n    var hours = time[0];\n    var minutes = time[1];\n    var seconds = time[2];\n\n    // Create a Date object using the parsed components\n    var dateUTC = new Date(Date.UTC(year, month, day, hours, minutes, seconds));\n\n    // Get the timestamp in milliseconds\n    var timestamp = dateUTC.getTime();\n\n    \n    var filename = msg.filename\n    var sn = filename.split(\"/home/iplon/Videos/iGOP plus/senec_solera/\")[1].split(\"-\")[0];\n\n    var fields = [\n        { field: \"value\", value: msg.payload[i].gridpurchase, d: \"SENEC_HOMEDEVICE\", dd: \"SENEC_HOMEDEVICE\", f: \"gridpurchase\", fd: \"gridpurchase\", u: \"kW\" },\n        { field: \"value\", value: msg.payload[i].gridfeedin, d: \"SENEC_HOMEDEVICE\", dd: \"SENEC_HOMEDEVICE\", f: \"gridfeedin\", fd: \"gridfeedin\", u: \"kW\" },\n        { field: \"value\", value: msg.payload[i].powerconsumption, d: \"SENEC_HOMEDEVICE\", dd: \"SENEC_HOMEDEVICE\", f: \"powerconsumption\", fd: \"powerconsumption\", u: \"kW\" },\n        { field: \"value\", value: msg.payload[i].batterycharge, d: \"SENEC_HOMEDEVICE\", dd: \"SENEC_HOMEDEVICE\", f: \"batterycharge\", fd: \"batterycharge\", u: \"kW\" },\n        { field: \"value\", value: msg.payload[i].batteryconsumption, d: \"SENEC_HOMEDEVICE\", dd: \"SENEC_HOMEDEVICE\", f: \"batteryconsumption\", fd: \"batteryconsumption\", u: \"kW\" },\n        { field: \"value\", value: msg.payload[i].powergeneration, d: \"SENEC_HOMEDEVICE\", dd: \"SENEC_HOMEDEVICE\", f: \"powergeneration\", fd: \"powergeneration\", u: \"kW\" },\n        { field: \"value\", value: msg.payload[i].batteryvoltage, d: \"SENEC_HOMEDEVICE\", dd: \"SENEC_HOMEDEVICE\", f: \"batteryvoltage\", fd: \"batteryvoltage\", u: \"V\" },\n        { field: \"value\", value: msg.payload[i].batterycurrent, d: \"SENEC_HOMEDEVICE\", dd: \"SENEC_HOMEDEVICE\", f: \"batterycurrent\", fd: \"batterycurrent\", u: \"A\" },\n    ];\n\n    for (var j = 0; j < fields.length; j++) {\n        var fieldInfo = fields[j];\n\n        var obj = {\n            measurement: \"v\",\n            fields: {\n                value: fieldInfo.value,\n                text: \"0\",\n                qu: \"0\"\n            },\n            tags: {\n                b: \"BLOCK\",\n                bd: \"BLOCK\",\n                d: fieldInfo.d,\n                dd: fieldInfo.dd,\n                dt: \"SENEC\",\n                f: fieldInfo.f,\n                fd: fieldInfo.fd,\n                h: \"SENEC\",\n                iid: sn,\n                m: \"1\",\n                p: \"SENEC\",\n                u: fieldInfo.u\n            },\n            timestamp: dateUTC\n        };\n\n        node.send({ payload: [obj] });\n    }\n}\nreturn null;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1660,
        "y": 460,
        "wires": [
            [
                "69e0a5d8dea8f253",
                "7c885fa623698cae"
            ]
        ]
    },
    {
        "id": "bf954f0601292ebd",
        "type": "function",
        "z": "6c057ca0253f7c60",
        "name": "function 124",
        "func": "let plantObj\nplantObj = []\n\nfor (var i = 0; i < msg.payload.length; i++) {\n    var time = msg.payload[i].Uhrzeit;\n    var gridpurchase = msg.payload[i][\"Netzbezug [kW]\"]; \n    var gridfeedin = msg.payload[i][\"Netzeinspeisung [kW]\"];\n    var powerconsumption = msg.payload[i][\"Stromverbrauch [kW]\"];\n    var batterycharge = msg.payload[i][\"Akkubeladung [kW]\"];\n    var batteryconsumption = msg.payload[i][\"Akkuentnahme [kW]\"];\n    var powergeneration = msg.payload[i][\"Stromerzeugung [kW]\"];\n    var batteryvoltage = msg.payload[i][\"Akku Spannung [V]\"];\n    var batterycurrent = msg.payload[i][\"Akku Stromstrke [A]\"];\n\n\n    var obj1 =\n    {\n        time,\n        gridpurchase,\n        gridfeedin,\n        powerconsumption,\n        batterycharge,\n        batteryconsumption,\n        powergeneration,\n        batteryvoltage,\n        batterycurrent\n    }\n    plantObj.push(obj1)\n}\n\nmsg.payload = plantObj\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1490,
        "y": 460,
        "wires": [
            [
                "0baadcbba7a6da4e",
                "950d334ec83a2948"
            ]
        ]
    },
    {
        "id": "7c885fa623698cae",
        "type": "influxdb batch",
        "z": "6c057ca0253f7c60",
        "influxdb": "4a6a4ac55c60a4cc",
        "precision": "",
        "retentionPolicy": "",
        "name": "",
        "database": "database",
        "precisionV18FluxV20": "ms",
        "retentionPolicyV18Flux": "",
        "org": "mgleurope",
        "bucket": "senecsolera",
        "x": 1990,
        "y": 460,
        "wires": []
    },
    {
        "id": "69e0a5d8dea8f253",
        "type": "debug",
        "z": "6c057ca0253f7c60",
        "name": "debug 218",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1810,
        "y": 540,
        "wires": []
    },
    {
        "id": "0baadcbba7a6da4e",
        "type": "debug",
        "z": "6c057ca0253f7c60",
        "name": "debug 219",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1570,
        "y": 540,
        "wires": []
    },
    {
        "id": "a4d5dc847d89dcae",
        "type": "function",
        "z": "6c057ca0253f7c60",
        "name": "Split by Comma",
        "func": "// Get the input message payload\nvar inputPayload = msg.payload;\n\n// Replace commas with nothing (remove commas)\nvar modifiedString = inputPayload.replace(/,/g, '.');\n\n// Set the modified string as the output message payload\nmsg.payload = modifiedString;\n\n// Return the modified message\nreturn msg;\n\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1160,
        "y": 460,
        "wires": [
            [
                "cb46452b784a2211"
            ]
        ]
    },
    {
        "id": "a1edd5f4e9290e2f",
        "type": "debug",
        "z": "6c057ca0253f7c60",
        "name": "debug 220",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1350,
        "y": 560,
        "wires": []
    },
    {
        "id": "cb46452b784a2211",
        "type": "csv",
        "z": "6c057ca0253f7c60",
        "name": "",
        "sep": ";",
        "hdrin": true,
        "hdrout": "none",
        "multi": "mult",
        "ret": "\\n",
        "temp": "",
        "skip": "",
        "strings": true,
        "include_empty_strings": false,
        "include_null_values": true,
        "x": 1330,
        "y": 460,
        "wires": [
            [
                "a1edd5f4e9290e2f",
                "bf954f0601292ebd"
            ]
        ]
    },
    {
        "id": "3684ee2ecf9d8501",
        "type": "comment",
        "z": "6c057ca0253f7c60",
        "name": "SENEC (Solera)",
        "info": "",
        "x": 200,
        "y": 400,
        "wires": []
    },
    {
        "id": "e28e1ec324b1566c",
        "type": "fs-ops-dir",
        "z": "6c057ca0253f7c60",
        "name": "Read Folder",
        "path": "/home/iplon/Videos/iGOP plus/senec_solera/",
        "pathType": "str",
        "filter": "*",
        "filterType": "str",
        "dir": "true",
        "dirType": "msg",
        "x": 250,
        "y": 460,
        "wires": [
            [
                "274b9ae340339f21"
            ]
        ]
    },
    {
        "id": "ed5c4e03fbe3986c",
        "type": "inject",
        "z": "6c057ca0253f7c60",
        "name": "",
        "props": [],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 90,
        "y": 460,
        "wires": [
            [
                "e28e1ec324b1566c"
            ]
        ]
    },
    {
        "id": "a51ab3e23e6f6c61",
        "type": "debug",
        "z": "6c057ca0253f7c60",
        "name": "debug 221",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1070,
        "y": 580,
        "wires": []
    },
    {
        "id": "274b9ae340339f21",
        "type": "function",
        "z": "6c057ca0253f7c60",
        "name": "function 125",
        "func": "// Initialize the array of URLs outside the loop\nvar files = [];\n\nfor (var i = 1; i < msg.true.length; i++) {\n    // Construct the full file path and push it to the array\n    files.push(\"/home/iplon/Videos/iGOP plus/senec_solera/\" + msg.true[i]);\n}\n\n// Set the array of file paths as the payload\nmsg.payload = files;\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 450,
        "y": 460,
        "wires": [
            [
                "efa6b9d96fec93da"
            ]
        ]
    },
    {
        "id": "efa6b9d96fec93da",
        "type": "split",
        "z": "6c057ca0253f7c60",
        "name": "",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 610,
        "y": 460,
        "wires": [
            [
                "abfe28b594312c9b"
            ]
        ]
    },
    {
        "id": "abfe28b594312c9b",
        "type": "change",
        "z": "6c057ca0253f7c60",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "filename",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 810,
        "y": 460,
        "wires": [
            []
        ]
    },
    {
        "id": "926fe26ebca5fbe2",
        "type": "file in",
        "z": "6c057ca0253f7c60",
        "name": "read",
        "filename": "/home/iplon/Videos/iGOP plus/senec_solera/S44564911481527300540553813-week-38-2023.csv",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 970,
        "y": 460,
        "wires": [
            [
                "a51ab3e23e6f6c61",
                "a4d5dc847d89dcae"
            ]
        ]
    },
    {
        "id": "40bcaffc0f093178",
        "type": "function",
        "z": "6c057ca0253f7c60",
        "name": "Influx 2.0",
        "func": "for (var i = 0; i < msg.payload.length; i++) {\n\n    // Sample date in the format \"DD/MM/YYYY\"\n    var dateString = msg.payload[i].date;\n\n    // Split the date string into components\n    var dateComponents = dateString.split(\"/\");\n\n    // Extract day, month, and year\n    var day = parseInt(dateComponents[0]);\n    var month = parseInt(dateComponents[1]);\n    var year = parseInt(dateComponents[2]);\n\n    // Create a new Date object (months are 0-based in JavaScript)\n    var date = new Date(year, month - 1, day);\n\n    // Convert the date to a timestamp in milliseconds\n    var dateUTC = date.getTime();\n\n    // Now you can use the timestamp to inject into InfluxDB\n    console.log(\"Timestamp:\", dateUTC);\n\n    \n    var filename = msg.filename\n    var sn = filename.split(\"/home/iplon/Videos/iGOP plus/web3/\")[1].split(\"-\")[0];\n\n    var fields = [\n        { field: \"value\", value: msg.payload[i].totalyield, d: \"WEB3\", dd: \"WEB3\", f: \"totalyield\", fd: \"totalyield\", u: \"Wh\" },\n        { field: \"value\", value: msg.payload[i].targetyield, d: \"WEB3\", dd: \"WEB3\", f: \"targetyield\", fd: \"targetyield\", u: \"Wh\" },\n        { field: \"value\", value: msg.payload[i].sensoryield, d: \"WEB3\", dd: \"WEB3\", f: \"sensoryield\", fd: \"sensoryield\", u: \"Wh\" },\n        { field: \"value\", value: msg.payload[i].specificyield, d: \"WEB3\", dd: \"WEB3\", f: \"specificyield\", fd: \"specificyield\", u: \"kWh/kWp\" },\n        { field: \"value\", value: msg.payload[i].yieldineuro, d: \"WEB3\", dd: \"WEB3\", f: \"yieldineuro\", fd: \"yieldineuro\", u: \"\" },\n        { field: \"value\", value: msg.payload[i].targetineuro, d: \"WEB3\", dd: \"WEB3\", f: \"targetineuro\", fd: \"targetineuro\", u: \"\" },\n        { field: \"value\", value: msg.payload[i].differencetarget, d: \"WEB3\", dd: \"WEB3\", f: \"differencetarget\", fd: \"differencetarget\", u: \"%\" },\n    ];\n\n    for (var j = 0; j < fields.length; j++) {\n        var fieldInfo = fields[j];\n\n        var obj = {\n            measurement: \"v\",\n            fields: {\n                value: fieldInfo.value,\n                text: \"0\",\n                qu: \"0\"\n            },\n            tags: {\n                b: \"BLOCK\",\n                bd: \"BLOCK\",\n                d: fieldInfo.d,\n                dd: fieldInfo.dd,\n                dt: \"web3\",\n                f: fieldInfo.f,\n                fd: fieldInfo.fd,\n                h: \"web3\",\n                iid: sn,\n                m: \"1\",\n                p: \"web3\",\n                u: fieldInfo.u\n            },\n            timestamp: dateUTC\n        };\n\n        node.send({ payload: [obj] });\n    }\n}\nreturn null;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 960,
        "y": 760,
        "wires": [
            [
                "cfcf1c33badad22e",
                "67fb100a5a8d8c23"
            ]
        ]
    },
    {
        "id": "12b1c1e4560bb98b",
        "type": "function",
        "z": "6c057ca0253f7c60",
        "name": "function 126",
        "func": "let plantObj\nplantObj = []\n\nfor (var i = 0; i < msg.payload.length; i++) {\n    var date = msg.payload[i].Date;\n    var totalyield = msg.payload[i][\"Total Yield in Wh\"]; \n    var targetyield = msg.payload[i][\"Target Yield Wh\"];\n    var sensoryield = msg.payload[i][\"Sensor yield Wh\"];\n    var specificyield = msg.payload[i][\"Specific Yield kWh/kWp\"];\n    var yieldineuro = msg.payload[i][\"Yield In \"];\n    var targetineuro = msg.payload[i][\"Target in \"];\n    var differencetarget = msg.payload[i][\"Difference Target / Actual %\"];\n\n\n    var obj1 =\n    {\n        date,\n        totalyield,\n        targetyield,\n        sensoryield,\n        specificyield,\n        yieldineuro,\n        targetineuro,\n        differencetarget\n\n    }\n    plantObj.push(obj1)\n}\n\nmsg.payload = plantObj\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 670,
        "y": 760,
        "wires": [
            [
                "332b04621963fdf0",
                "40bcaffc0f093178"
            ]
        ]
    },
    {
        "id": "67fb100a5a8d8c23",
        "type": "influxdb batch",
        "z": "6c057ca0253f7c60",
        "influxdb": "4a6a4ac55c60a4cc",
        "precision": "",
        "retentionPolicy": "",
        "name": "",
        "database": "database",
        "precisionV18FluxV20": "ms",
        "retentionPolicyV18Flux": "",
        "org": "mgleurope",
        "bucket": "web3",
        "x": 1290,
        "y": 760,
        "wires": []
    },
    {
        "id": "cfcf1c33badad22e",
        "type": "debug",
        "z": "6c057ca0253f7c60",
        "name": "debug 223",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1110,
        "y": 840,
        "wires": []
    },
    {
        "id": "332b04621963fdf0",
        "type": "debug",
        "z": "6c057ca0253f7c60",
        "name": "debug 224",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 870,
        "y": 840,
        "wires": []
    },
    {
        "id": "f89e962d4f892081",
        "type": "csv",
        "z": "6c057ca0253f7c60",
        "name": "",
        "sep": ";",
        "hdrin": true,
        "hdrout": "none",
        "multi": "mult",
        "ret": "\\n",
        "temp": "",
        "skip": "",
        "strings": true,
        "include_empty_strings": false,
        "include_null_values": true,
        "x": 470,
        "y": 760,
        "wires": [
            [
                "12b1c1e4560bb98b"
            ]
        ]
    },
    {
        "id": "88836b9e3cb0342a",
        "type": "comment",
        "z": "6c057ca0253f7c60",
        "name": "web 3",
        "info": "",
        "x": 170,
        "y": 660,
        "wires": []
    },
    {
        "id": "3bebaf94eb18f2b9",
        "type": "inject",
        "z": "6c057ca0253f7c60",
        "name": "",
        "props": [],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 130,
        "y": 760,
        "wires": [
            [
                "2a67923fd1a17620"
            ]
        ]
    },
    {
        "id": "2a67923fd1a17620",
        "type": "file in",
        "z": "6c057ca0253f7c60",
        "name": "file",
        "filename": "/home/iplon/Videos/iGOP plus/web3/274515577_2023-09-18_2023-09-20.csv",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 270,
        "y": 760,
        "wires": [
            [
                "f89e962d4f892081"
            ]
        ]
    },
    {
        "id": "e0126fa130f9b070",
        "type": "fs-ops-delete",
        "z": "6c057ca0253f7c60",
        "name": "",
        "path": "/home/iplon/Videos/iGOP plus/senec_ezee/",
        "pathType": "str",
        "filename": "*",
        "filenameType": "str",
        "x": 330,
        "y": 1060,
        "wires": [
            [
                "6e423281b6db944e"
            ]
        ]
    },
    {
        "id": "c606c3e892b1326b",
        "type": "inject",
        "z": "6c057ca0253f7c60",
        "name": "",
        "props": [],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 170,
        "y": 1060,
        "wires": [
            [
                "e0126fa130f9b070"
            ]
        ]
    },
    {
        "id": "6e423281b6db944e",
        "type": "debug",
        "z": "6c057ca0253f7c60",
        "name": "debug 228",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 510,
        "y": 1060,
        "wires": []
    },
    {
        "id": "286ef41ff8b6cbf1",
        "type": "fs-remove",
        "z": "6c057ca0253f7c60",
        "path": "/home/iplon/Videos/iGOP plus/senec_ezee/",
        "pathType": "str",
        "filename": "*",
        "filenameType": "str",
        "recursive": true,
        "exist": false,
        "name": "",
        "x": 430,
        "y": 280,
        "wires": [
            [
                "485c1c744764b31f"
            ]
        ]
    },
    {
        "id": "d5682f81d0ebe280",
        "type": "delay",
        "z": "6c057ca0253f7c60",
        "name": "",
        "pauseType": "delay",
        "timeout": "10",
        "timeoutUnits": "minutes",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 270,
        "y": 560,
        "wires": [
            [
                "98b08d033229d86f"
            ]
        ]
    },
    {
        "id": "e460ac05fa0ddb29",
        "type": "debug",
        "z": "6c057ca0253f7c60",
        "name": "debug 231",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 630,
        "y": 560,
        "wires": []
    },
    {
        "id": "98b08d033229d86f",
        "type": "fs-remove",
        "z": "6c057ca0253f7c60",
        "path": "/home/iplon/Videos/iGOP plus/senec_solera/",
        "pathType": "str",
        "filename": "*",
        "filenameType": "str",
        "recursive": true,
        "exist": false,
        "name": "",
        "x": 450,
        "y": 560,
        "wires": [
            [
                "e460ac05fa0ddb29"
            ]
        ]
    },
    {
        "id": "171f81e9d4f41071",
        "type": "delay",
        "z": "6c057ca0253f7c60",
        "name": "",
        "pauseType": "delay",
        "timeout": "10",
        "timeoutUnits": "minutes",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 290,
        "y": 860,
        "wires": [
            [
                "19bddc1e548e1c67"
            ]
        ]
    },
    {
        "id": "e549984092c38a3e",
        "type": "debug",
        "z": "6c057ca0253f7c60",
        "name": "debug 232",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 650,
        "y": 860,
        "wires": []
    },
    {
        "id": "19bddc1e548e1c67",
        "type": "fs-remove",
        "z": "6c057ca0253f7c60",
        "path": "/home/iplon/Videos/iGOP plus/web3/",
        "pathType": "str",
        "filename": "*",
        "filenameType": "str",
        "recursive": true,
        "exist": false,
        "name": "",
        "x": 470,
        "y": 860,
        "wires": [
            [
                "e549984092c38a3e"
            ]
        ]
    },
    {
        "id": "1259d168176c9455",
        "type": "inject",
        "z": "6c057ca0253f7c60",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 920,
        "y": 100,
        "wires": [
            [
                "ccf5c302660ae14b"
            ]
        ]
    },
    {
        "id": "ccf5c302660ae14b",
        "type": "file in",
        "z": "6c057ca0253f7c60",
        "name": "read",
        "filename": "/home/iplon/Videos/iGOP plus/senec_ezee/S42599051127305218540489781-week-38-2023 (1).csv",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 990,
        "y": 180,
        "wires": [
            [
                "988cf6a615ae9719",
                "a19c60ce.f8d06"
            ]
        ]
    },
    {
        "id": "a66a2aebff24074d",
        "type": "inject",
        "z": "6c057ca0253f7c60",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 940,
        "y": 380,
        "wires": [
            [
                "926fe26ebca5fbe2"
            ]
        ]
    },
    {
        "id": "d261fff0c99bda39",
        "type": "template",
        "z": "f718a3471b76fac6",
        "name": "working download url1",
        "field": "payload",
        "fieldType": "msg",
        "format": "javascript",
        "syntax": "mustache",
        "template": "const puppeteer = require('puppeteer');\nconst fs = require('fs');\n\nasync function getDownloadUrl(url, username, password, sn, startdate, enddate) {\n    const browser = await puppeteer.launch({\n        headless: false,\n        args: ['--disable-web-security'],\n        defaultViewport: null,\n    });\n    const page = await browser.newPage();\n    await page.setViewport({ width: 1200, height: 800 });\n\n    try {\n        await page.goto(url, { waitUntil: 'networkidle0' });\n\n        await page.waitForSelector('input[type=\"text\"]');\n        await page.type('input[type=\"text\"]', username);\n        await page.type('input[type=\"password\"]', password);\n\n        await Promise.all([\n            page.click('button.el-button.login-click.el-button--primary'),\n            page.waitForNavigation({ waitUntil: 'networkidle0' }),\n        ]);\n\n        await page.click(\n            '#app > div > section > aside > div > div.sidebar-container > div.el-scrollbar > div.scrollbar-wrapper.el-scrollbar__wrap > div > ul > div:nth-child(10)'\n        );\n\n        await page.waitForSelector('input[type=\"text\"]');\n        await page.type('input[type=\"text\"]', sn);\n\n        await page.waitForSelector('input[placeholder=\"Start Date\"]');\n        await page.type('input[placeholder=\"Start Date\"]', startdate);\n\n        await page.waitForSelector('input[placeholder=\"End Date\"]');\n        await page.type('input[placeholder=\"End Date\"]', enddate);\n\n        await page.click('button.el-button.el-button--success.el-button--mini');\n\n        const response = await page.waitForResponse((response) => {\n            return response.url().includes('https://www.foxesscloud.com/c/v0/device/report/query');\n        }, { timeout: 60000 });\n\n        const responseData = await response.json();\n        const downloadUrl = responseData.result.downloadUrl;\n\n        return downloadUrl; // Resolve the Promise with the download URL\n    } finally {\n        await browser.close();\n    }\n}\n\n(async () => {\n    const url = process.argv[2];\n    const username = process.argv[3];\n    const password = process.argv[4];\n    const sn = process.argv[5];\n    const startdate = process.argv[6];\n    const enddate = process.argv[7];\n\n    try {\n        const downloadUrl = await getDownloadUrl(url, username, password, sn, startdate, enddate);\n        if (downloadUrl) {\n            console.log('Download URL: ' + downloadUrl);\n        } else {\n            console.log('Download URL not found in response.');\n        }\n    } catch (error) {\n        console.error('Error: ' + error);\n    }\n})();\n",
        "output": "str",
        "x": 320,
        "y": 200,
        "wires": [
            [
                "c3b64d5c2d6346b9"
            ]
        ]
    },
    {
        "id": "548220348cf5b12b",
        "type": "exec",
        "z": "f718a3471b76fac6",
        "command": "",
        "addpay": "payload",
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "Run Puppeteer Script",
        "x": 940,
        "y": 280,
        "wires": [
            [
                "84d25a50efd8e2a9"
            ],
            [],
            []
        ]
    },
    {
        "id": "c3b64d5c2d6346b9",
        "type": "file",
        "z": "f718a3471b76fac6",
        "name": "path",
        "filename": "/home/iplon/Documents/Working_Scripts/working_download_url1.js",
        "filenameType": "str",
        "appendNewline": true,
        "createDir": false,
        "overwriteFile": "true",
        "encoding": "none",
        "x": 510,
        "y": 200,
        "wires": [
            [
                "815874e371e27c8d"
            ]
        ]
    },
    {
        "id": "4c4075a2ec10b91e",
        "type": "inject",
        "z": "f718a3471b76fac6",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 120,
        "y": 200,
        "wires": [
            [
                "d261fff0c99bda39"
            ]
        ]
    },
    {
        "id": "815874e371e27c8d",
        "type": "debug",
        "z": "f718a3471b76fac6",
        "name": "debug 246",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 670,
        "y": 200,
        "wires": []
    },
    {
        "id": "6a658be902a0f437",
        "type": "comment",
        "z": "f718a3471b76fac6",
        "name": "Foxess cloud data injection",
        "info": "",
        "x": 150,
        "y": 80,
        "wires": []
    },
    {
        "id": "84d25a50efd8e2a9",
        "type": "function",
        "z": "f718a3471b76fac6",
        "name": "function 133",
        "func": "var url = msg.payload;\nvar parsedValue = url.split(\"Download URL: \")[1];\n\nif (parsedValue) {\n    msg.payload = \"https://www.foxesscloud.com\" + parsedValue;\n} else {\n    // Handle the case where \"Download URL: \" is not found in the input URL.\n    // You can set a default value or handle the error as needed.\n    msg.payload = \"https://www.foxesscloud.com\"; // Default value\n}\n\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 530,
        "y": 380,
        "wires": [
            [
                "c77dac7c03d8020e"
            ]
        ]
    },
    {
        "id": "f7e500157fdf5112",
        "type": "http request",
        "z": "f718a3471b76fac6",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 890,
        "y": 380,
        "wires": [
            [
                "b25a32a81dd3965a"
            ]
        ]
    },
    {
        "id": "b25a32a81dd3965a",
        "type": "csv",
        "z": "f718a3471b76fac6",
        "name": "",
        "sep": ",",
        "hdrin": true,
        "hdrout": "none",
        "multi": "mult",
        "ret": "\\n",
        "temp": "",
        "skip": "0",
        "strings": true,
        "include_empty_strings": "",
        "include_null_values": true,
        "x": 1030,
        "y": 380,
        "wires": [
            [
                "87fcc9c13168b9de",
                "eac5c2ac27dbef24"
            ]
        ]
    },
    {
        "id": "b0ee12146236348f",
        "type": "function",
        "z": "f718a3471b76fac6",
        "name": "Influx 2.0",
        "func": "for (var i = 0; i < msg.payload.length; i++) {\n    var customTimestamp = msg.payload[i].timestamp; // Example: \"2023-08-18 00:02:26 CEST+0200\"\n\n    // Extract the date and time portion\n    var dateAndTime = customTimestamp.split(' ')[0]; // \"2023-08-18\"\n    var time = customTimestamp.split(' ')[1]; // \"00:02:26\"\n\n    // Construct a date string in ISO format (YYYY-MM-DDTHH:mm:ss)\n    var isoTimestamp = dateAndTime + 'T' + time;\n\n    // Parse the ISO timestamp into a JavaScript Date object\n    var dateUTC = new Date(isoTimestamp).getTime();\n\n    var sn = msg.payload[i].sn\n\n    var fields = [\n        { field: \"value\", value: msg.payload[i].eae, d: \"INV01\", dd: \"Inverter\", f: \"EAE\", fd: \"EAE\", u: \"kwh\" },\n        { field: \"value\", value: msg.payload[i].eae_day, d: \"INV01\", dd: \"Inverter\", f: \"EAE_DAY\", fd: \"EAE_DAY\", u: \"kwh\" },\n        { field: \"value\", value: msg.payload[i].pac, d: \"INV01\", dd: \"Inverter\", f: \"PAC\", fd: \"PAC\", u: \"kw\" },\n        { field: \"value\", value: msg.payload[i].fac, d: \"INV01\", dd: \"Inverter\", f: \"FAC\", fd: \"FAC\", u: \"Hz\" },\n        { field: \"value\", value: msg.payload[i].eai, d: \"INV01\", dd: \"Inverter\", f: \"EAI\", fd: \"EAI\", u: \"kwh\" },\n        { field: \"value\", value: msg.payload[i].em_pac1, d: \"EM01\", dd: \"Meter\", f: \"PAC1\", fd: \"PAC1\", u: \"kw\" },\n        { field: \"value\", value: msg.payload[i].em_pac2, d: \"EM01\", dd: \"Meter\", f: \"PAC2\", fd: \"PAC2\", u: \"kw\" },\n        { field: \"value\", value: msg.payload[i].em_pac3, d: \"EM01\", dd: \"Meter\", f: \"PAC3\", fd: \"PAC3\", u: \"kw\" },\n        { field: \"value\", value: msg.payload[i].load_pac1, d: \"LOAD\", dd: \"load\", f: \"PAC1\", fd: \"PAC1\", u: \"kw\" },\n        { field: \"value\", value: msg.payload[i].load_pac2, d: \"LOAD\", dd: \"load\", f: \"PAC2\", fd: \"PAC2\", u: \"kw\" },\n        { field: \"value\", value: msg.payload[i].load_pac3, d: \"LOAD\", dd: \"load\", f: \"PAC3\", fd: \"PAC3\", u: \"kw\" },\n        { field: \"value\", value: msg.payload[i].grid_pac1, d: \"GRID\", dd: \"grid\", f: \"PAC1\", fd: \"PAC1\", u: \"kw\" },\n        { field: \"value\", value: msg.payload[i].grid_pac2, d: \"GRID\", dd: \"grid\", f: \"PAC2\", fd: \"PAC2\", u: \"kw\" },\n        { field: \"value\", value: msg.payload[i].soc, d: \"BATTERY\", dd: \"battery\", f: \"SOC\", fd: \"SOC\", u: \"%\" },\n    ];\n\n    for (var j = 0; j < fields.length; j++) {\n        var fieldInfo = fields[j];\n\n        var obj = {\n            measurement: \"v\",\n            fields: {\n                value: fieldInfo.value,\n                text: \"0\",\n                qu: \"0\"\n            },\n            tags: {\n                b: \"B01\",\n                bd: \"B01\",\n                d: fieldInfo.d,\n                dd: fieldInfo.dd,\n                dt: \"FoxESS\",\n                f: fieldInfo.f,\n                fd: fieldInfo.fd,\n                h: \"FoxESS\",\n                iid: sn,\n                m: \"1\",\n                p: \"FoxESS\",\n                u: fieldInfo.u\n            },\n            timestamp: dateUTC\n        };\n\n        node.send({ payload: [obj] });\n    }\n}\nreturn null;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1360,
        "y": 380,
        "wires": [
            [
                "f61644024658545d",
                "8af6706e9413f1f3"
            ]
        ]
    },
    {
        "id": "eac5c2ac27dbef24",
        "type": "function",
        "z": "f718a3471b76fac6",
        "name": "function 134",
        "func": "let plantObj\nplantObj = []\n\nfor (var i = 0; i < msg.payload.length; i++) {\n    var sn = msg.payload[i].sn;\n    var timestamp = msg.payload[i].time;\n    var eae_day = msg.payload[i][\"YieldToday/kWh\"];\n    var eae = msg.payload[i][\"YieldTotal/kWh\"];\n    var pac = msg.payload[i][\"InvPower(GenerationPower)/kW\"];\n    var fac = msg.payload[i][\"GridFrequency/V\"];\n    var eai = msg.payload[i][\"InputEnergyTotal/kWh\"];\n    var em_pac1 = msg.payload[i][\"MeterPowerR/kW\"];\n    var em_pac2 = msg.payload[i][\"MeterPowerS/kW\"];\n    var em_pac3 = msg.payload[i][\"MeterPowerT/kW\"];\n    var load_pac1 = msg.payload[i][\"LoadspowerR/kW\"];\n    var load_pac2 = msg.payload[i][\"LoadspowerS/kW\"];\n    var load_pac3 = msg.payload[i][\"LoadspowerT/kW\"];\n    var grid_pac1 = msg.payload[i][\"GridPowerR/kW\"];\n    var grid_pac2 = msg.payload[i][\"GridPowerS/kW\"];\n    var grid_pac3 = msg.payload[i][\"GridPowerT/kW\"];\n    var soc = msg.payload[0][\"SoC/%\"];\n\n\n    var obj1 =\n    {\n        sn,\n        timestamp,\n        eae_day,\n        eae,\n        pac,\n        fac,\n        eai,\n        em_pac1,\n        em_pac2,\n        em_pac3,\n        load_pac1,\n        load_pac2,\n        load_pac3,\n        grid_pac1,\n        grid_pac2,\n        grid_pac3,\n        soc\n\n    }\n    plantObj.push(obj1)\n}\n\nmsg.payload = plantObj\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1190,
        "y": 380,
        "wires": [
            [
                "b0ee12146236348f"
            ]
        ]
    },
    {
        "id": "8af6706e9413f1f3",
        "type": "influxdb batch",
        "z": "f718a3471b76fac6",
        "influxdb": "4a6a4ac55c60a4cc",
        "precision": "",
        "retentionPolicy": "",
        "name": "",
        "database": "database",
        "precisionV18FluxV20": "ms",
        "retentionPolicyV18Flux": "",
        "org": "mgleurope",
        "bucket": "foxess",
        "x": 1630,
        "y": 380,
        "wires": []
    },
    {
        "id": "c77dac7c03d8020e",
        "type": "change",
        "z": "f718a3471b76fac6",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "url",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 710,
        "y": 380,
        "wires": [
            [
                "f7e500157fdf5112"
            ]
        ]
    },
    {
        "id": "87fcc9c13168b9de",
        "type": "debug",
        "z": "f718a3471b76fac6",
        "name": "debug 247",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1070,
        "y": 460,
        "wires": []
    },
    {
        "id": "f61644024658545d",
        "type": "debug",
        "z": "f718a3471b76fac6",
        "name": "debug 245",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1410,
        "y": 460,
        "wires": []
    },
    {
        "id": "7101abf825cd62d6",
        "type": "function",
        "z": "f718a3471b76fac6",
        "name": "Meter API's",
        "func": "/*\n// Array of commands\nvar today = flow.get(\"formattedDate\")\nvar command = [\n    'cd /home/iplon/Documents/Working_Scripts/ && node working_download_url.js 60SH10302AMC062' + ' ' + today + ' ' + today\n];\n\n\n// Set the array of commands as a property of the message\nmsg.payload = command;\n\n// Return the modified message\nreturn msg;\n*/\n\nvar today = flow.get(\"formattedDate\");\nvar command =\n    'cd /home/iplon/Documents/Working_Scripts/ && node working_download_url1.js \"https://www.foxesscloud.com/login\" EzeeEnergy Los1alamos 60SH10302AMC062 ' + today + ' ' + today;\n\n// Set the command as a property of the message\nmsg.payload = command;\n\n// Return the modified message\nreturn msg;\n\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 470,
        "y": 280,
        "wires": [
            [
                "4e1cea961915218d"
            ]
        ]
    },
    {
        "id": "4e1cea961915218d",
        "type": "change",
        "z": "f718a3471b76fac6",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "command",
                "pt": "msg",
                "to": "payload",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 690,
        "y": 280,
        "wires": [
            [
                "548220348cf5b12b"
            ]
        ]
    },
    {
        "id": "d4bad47a5c58bc01",
        "type": "cronplus",
        "z": "f718a3471b76fac6",
        "name": "",
        "outputField": "payload",
        "timeZone": "Asia/Kolkata",
        "persistDynamic": false,
        "commandResponseMsgOutput": "output1",
        "outputs": 1,
        "options": [
            {
                "name": "schedule1",
                "topic": "topic1",
                "payloadType": "default",
                "payload": "",
                "expressionType": "cron",
                "expression": "0 0 23 * * *",
                "location": "",
                "offset": "0",
                "solarType": "all",
                "solarEvents": "sunrise,sunset"
            }
        ],
        "x": 120,
        "y": 280,
        "wires": [
            [
                "2c814ddb7f5d347c"
            ]
        ]
    },
    {
        "id": "2c814ddb7f5d347c",
        "type": "function",
        "z": "f718a3471b76fac6",
        "name": "milli to sec",
        "func": "// Assuming that msg.payload contains the existing timestamp\nconst existingTimestamp = msg.payload.triggerTimestamp;\n\n// Create a Date object from the existing timestamp\nconst existingDate = new Date(existingTimestamp);\n\n// Extract the date in \"YYYY-MM-DD\" format\nconst year = existingDate.getUTCFullYear();\nconst month = String(existingDate.getUTCMonth() + 1).padStart(2, '0'); // Month is 0-indexed\nconst day = String(existingDate.getUTCDate()).padStart(2, '0');\n\nconst formattedDate = `${year}-${month}-${day}`;\n\n// Save the formatted date to the flow context\nflow.set(\"formattedDate\", formattedDate);\n\n// Update the message payload with the formatted date\nmsg.payload.formattedDate = formattedDate;\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 290,
        "y": 280,
        "wires": [
            [
                "7101abf825cd62d6"
            ]
        ]
    },
    {
        "id": "8e8802023a301383",
        "type": "comment",
        "z": "f718a3471b76fac6",
        "name": "60SH10302AMC062",
        "info": "",
        "x": 130,
        "y": 140,
        "wires": []
    },
    {
        "id": "9fe1e0e8f546280c",
        "type": "exec",
        "z": "f718a3471b76fac6",
        "command": "",
        "addpay": "payload",
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "Run Puppeteer Script",
        "x": 940,
        "y": 680,
        "wires": [
            [
                "0017de4b56ebf881"
            ],
            [],
            []
        ]
    },
    {
        "id": "0017de4b56ebf881",
        "type": "function",
        "z": "f718a3471b76fac6",
        "name": "function 135",
        "func": "var url = msg.payload;\nvar parsedValue = url.split(\"Download URL: \")[1];\n\nif (parsedValue) {\n    msg.payload = \"https://www.foxesscloud.com\" + parsedValue;\n} else {\n    // Handle the case where \"Download URL: \" is not found in the input URL.\n    // You can set a default value or handle the error as needed.\n    msg.payload = \"https://www.foxesscloud.com\"; // Default value\n}\n\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 530,
        "y": 780,
        "wires": [
            [
                "8465b7169763f2e4"
            ]
        ]
    },
    {
        "id": "2e57f8960b9d3a34",
        "type": "http request",
        "z": "f718a3471b76fac6",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 890,
        "y": 780,
        "wires": [
            [
                "d2a6c4b32d602e2d"
            ]
        ]
    },
    {
        "id": "d2a6c4b32d602e2d",
        "type": "csv",
        "z": "f718a3471b76fac6",
        "name": "",
        "sep": ",",
        "hdrin": true,
        "hdrout": "none",
        "multi": "mult",
        "ret": "\\n",
        "temp": "",
        "skip": "0",
        "strings": true,
        "include_empty_strings": "",
        "include_null_values": true,
        "x": 1030,
        "y": 780,
        "wires": [
            [
                "e1ee810e4708a7cd",
                "53cef303d002ffcb"
            ]
        ]
    },
    {
        "id": "83af75efa72b10ea",
        "type": "function",
        "z": "f718a3471b76fac6",
        "name": "Influx 2.0",
        "func": "for (var i = 0; i < msg.payload.length; i++) {\n    var customTimestamp = msg.payload[i].timestamp; // Example: \"2023-08-18 00:02:26 CEST+0200\"\n\n    // Extract the date and time portion\n    var dateAndTime = customTimestamp.split(' ')[0]; // \"2023-08-18\"\n    var time = customTimestamp.split(' ')[1]; // \"00:02:26\"\n\n    // Construct a date string in ISO format (YYYY-MM-DDTHH:mm:ss)\n    var isoTimestamp = dateAndTime + 'T' + time;\n\n    // Parse the ISO timestamp into a JavaScript Date object\n    var dateUTC = new Date(isoTimestamp).getTime();\n\n    var sn = msg.payload[i].sn\n\n    var fields = [\n        { field: \"value\", value: msg.payload[i].eae, d: \"INV01\", dd: \"Inverter\", f: \"EAE\", fd: \"EAE\", u: \"kwh\" },\n        { field: \"value\", value: msg.payload[i].eae_day, d: \"INV01\", dd: \"Inverter\", f: \"EAE_DAY\", fd: \"EAE_DAY\", u: \"kwh\" },\n        { field: \"value\", value: msg.payload[i].pac, d: \"INV01\", dd: \"Inverter\", f: \"PAC\", fd: \"PAC\", u: \"kw\" },\n        { field: \"value\", value: msg.payload[i].fac, d: \"INV01\", dd: \"Inverter\", f: \"FAC\", fd: \"FAC\", u: \"Hz\" },\n        { field: \"value\", value: msg.payload[i].eai, d: \"INV01\", dd: \"Inverter\", f: \"EAI\", fd: \"EAI\", u: \"kwh\" },\n        { field: \"value\", value: msg.payload[i].em_pac1, d: \"EM01\", dd: \"Meter\", f: \"PAC1\", fd: \"PAC1\", u: \"kw\" },\n        { field: \"value\", value: msg.payload[i].em_pac2, d: \"EM01\", dd: \"Meter\", f: \"PAC2\", fd: \"PAC2\", u: \"kw\" },\n        { field: \"value\", value: msg.payload[i].em_pac3, d: \"EM01\", dd: \"Meter\", f: \"PAC3\", fd: \"PAC3\", u: \"kw\" },\n        { field: \"value\", value: msg.payload[i].load_pac1, d: \"LOAD\", dd: \"load\", f: \"PAC1\", fd: \"PAC1\", u: \"kw\" },\n        { field: \"value\", value: msg.payload[i].load_pac2, d: \"LOAD\", dd: \"load\", f: \"PAC2\", fd: \"PAC2\", u: \"kw\" },\n        { field: \"value\", value: msg.payload[i].load_pac3, d: \"LOAD\", dd: \"load\", f: \"PAC3\", fd: \"PAC3\", u: \"kw\" },\n        { field: \"value\", value: msg.payload[i].grid_pac1, d: \"GRID\", dd: \"grid\", f: \"PAC1\", fd: \"PAC1\", u: \"kw\" },\n        { field: \"value\", value: msg.payload[i].grid_pac2, d: \"GRID\", dd: \"grid\", f: \"PAC2\", fd: \"PAC2\", u: \"kw\" },\n        { field: \"value\", value: msg.payload[i].soc, d: \"BATTERY\", dd: \"battery\", f: \"SOC\", fd: \"SOC\", u: \"%\" },\n    ];\n\n    for (var j = 0; j < fields.length; j++) {\n        var fieldInfo = fields[j];\n\n        var obj = {\n            measurement: \"v\",\n            fields: {\n                value: fieldInfo.value,\n                text: \"0\",\n                qu: \"0\"\n            },\n            tags: {\n                b: \"B01\",\n                bd: \"B01\",\n                d: fieldInfo.d,\n                dd: fieldInfo.dd,\n                dt: \"FoxESS\",\n                f: fieldInfo.f,\n                fd: fieldInfo.fd,\n                h: \"FoxESS\",\n                iid: sn,\n                m: \"1\",\n                p: \"FoxESS\",\n                u: fieldInfo.u\n            },\n            timestamp: dateUTC\n        };\n\n        node.send({ payload: [obj] });\n    }\n}\nreturn null;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1360,
        "y": 780,
        "wires": [
            [
                "0770a6965b1ae84f",
                "9aecd95350fd48bc"
            ]
        ]
    },
    {
        "id": "53cef303d002ffcb",
        "type": "function",
        "z": "f718a3471b76fac6",
        "name": "function 136",
        "func": "let plantObj\nplantObj = []\n\nfor (var i = 0; i < msg.payload.length; i++) {\n    var sn = msg.payload[i].sn;\n    var timestamp = msg.payload[i].time;\n    var eae_day = msg.payload[i][\"YieldToday/kWh\"];\n    var eae = msg.payload[i][\"YieldTotal/kWh\"];\n    var pac = msg.payload[i][\"InvPower(GenerationPower)/kW\"];\n    var fac = msg.payload[i][\"GridFrequency/V\"];\n    var eai = msg.payload[i][\"InputEnergyTotal/kWh\"];\n    var em_pac1 = msg.payload[i][\"MeterPowerR/kW\"];\n    var em_pac2 = msg.payload[i][\"MeterPowerS/kW\"];\n    var em_pac3 = msg.payload[i][\"MeterPowerT/kW\"];\n    var load_pac1 = msg.payload[i][\"LoadspowerR/kW\"];\n    var load_pac2 = msg.payload[i][\"LoadspowerS/kW\"];\n    var load_pac3 = msg.payload[i][\"LoadspowerT/kW\"];\n    var grid_pac1 = msg.payload[i][\"GridPowerR/kW\"];\n    var grid_pac2 = msg.payload[i][\"GridPowerS/kW\"];\n    var grid_pac3 = msg.payload[i][\"GridPowerT/kW\"];\n    var soc = msg.payload[0][\"SoC/%\"];\n\n\n    var obj1 =\n    {\n        sn,\n        timestamp,\n        eae_day,\n        eae,\n        pac,\n        fac,\n        eai,\n        em_pac1,\n        em_pac2,\n        em_pac3,\n        load_pac1,\n        load_pac2,\n        load_pac3,\n        grid_pac1,\n        grid_pac2,\n        grid_pac3,\n        soc\n\n    }\n    plantObj.push(obj1)\n}\n\nmsg.payload = plantObj\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1190,
        "y": 780,
        "wires": [
            [
                "83af75efa72b10ea"
            ]
        ]
    },
    {
        "id": "9aecd95350fd48bc",
        "type": "influxdb batch",
        "z": "f718a3471b76fac6",
        "influxdb": "4a6a4ac55c60a4cc",
        "precision": "",
        "retentionPolicy": "",
        "name": "",
        "database": "database",
        "precisionV18FluxV20": "ms",
        "retentionPolicyV18Flux": "",
        "org": "mgleurope",
        "bucket": "foxess",
        "x": 1630,
        "y": 780,
        "wires": []
    },
    {
        "id": "8465b7169763f2e4",
        "type": "change",
        "z": "f718a3471b76fac6",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "url",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 710,
        "y": 780,
        "wires": [
            [
                "2e57f8960b9d3a34"
            ]
        ]
    },
    {
        "id": "e1ee810e4708a7cd",
        "type": "debug",
        "z": "f718a3471b76fac6",
        "name": "debug 248",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1070,
        "y": 840,
        "wires": []
    },
    {
        "id": "0770a6965b1ae84f",
        "type": "debug",
        "z": "f718a3471b76fac6",
        "name": "debug 249",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1410,
        "y": 840,
        "wires": []
    },
    {
        "id": "4942d652e641d385",
        "type": "function",
        "z": "f718a3471b76fac6",
        "name": "Meter API's",
        "func": "/*\n// Array of commands\nvar today = flow.get(\"formattedDate\")\nvar command = [\n    'cd /home/iplon/Documents/Working_Scripts/ && node working_download_url.js 60SH10302AMC062' + ' ' + today + ' ' + today\n];\n\n\n// Set the array of commands as a property of the message\nmsg.payload = command;\n\n// Return the modified message\nreturn msg;\n*/\n\nvar today = flow.get(\"formattedDate\");\nvar command =\n    'cd /home/iplon/Documents/Working_Scripts/ && node working_download_url2.js \"https://www.foxesscloud.com/login\" EzeeEnergy Los1alamos 60SH10302C4C198 ' + today + ' ' + today;\n\n// Set the command as a property of the message\nmsg.payload = command;\n\n// Return the modified message\nreturn msg;\n\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 470,
        "y": 680,
        "wires": [
            [
                "8205b6df93f5203b"
            ]
        ]
    },
    {
        "id": "8205b6df93f5203b",
        "type": "change",
        "z": "f718a3471b76fac6",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "command",
                "pt": "msg",
                "to": "payload",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 690,
        "y": 680,
        "wires": [
            [
                "7060cbc5c36d29a2",
                "9fe1e0e8f546280c"
            ]
        ]
    },
    {
        "id": "91b3f315da4606a1",
        "type": "cronplus",
        "z": "f718a3471b76fac6",
        "name": "",
        "outputField": "payload",
        "timeZone": "Asia/Kolkata",
        "persistDynamic": false,
        "commandResponseMsgOutput": "output1",
        "outputs": 1,
        "options": [
            {
                "name": "schedule1",
                "topic": "topic1",
                "payloadType": "default",
                "payload": "",
                "expressionType": "cron",
                "expression": "0 30 23 * * *",
                "location": "",
                "offset": "0",
                "solarType": "all",
                "solarEvents": "sunrise,sunset"
            }
        ],
        "x": 120,
        "y": 680,
        "wires": [
            [
                "458c144e148dee19"
            ]
        ]
    },
    {
        "id": "458c144e148dee19",
        "type": "function",
        "z": "f718a3471b76fac6",
        "name": "milli to sec",
        "func": "// Assuming that msg.payload contains the existing timestamp\nconst existingTimestamp = msg.payload.triggerTimestamp;\n\n// Create a Date object from the existing timestamp\nconst existingDate = new Date(existingTimestamp);\n\n// Extract the date in \"YYYY-MM-DD\" format\nconst year = existingDate.getUTCFullYear();\nconst month = String(existingDate.getUTCMonth() + 1).padStart(2, '0'); // Month is 0-indexed\nconst day = String(existingDate.getUTCDate()).padStart(2, '0');\n\nconst formattedDate = `${year}-${month}-${day}`;\n\n// Save the formatted date to the flow context\nflow.set(\"formattedDate\", formattedDate);\n\n// Update the message payload with the formatted date\nmsg.payload.formattedDate = formattedDate;\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 290,
        "y": 680,
        "wires": [
            [
                "4942d652e641d385"
            ]
        ]
    },
    {
        "id": "7cad1a977d07dcef",
        "type": "comment",
        "z": "f718a3471b76fac6",
        "name": "60SH10302C4C198",
        "info": "",
        "x": 130,
        "y": 480,
        "wires": []
    },
    {
        "id": "7060cbc5c36d29a2",
        "type": "debug",
        "z": "f718a3471b76fac6",
        "name": "debug 250",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 890,
        "y": 620,
        "wires": []
    },
    {
        "id": "59fefbb01a399266",
        "type": "template",
        "z": "f718a3471b76fac6",
        "name": "working download url2",
        "field": "payload",
        "fieldType": "msg",
        "format": "javascript",
        "syntax": "mustache",
        "template": "const puppeteer = require('puppeteer');\nconst fs = require('fs');\n\nasync function getDownloadUrl(url, username, password, sn, startdate, enddate) {\n    const browser = await puppeteer.launch({\n        headless: false,\n        args: ['--disable-web-security'],\n        defaultViewport: null,\n    });\n    const page = await browser.newPage();\n    await page.setViewport({ width: 1200, height: 800 });\n\n    try {\n        await page.goto(url, { waitUntil: 'networkidle0' });\n\n        await page.waitForSelector('input[type=\"text\"]');\n        await page.type('input[type=\"text\"]', username);\n        await page.type('input[type=\"password\"]', password);\n\n        await Promise.all([\n            page.click('button.el-button.login-click.el-button--primary'),\n            page.waitForNavigation({ waitUntil: 'networkidle0' }),\n        ]);\n\n        await page.click(\n            '#app > div > section > aside > div > div.sidebar-container > div.el-scrollbar > div.scrollbar-wrapper.el-scrollbar__wrap > div > ul > div:nth-child(10)'\n        );\n\n        await page.waitForSelector('input[type=\"text\"]');\n        await page.type('input[type=\"text\"]', sn);\n\n        await page.waitForSelector('input[placeholder=\"Start Date\"]');\n        await page.type('input[placeholder=\"Start Date\"]', startdate);\n\n        await page.waitForSelector('input[placeholder=\"End Date\"]');\n        await page.type('input[placeholder=\"End Date\"]', enddate);\n\n        await page.click('button.el-button.el-button--success.el-button--mini');\n\n        const response = await page.waitForResponse((response) => {\n            return response.url().includes('https://www.foxesscloud.com/c/v0/device/report/query');\n        }, { timeout: 60000 });\n\n        const responseData = await response.json();\n        const downloadUrl = responseData.result.downloadUrl;\n\n        return downloadUrl; // Resolve the Promise with the download URL\n    } finally {\n        await browser.close();\n    }\n}\n\n(async () => {\n    const url = process.argv[2];\n    const username = process.argv[3];\n    const password = process.argv[4];\n    const sn = process.argv[5];\n    const startdate = process.argv[6];\n    const enddate = process.argv[7];\n\n    try {\n        const downloadUrl = await getDownloadUrl(url, username, password, sn, startdate, enddate);\n        if (downloadUrl) {\n            console.log('Download URL: ' + downloadUrl);\n        } else {\n            console.log('Download URL not found in response.');\n        }\n    } catch (error) {\n        console.error('Error: ' + error);\n    }\n})();\n",
        "output": "str",
        "x": 320,
        "y": 540,
        "wires": [
            [
                "e0df11a0f5a988f3"
            ]
        ]
    },
    {
        "id": "e0df11a0f5a988f3",
        "type": "file",
        "z": "f718a3471b76fac6",
        "name": "path",
        "filename": "/home/iplon/Documents/Working_Scripts/working_download_url2.js",
        "filenameType": "str",
        "appendNewline": true,
        "createDir": false,
        "overwriteFile": "true",
        "encoding": "none",
        "x": 510,
        "y": 540,
        "wires": [
            [
                "a5d18328261a285b"
            ]
        ]
    },
    {
        "id": "b0b985fb4124c74a",
        "type": "inject",
        "z": "f718a3471b76fac6",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 120,
        "y": 540,
        "wires": [
            [
                "59fefbb01a399266"
            ]
        ]
    },
    {
        "id": "a5d18328261a285b",
        "type": "debug",
        "z": "f718a3471b76fac6",
        "name": "debug 251",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 670,
        "y": 540,
        "wires": []
    },
    {
        "id": "f76d0c56.8a8a7",
        "type": "inject",
        "z": "17c2d49957000dc0",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 200,
        "y": 340,
        "wires": [
            [
                "6ad53017eb43216a"
            ]
        ]
    },
    {
        "id": "b8daa3b4.e34e88",
        "type": "exec",
        "z": "17c2d49957000dc0",
        "command": "node foxess.js \"https://www.foxesscloud.com/login\" EzeeEnergy Los1alamos 60SH10302AMC062 2023-09-17 2023-09-17",
        "addpay": "payload",
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "Run Puppeteer Script",
        "x": 720,
        "y": 200,
        "wires": [
            [
                "92e6381ffd5840be"
            ],
            [
                "debfe9d130631c13"
            ],
            []
        ]
    },
    {
        "id": "ebecf618.5d3e48",
        "type": "debug",
        "z": "17c2d49957000dc0",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 910,
        "y": 120,
        "wires": []
    },
    {
        "id": "6ccbc60430bc35af",
        "type": "template",
        "z": "17c2d49957000dc0",
        "name": "",
        "field": "payload",
        "fieldType": "msg",
        "format": "javascript",
        "syntax": "mustache",
        "template": "const puppeteer = require('puppeteer');\nconst fs = require('fs');\n\n(async () => {\n    // Get the username, password, URL, and output file location from command line arguments\n    const url = msg.payload.url;\n    const username = msg.payload.username;\n    const password = msg.payload.password;\n    const sn = msg.payload.sn;\n    const startdate = msg.payload.startdate;\n    const enddate = msg.payload.enddate;\n    //const outputFilePath = process.argv[8];\n\n    // Set up the browser\n    //const browser = await puppeteer.launch({headless: false});\n    const browser = await puppeteer.launch({\n        headless: false,\n        args: ['--disable-web-security'], // Use this argument to disable CORS restrictions\n        defaultViewport: null, // Set the viewport to null\n        // Add other options as needed\n    });\n    const page = await browser.newPage();\n    await page.setViewport({ width: 1200, height: 800 });\n\n    // Navigate to the Grafana login page\n    await page.goto(url, { waitUntil: 'networkidle0' });\n\n    // Wait for the login page to load and enter the credentials\n    await page.waitForSelector('input[type=\"text\"]');\n    await page.type('input[type=\"text\"]', username);\n    await page.type('input[type=\"password\"]', password);\n\n    // Click the login button and wait for the dashboard page to load\n    await Promise.all([\n        page.click('button.el-button.login-click.el-button--primary'),\n        page.waitForNavigation({ waitUntil: 'networkidle0' })\n    ]);\n\n    // Wait for the dropdown options to appear\n    //await page.waitForSelector('li.el-menu-item.is-active');\n\n    // Click the dropdown menu to open it\n    await page.click('#app > div > section > aside > div > div.sidebar-container > div.el-scrollbar > div.scrollbar-wrapper.el-scrollbar__wrap > div > ul > div:nth-child(10)');\n\n    await page.waitForSelector('input[type=\"text\"]');\n    await page.type('input[type=\"text\"]', sn);\n\n    await page.waitForSelector('input[placeholder=\"Start Date\"]');\n    await page.type('input[placeholder=\"Start Date\"]', startdate);\n\n    await page.waitForSelector('input[placeholder=\"End Date\"]');\n    await page.type('input[placeholder=\"End Date\"]', enddate);\n\n    await page.click('button.el-button.el-button--success.el-button--mini');\n\n    try {\n        // Wait for the response from the query\n        const response = await page.waitForResponse(response => {\n            return response.url().includes('https://www.foxesscloud.com/c/v0/device/report/query');\n        }, { timeout: 60000 }); // Adjust timeout as needed\n\n        // Parse the response JSON\n        const responseData = await response.json();\n\n        // Extract the download URL from the response\n        const downloadUrl = responseData.result.downloadUrl;\n\n        if (downloadUrl) {\n            process.stdout.write('Download URL: ' + downloadUrl + '\\n');\n\n            // Use the download URL to initiate the file download\n            await page.goto(`https://www.foxesscloud.com${downloadUrl}`);\n            console.log('Download initiated.');\n        } else {\n            console.log('Download URL not found in response.');\n        }\n    } catch (error) {\n        process.stderr.write('Error: ' + error + '\\n');\n    }\n\n    // Close the browser\n    //await browser.close();\n})();\n",
        "output": "str",
        "x": 360,
        "y": 200,
        "wires": [
            [
                "5358e7c921ca0e07"
            ]
        ]
    },
    {
        "id": "5358e7c921ca0e07",
        "type": "file",
        "z": "17c2d49957000dc0",
        "name": "",
        "filename": "foxess.js",
        "filenameType": "str",
        "appendNewline": true,
        "createDir": false,
        "overwriteFile": "true",
        "encoding": "none",
        "x": 520,
        "y": 200,
        "wires": [
            [
                "bd7decc38fc68102"
            ]
        ]
    },
    {
        "id": "debfe9d130631c13",
        "type": "debug",
        "z": "17c2d49957000dc0",
        "name": "debug 231",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 770,
        "y": 300,
        "wires": []
    },
    {
        "id": "86f919b783560aa6",
        "type": "function",
        "z": "17c2d49957000dc0",
        "name": "function 130",
        "func": "/*\n// Assuming msg.payload contains the output from the exec node\nconst scriptOutput = msg.payload.toString(); // Convert output to string\n\n// Use regular expressions to extract the download URL\nconst downloadUrlRegex = /Download URL: (.+)/;\nconst match = scriptOutput.match(downloadUrlRegex);\n\nif (match && match[1]) {\n    msg.downloadUrl = match[1]; // Store the download URL in msg.downloadUrl\n} else {\n    msg.downloadUrl = 'Download URL not found in output.';\n}\n*/\nvar downloadUrl = msg.downloadUrl;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 770,
        "y": 120,
        "wires": [
            [
                "ebecf618.5d3e48"
            ]
        ]
    },
    {
        "id": "92e6381ffd5840be",
        "type": "debug",
        "z": "17c2d49957000dc0",
        "name": "debug 233",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 930,
        "y": 200,
        "wires": []
    },
    {
        "id": "5676ee3cf4e9c938",
        "type": "inject",
        "z": "17c2d49957000dc0",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 280,
        "y": 440,
        "wires": [
            [
                "4c0b63a4db223164"
            ]
        ]
    },
    {
        "id": "4c0b63a4db223164",
        "type": "exec",
        "z": "17c2d49957000dc0",
        "command": "node foxess.js \"https://www.foxesscloud.com/login\" EzeeEnergy Los1alamos 60SH10302AMC062 2023-09-17 2023-09-17",
        "addpay": "payload",
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "Run Puppeteer Script",
        "x": 487,
        "y": 438,
        "wires": [
            [
                "feb0f2c6c1f4b325"
            ],
            [
                "966c818114c62261"
            ],
            [
                "cdac8d3010242492"
            ]
        ]
    },
    {
        "id": "e00c066cd87cae29",
        "type": "function",
        "z": "17c2d49957000dc0",
        "name": "function 131",
        "func": "// Extract the download URL from the script's output\nconst output = msg.payload;\nconst downloadUrlMatch = output.match(/Download URL: (.+)/);\n\nif (downloadUrlMatch && downloadUrlMatch[1]) {\n    // If a download URL is found, store it in msg.payload\n    msg.payload = downloadUrlMatch[1];\n    node.status({ text: 'Download URL found' });\n} else {\n    // If no download URL is found, set an error message\n    msg.payload = 'Download URL not found.';\n    node.status({ text: 'Download URL not found' });\n}\n\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 770,
        "y": 380,
        "wires": [
            [
                "bace89329e7df4de"
            ]
        ]
    },
    {
        "id": "bace89329e7df4de",
        "type": "debug",
        "z": "17c2d49957000dc0",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 890,
        "y": 440,
        "wires": []
    },
    {
        "id": "feb0f2c6c1f4b325",
        "type": "debug",
        "z": "17c2d49957000dc0",
        "name": "debug 234",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 730,
        "y": 480,
        "wires": []
    },
    {
        "id": "966c818114c62261",
        "type": "debug",
        "z": "17c2d49957000dc0",
        "name": "debug 235",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 723,
        "y": 534,
        "wires": []
    },
    {
        "id": "cdac8d3010242492",
        "type": "debug",
        "z": "17c2d49957000dc0",
        "name": "debug 236",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 710,
        "y": 600,
        "wires": []
    },
    {
        "id": "6ad53017eb43216a",
        "type": "function",
        "z": "17c2d49957000dc0",
        "name": "function 132",
        "func": "const puppeteer = require('puppeteer');\nconst fs = require('fs');\n\n(async () => {\n    // Get the username, password, URL, and output file location from command line arguments\n    const url = process.argv[2];\n    const username = process.argv[3];\n    const password = process.argv[4];\n    const sn = process.argv[5];\n    const startdate = process.argv[6];\n    const enddate = process.argv[7];\n    //const outputFilePath = process.argv[8];\n\n    // Set up the browser\n    //const browser = await puppeteer.launch({headless: false});\n    const browser = await puppeteer.launch({\n        headless: false,\n        args: ['--disable-web-security'], // Use this argument to disable CORS restrictions\n        defaultViewport: null, // Set the viewport to null\n        // Add other options as needed\n    });\n    const page = await browser.newPage();\n    await page.setViewport({ width: 1200, height: 800 });\n\n    // Navigate to the Grafana login page\n    await page.goto(url, { waitUntil: 'networkidle0' });\n\n    // Wait for the login page to load and enter the credentials\n    await page.waitForSelector('input[type=\"text\"]');\n    await page.type('input[type=\"text\"]', username);\n    await page.type('input[type=\"password\"]', password);\n\n    // Click the login button and wait for the dashboard page to load\n    await Promise.all([\n        page.click('button.el-button.login-click.el-button--primary'),\n        page.waitForNavigation({ waitUntil: 'networkidle0' })\n    ]);\n\n    // Wait for the dropdown options to appear\n    //await page.waitForSelector('li.el-menu-item.is-active');\n\n    // Click the dropdown menu to open it\n    await page.click('#app > div > section > aside > div > div.sidebar-container > div.el-scrollbar > div.scrollbar-wrapper.el-scrollbar__wrap > div > ul > div:nth-child(10)');\n\n    await page.waitForSelector('input[type=\"text\"]');\n    await page.type('input[type=\"text\"]', sn);\n\n    await page.waitForSelector('input[placeholder=\"Start Date\"]');\n    await page.type('input[placeholder=\"Start Date\"]', startdate);\n\n    await page.waitForSelector('input[placeholder=\"End Date\"]');\n    await page.type('input[placeholder=\"End Date\"]', enddate);\n\n    await page.click('button.el-button.el-button--success.el-button--mini');\n\n    try {\n        // Wait for the response from the query\n        const response = await page.waitForResponse(response => {\n            return response.url().includes('https://www.foxesscloud.com/c/v0/device/report/query');\n        }, { timeout: 60000 }); // Adjust timeout as needed\n\n        // Parse the response JSON\n        const responseData = await response.json();\n\n        // Extract the download URL from the response\n        const downloadUrl = responseData.result.downloadUrl;\n\n        if (downloadUrl) {\n            process.stdout.write('Download URL: ' + downloadUrl + '\\n');\n\n            // Use the download URL to initiate the file download\n            await page.goto(`https://www.foxesscloud.com${downloadUrl}`);\n            console.log('Download initiated.');\n        } else {\n            console.log('Download URL not found in response.');\n        }\n    } catch (error) {\n        process.stderr.write('Error: ' + error + '\\n');\n    }\n\n    // Close the browser\n    //await browser.close();\n})();\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 390,
        "y": 340,
        "wires": [
            []
        ]
    },
    {
        "id": "f757df3a7c1ae398",
        "type": "inject",
        "z": "17c2d49957000dc0",
        "name": "",
        "props": [
            {
                "p": "payload.url",
                "v": "https://www.foxesscloud.com/login",
                "vt": "str"
            },
            {
                "p": "payload.username",
                "v": "EzeeEnergy",
                "vt": "str"
            },
            {
                "p": "payload.password",
                "v": "Los1alamos",
                "vt": "str"
            },
            {
                "p": "payload.sn",
                "v": "60SH10302AMC062",
                "vt": "str"
            },
            {
                "p": "payload.startdate",
                "v": "2023-09-17",
                "vt": "str"
            },
            {
                "p": "payload.enddate",
                "v": "2023-09-17",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 190,
        "y": 200,
        "wires": [
            []
        ]
    },
    {
        "id": "bd7decc38fc68102",
        "type": "debug",
        "z": "17c2d49957000dc0",
        "name": "debug 237",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 490,
        "y": 260,
        "wires": []
    },
    {
        "id": "e9373294a0696df4",
        "type": "template",
        "z": "17c2d49957000dc0",
        "name": "",
        "field": "payload",
        "fieldType": "msg",
        "format": "javascript",
        "syntax": "mustache",
        "template": "const puppeteer = require('puppeteer');\nconst fs = require('fs');\nconst { NodeRedDebugOutput } = require('node-red-node-serialport'); // Import the Node-RED debug output module\n\n(async () => {\n  // Get the username, password, URL, and output file location from command line arguments\n  const url = process.argv[2];\n  const username = process.argv[3];\n  const password = process.argv[4];\n  const sn = process.argv[5];\n  const startdate = process.argv[6];\n  const enddate = process.argv[7];\n  //const outputFilePath = process.argv[8];\n\n  // Set up the browser\n  //const browser = await puppeteer.launch({headless: false});\n  const browser = await puppeteer.launch({\n  headless: false,\n  args: ['--disable-web-security'], // Use this argument to disable CORS restrictions\n  defaultViewport: null, // Set the viewport to null\n  // Add other options as needed\n});\n  const page = await browser.newPage();\n  await page.setViewport({ width: 1200, height: 800 });\n\n  // Navigate to the Grafana login page\n  await page.goto(url, { waitUntil: 'networkidle0' });\n\n  // Wait for the login page to load and enter the credentials\n  await page.waitForSelector('input[type=\"text\"]');\n  await page.type('input[type=\"text\"]', username);\n  await page.type('input[type=\"password\"]', password);\n\n  // Click the login button and wait for the dashboard page to load\n  await Promise.all([\n    page.click('button.el-button.login-click.el-button--primary'),\n    page.waitForNavigation({ waitUntil: 'networkidle0' })\n  ]);\n\n  // Wait for the dropdown options to appear\n  //await page.waitForSelector('li.el-menu-item.is-active');\n\n  // Click the dropdown menu to open it\n  await page.click('#app > div > section > aside > div > div.sidebar-container > div.el-scrollbar > div.scrollbar-wrapper.el-scrollbar__wrap > div > ul > div:nth-child(10)');\n  \n  await page.waitForSelector('input[type=\"text\"]');\n  await page.type('input[type=\"text\"]', sn);\n  \n  await page.waitForSelector('input[placeholder=\"Start Date\"]');\n  await page.type('input[placeholder=\"Start Date\"]', startdate);\n  \n  await page.waitForSelector('input[placeholder=\"End Date\"]');\n  await page.type('input[placeholder=\"End Date\"]', enddate);\n  \n  await page.click('button.el-button.el-button--success.el-button--mini');\n  \n  try {\n  // Wait for the response from the query\n  const response = await page.waitForResponse(response => {\n    return response.url().includes('https://www.foxesscloud.com/c/v0/device/report/query');\n  }, { timeout: 60000 }); // Adjust timeout as needed\n\n  // Parse the response JSON\n  const responseData = await response.json();\n  \n  // Extract the download URL from the response\n  const downloadUrl = responseData.result.downloadUrl;\n\n  if (downloadUrl) {\n    console.log('Download URL:', downloadUrl);\n\n    // Use the download URL to initiate the file download\n    await page.goto(`https://www.foxesscloud.com${downloadUrl}`);\n    console.log('Download initiated.');\n\n    // Create a message object to send to the Node-RED debug window\n    const msg = {\n      payload: 'Download URL: ' + downloadUrl,\n    };\n\n    // Send the message to the Node-RED debug window\n    NodeRedDebugOutput.send(msg);\n\n  } else {\n    console.log('Download URL not found in response.');\n  }\n} catch (error) {\n  console.error('Error:', error);\n\n    // Create an error message object to send to the Node-RED debug window\n    const errorMsg = {\n      payload: 'Error: ' + error.message,\n      error: true,\n    };\n\n    // Send the error message to the Node-RED debug window\n    NodeRedDebugOutput.send(errorMsg);\n}\n\n  // Close the browser\n  //await browser.close();\n})();\n",
        "output": "str",
        "x": 320,
        "y": 640,
        "wires": [
            [
                "e9070d8ef6691e70"
            ]
        ]
    },
    {
        "id": "f206a10b9c5e1330",
        "type": "inject",
        "z": "17c2d49957000dc0",
        "name": "",
        "props": [
            {
                "p": "payload.url",
                "v": "https://www.foxesscloud.com/login",
                "vt": "str"
            },
            {
                "p": "payload.username",
                "v": "EzeeEnergy",
                "vt": "str"
            },
            {
                "p": "payload.password",
                "v": "Los1alamos",
                "vt": "str"
            },
            {
                "p": "payload.sn",
                "v": "60SH10302AMC062",
                "vt": "str"
            },
            {
                "p": "payload.startdate",
                "v": "2023-09-17",
                "vt": "str"
            },
            {
                "p": "payload.enddate",
                "v": "2023-09-17",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 150,
        "y": 640,
        "wires": [
            [
                "e9373294a0696df4"
            ]
        ]
    },
    {
        "id": "e9070d8ef6691e70",
        "type": "file",
        "z": "17c2d49957000dc0",
        "name": "path",
        "filename": "/home/iplon/.node-red/node_modules/@serialport/foxesscloud.js",
        "filenameType": "str",
        "appendNewline": true,
        "createDir": false,
        "overwriteFile": "true",
        "encoding": "none",
        "x": 470,
        "y": 640,
        "wires": [
            [
                "f9260a13665a98b9"
            ]
        ]
    },
    {
        "id": "f9260a13665a98b9",
        "type": "debug",
        "z": "17c2d49957000dc0",
        "name": "debug 238",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 690,
        "y": 640,
        "wires": []
    },
    {
        "id": "94555885abfaad17",
        "type": "inject",
        "z": "17c2d49957000dc0",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 160,
        "y": 720,
        "wires": [
            [
                "5ce238fa1c886f63"
            ]
        ]
    },
    {
        "id": "5ce238fa1c886f63",
        "type": "exec",
        "z": "17c2d49957000dc0",
        "command": "cd /home/iplon/.node-red/node_modules/@serialport/ && node foxesscloud.js \"https://www.foxesscloud.com/login\" \"EzeeEnergy\" \"Los1alamos\" \"60SH10302AMC062\" \"2023-09-17\" \"2023-09-17\"",
        "addpay": "payload",
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "Run Puppeteer Script",
        "x": 367,
        "y": 718,
        "wires": [
            [
                "446dbe1179828f84"
            ],
            [
                "80405eadd7d1a240"
            ],
            []
        ]
    },
    {
        "id": "446dbe1179828f84",
        "type": "debug",
        "z": "17c2d49957000dc0",
        "name": "debug 239",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 590,
        "y": 700,
        "wires": []
    },
    {
        "id": "80405eadd7d1a240",
        "type": "debug",
        "z": "17c2d49957000dc0",
        "name": "debug 240",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 590,
        "y": 760,
        "wires": []
    },
    {
        "id": "8e138e4966e2033b",
        "type": "inject",
        "z": "17c2d49957000dc0",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 260,
        "y": 900,
        "wires": [
            [
                "88d5637fc2922881"
            ]
        ]
    },
    {
        "id": "88d5637fc2922881",
        "type": "exec",
        "z": "17c2d49957000dc0",
        "command": "cd /home/iplon/Documents/Working_Scripts/ && node automate_downloadcsv_foxess.js \"https://www.foxesscloud.com/login\" EzeeEnergy Los1alamos 60SH10302AMC062 2023-09-17 2023-09-17",
        "addpay": "payload",
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "Run Puppeteer Script",
        "x": 467,
        "y": 898,
        "wires": [
            [
                "1da1bd9ebdb95f3b"
            ],
            [
                "194b36d1c7a23cae"
            ],
            []
        ]
    },
    {
        "id": "194b36d1c7a23cae",
        "type": "debug",
        "z": "17c2d49957000dc0",
        "name": "debug 242",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 730,
        "y": 960,
        "wires": []
    },
    {
        "id": "1da1bd9ebdb95f3b",
        "type": "debug",
        "z": "17c2d49957000dc0",
        "name": "debug 241",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 730,
        "y": 880,
        "wires": []
    },
    {
        "id": "05973569cd88f10c",
        "type": "inject",
        "z": "17c2d49957000dc0",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 580,
        "y": 140,
        "wires": [
            [
                "b8daa3b4.e34e88"
            ]
        ]
    },
    {
        "id": "cddb490ba8264900",
        "type": "inject",
        "z": "17c2d49957000dc0",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 220,
        "y": 140,
        "wires": [
            [
                "6ccbc60430bc35af"
            ]
        ]
    },
    {
        "id": "19cadffce3f2e8a0",
        "type": "comment",
        "z": "17c2d49957000dc0",
        "name": "foxess testing",
        "info": "",
        "x": 190,
        "y": 1040,
        "wires": []
    },
    {
        "id": "dc819193fdafdfe9",
        "type": "http request",
        "z": "17c2d49957000dc0",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 330,
        "y": 1380,
        "wires": [
            [
                "c68b707651b733b9"
            ]
        ]
    },
    {
        "id": "c68b707651b733b9",
        "type": "csv",
        "z": "17c2d49957000dc0",
        "name": "",
        "sep": ",",
        "hdrin": true,
        "hdrout": "none",
        "multi": "mult",
        "ret": "\\n",
        "temp": "",
        "skip": "0",
        "strings": true,
        "include_empty_strings": "",
        "include_null_values": true,
        "x": 490,
        "y": 1380,
        "wires": [
            [
                "6779723f17d261b6"
            ]
        ]
    },
    {
        "id": "9ecef1ccc50dfac2",
        "type": "function",
        "z": "17c2d49957000dc0",
        "name": "Influx 2.0",
        "func": "for (var i = 0; i < msg.payload.length; i++) {\n    var customTimestamp = msg.payload[i].timestamp; // Example: \"2023-08-18 00:02:26 CEST+0200\"\n\n    // Extract the date and time portion\n    var dateAndTime = customTimestamp.split(' ')[0]; // \"2023-08-18\"\n    var time = customTimestamp.split(' ')[1]; // \"00:02:26\"\n\n    // Construct a date string in ISO format (YYYY-MM-DDTHH:mm:ss)\n    var isoTimestamp = dateAndTime + 'T' + time;\n\n    // Parse the ISO timestamp into a JavaScript Date object\n    var dateUTC = new Date(isoTimestamp).getTime();\n\n    var sn = msg.payload[i].sn\n\n    var fields = [\n        { field: \"value\", value: msg.payload[i].eae, d: \"INV01\", dd: \"Inverter\", f: \"EAE\", fd: \"EAE\", u: \"kwh\" },\n        { field: \"value\", value: msg.payload[i].eae_day, d: \"INV01\", dd: \"Inverter\", f: \"EAE_DAY\", fd: \"EAE_DAY\", u: \"kwh\" },\n        { field: \"value\", value: msg.payload[i].pac, d: \"INV01\", dd: \"Inverter\", f: \"PAC\", fd: \"PAC\", u: \"kw\" },\n        { field: \"value\", value: msg.payload[i].fac, d: \"INV01\", dd: \"Inverter\", f: \"FAC\", fd: \"FAC\", u: \"Hz\" },\n        { field: \"value\", value: msg.payload[i].eai, d: \"INV01\", dd: \"Inverter\", f: \"EAI\", fd: \"EAI\", u: \"kwh\" },\n        { field: \"value\", value: msg.payload[i].em_pac1, d: \"EM01\", dd: \"Meter\", f: \"PAC1\", fd: \"PAC1\", u: \"kw\" },\n        { field: \"value\", value: msg.payload[i].em_pac2, d: \"EM01\", dd: \"Meter\", f: \"PAC2\", fd: \"PAC2\", u: \"kw\" },\n        { field: \"value\", value: msg.payload[i].em_pac3, d: \"EM01\", dd: \"Meter\", f: \"PAC3\", fd: \"PAC3\", u: \"kw\" },\n        { field: \"value\", value: msg.payload[i].load_pac1, d: \"LOAD\", dd: \"load\", f: \"PAC1\", fd: \"PAC1\", u: \"kw\" },\n        { field: \"value\", value: msg.payload[i].load_pac2, d: \"LOAD\", dd: \"load\", f: \"PAC2\", fd: \"PAC2\", u: \"kw\" },\n        { field: \"value\", value: msg.payload[i].load_pac3, d: \"LOAD\", dd: \"load\", f: \"PAC3\", fd: \"PAC3\", u: \"kw\" },\n        { field: \"value\", value: msg.payload[i].grid_pac1, d: \"GRID\", dd: \"grid\", f: \"PAC1\", fd: \"PAC1\", u: \"kw\" },\n        { field: \"value\", value: msg.payload[i].grid_pac2, d: \"GRID\", dd: \"grid\", f: \"PAC2\", fd: \"PAC2\", u: \"kw\" },\n        { field: \"value\", value: msg.payload[i].soc, d: \"BATTERY\", dd: \"battery\", f: \"SOC\", fd: \"SOC\", u: \"%\" },\n    ];\n\n    for (var j = 0; j < fields.length; j++) {\n        var fieldInfo = fields[j];\n\n        var obj = {\n            measurement: \"v\",\n            fields: {\n                value: fieldInfo.value,\n                text: \"0\",\n                qu: \"0\"\n            },\n            tags: {\n                b: \"B01\",\n                bd: \"B01\",\n                d: fieldInfo.d,\n                dd: fieldInfo.dd,\n                dt: \"FoxESS\",\n                f: fieldInfo.f,\n                fd: fieldInfo.fd,\n                h: \"FoxESS\",\n                iid: sn,\n                m: \"1\",\n                p: \"FoxESS\",\n                u: fieldInfo.u\n            },\n            timestamp: dateUTC\n        };\n\n        node.send({ payload: [obj] });\n    }\n}\nreturn null;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 820,
        "y": 1380,
        "wires": [
            [
                "d92fa5484e07857f"
            ]
        ]
    },
    {
        "id": "f208f0db0c88c3d7",
        "type": "function",
        "z": "17c2d49957000dc0",
        "name": "function 120",
        "func": "let plantObj\nplantObj = []\n\nfor (var i = 0; i < msg.payload.length; i++) {\n    var sn = msg.payload[i].sn;\n    var timestamp = msg.payload[i].time;\n    var eae_day = msg.payload[i][\"YieldToday/kWh\"];\n    var eae = msg.payload[i][\"YieldTotal/kWh\"];\n    var pac = msg.payload[i][\"InvPower(GenerationPower)/kW\"];\n    var fac = msg.payload[i][\"GridFrequency/V\"];\n    var eai = msg.payload[i][\"InputEnergyTotal/kWh\"];\n    var em_pac1 = msg.payload[i][\"MeterPowerR/kW\"];\n    var em_pac2 = msg.payload[i][\"MeterPowerS/kW\"];\n    var em_pac3 = msg.payload[i][\"MeterPowerT/kW\"];\n    var load_pac1 = msg.payload[i][\"LoadspowerR/kW\"];\n    var load_pac2 = msg.payload[i][\"LoadspowerS/kW\"];\n    var load_pac3 = msg.payload[i][\"LoadspowerT/kW\"];\n    var grid_pac1 = msg.payload[i][\"GridPowerR/kW\"];\n    var grid_pac2 = msg.payload[i][\"GridPowerS/kW\"];\n    var grid_pac3 = msg.payload[i][\"GridPowerT/kW\"];\n    var soc = msg.payload[0][\"SoC/%\"];\n\n\n    var obj1 =\n    {\n        sn,\n        timestamp,\n        eae_day,\n        eae,\n        pac,\n        fac,\n        eai,\n        em_pac1,\n        em_pac2,\n        em_pac3,\n        load_pac1,\n        load_pac2,\n        load_pac3,\n        grid_pac1,\n        grid_pac2,\n        grid_pac3,\n        soc\n\n    }\n    plantObj.push(obj1)\n}\n\nmsg.payload = plantObj\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 650,
        "y": 1380,
        "wires": [
            [
                "9ecef1ccc50dfac2"
            ]
        ]
    },
    {
        "id": "43c388d56ecf7999",
        "type": "influxdb batch",
        "z": "17c2d49957000dc0",
        "influxdb": "4a6a4ac55c60a4cc",
        "precision": "",
        "retentionPolicy": "",
        "name": "",
        "database": "database",
        "precisionV18FluxV20": "ms",
        "retentionPolicyV18Flux": "",
        "org": "mgleurope",
        "bucket": "foxess",
        "x": 1090,
        "y": 1380,
        "wires": []
    },
    {
        "id": "d92fa5484e07857f",
        "type": "debug",
        "z": "17c2d49957000dc0",
        "name": "debug 203",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 950,
        "y": 1440,
        "wires": []
    },
    {
        "id": "6779723f17d261b6",
        "type": "debug",
        "z": "17c2d49957000dc0",
        "name": "debug 204",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 590,
        "y": 1460,
        "wires": []
    },
    {
        "id": "5c976da1f415735f",
        "type": "comment",
        "z": "17c2d49957000dc0",
        "name": "Foxess data fetching",
        "info": "",
        "x": 150,
        "y": 1320,
        "wires": []
    },
    {
        "id": "515870d5dee8e429",
        "type": "function",
        "z": "17c2d49957000dc0",
        "name": "Meter API's",
        "func": "// Array of commands\nvar commands = [\n    'cd /home/iplon/Documents/Working_Scripts/ && node downloadurl_foxess.js 60SH10302AMC062 2023-09-14 2023-09-14',\n    'cd /home/iplon/Documents/Working_Scripts/ && node downloadurl_foxess.js 60SH10302AMC062 2023-09-13 2023-09-13',\n    'cd /home/iplon/Documents/Working_Scripts/ && node downloadurl_foxess.js 60SH10302AMC062 2023-09-12 2023-09-12',\n];\n\n// Set the array of commands as a property of the message\nmsg.payload = commands;\n\n// Return the modified message\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 250,
        "y": 1120,
        "wires": [
            [
                "44292f9991cbe5cd"
            ]
        ]
    },
    {
        "id": "44292f9991cbe5cd",
        "type": "split",
        "z": "17c2d49957000dc0",
        "name": "",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 410,
        "y": 1120,
        "wires": [
            [
                "3380a3a00bab2f2e"
            ]
        ]
    },
    {
        "id": "ce66b64a8be5b5eb",
        "type": "change",
        "z": "17c2d49957000dc0",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "url",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 370,
        "y": 1300,
        "wires": [
            [
                "dc819193fdafdfe9"
            ]
        ]
    },
    {
        "id": "0521cdf530c08bf2",
        "type": "inject",
        "z": "17c2d49957000dc0",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 160,
        "y": 1220,
        "wires": [
            [
                "6bfe789fc816f5b5"
            ]
        ]
    },
    {
        "id": "6bfe789fc816f5b5",
        "type": "exec",
        "z": "17c2d49957000dc0",
        "command": "cd /home/iplon/Documents/Working_Scripts/ && node downloadurl_foxess.js",
        "addpay": "payload",
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "Run Puppeteer Script",
        "x": 347,
        "y": 1218,
        "wires": [
            [
                "0c3b533a199e9681"
            ],
            [
                "8737439836afa555"
            ],
            []
        ]
    },
    {
        "id": "8737439836afa555",
        "type": "debug",
        "z": "17c2d49957000dc0",
        "name": "debug 243",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 610,
        "y": 1300,
        "wires": []
    },
    {
        "id": "0c3b533a199e9681",
        "type": "debug",
        "z": "17c2d49957000dc0",
        "name": "debug 244",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 610,
        "y": 1200,
        "wires": []
    },
    {
        "id": "3380a3a00bab2f2e",
        "type": "change",
        "z": "17c2d49957000dc0",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "command",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 590,
        "y": 1120,
        "wires": [
            []
        ]
    },
    {
        "id": "84206d07a6bd2575",
        "type": "inject",
        "z": "17c2d49957000dc0",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 140,
        "y": 1380,
        "wires": [
            []
        ]
    },
    {
        "id": "4262ac604f1896cd",
        "type": "comment",
        "z": "b880533a6a0c82df",
        "name": "data scraping of kongu",
        "info": "",
        "x": 200,
        "y": 120,
        "wires": []
    },
    {
        "id": "baf9557df1e642d0",
        "type": "inject",
        "z": "b880533a6a0c82df",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 180,
        "y": 200,
        "wires": [
            [
                "4aa743ac457e9e03"
            ]
        ]
    },
    {
        "id": "4aa743ac457e9e03",
        "type": "http request",
        "z": "b880533a6a0c82df",
        "name": "URL",
        "method": "GET",
        "ret": "bin",
        "paytoqs": "ignore",
        "url": "https://pin-code.org.in/companies/sector/textiles/tamil-nadu/coimbatore/page:1",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 330,
        "y": 200,
        "wires": [
            [
                "aa89df7633405577"
            ]
        ]
    },
    {
        "id": "aa89df7633405577",
        "type": "html",
        "z": "b880533a6a0c82df",
        "name": "",
        "property": "payload",
        "outproperty": "payload",
        "tag": "div.row.addressWrap.mt-2",
        "ret": "text",
        "as": "single",
        "x": 570,
        "y": 200,
        "wires": [
            [
                "2864c29a22c00778"
            ]
        ]
    },
    {
        "id": "3e31ed943218cbb2",
        "type": "debug",
        "z": "b880533a6a0c82df",
        "name": "debug 197",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1110,
        "y": 280,
        "wires": []
    },
    {
        "id": "2864c29a22c00778",
        "type": "split",
        "z": "b880533a6a0c82df",
        "name": "",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": "1",
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 750,
        "y": 200,
        "wires": [
            [
                "9e632a075ea0c64d",
                "6948c29cbe08466e"
            ]
        ]
    },
    {
        "id": "9e632a075ea0c64d",
        "type": "function",
        "z": "b880533a6a0c82df",
        "name": "function 117",
        "func": "// Assuming msg.payload contains a single line of text\nvar lines = msg.payload.split('\\n');\nvar data = [];\n\nvar company = '';\nvar address = '';\n\nlines.forEach(function (line) {\n    if (line.trim() === '') {\n        if (company !== '' && address !== '') {\n            var obj = {\n                Company: company,\n                Address: address\n            };\n            data.push(obj);\n\n            // Reset company and address for the next entry\n            company = '';\n            address = '';\n        }\n    } else if (line.includes('Contact Address:')) {\n        address = line.replace('Contact Address:', '').trim();\n    } else {\n        company = line.trim();\n    }\n});\n\n// Push the last entry if exists\nif (company !== '' && address !== '') {\n    var obj = {\n        Company: company,\n        Address: address\n    };\n    data.push(obj);\n}\n\nmsg.payload = data;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 910,
        "y": 200,
        "wires": [
            [
                "3e31ed943218cbb2"
            ]
        ]
    },
    {
        "id": "6948c29cbe08466e",
        "type": "debug",
        "z": "b880533a6a0c82df",
        "name": "debug 198",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 870,
        "y": 280,
        "wires": []
    },
    {
        "id": "21cea57f1fe74faa",
        "type": "inject",
        "z": "b880533a6a0c82df",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 240,
        "y": 500,
        "wires": [
            [
                "49abdc9759ddb961"
            ]
        ]
    },
    {
        "id": "49abdc9759ddb961",
        "type": "http request",
        "z": "b880533a6a0c82df",
        "name": "URL",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://solarlog.ezee-energy.de/server-statistic.html",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 390,
        "y": 500,
        "wires": [
            [
                "e563c9e66576542e"
            ]
        ]
    },
    {
        "id": "e563c9e66576542e",
        "type": "html",
        "z": "b880533a6a0c82df",
        "name": "",
        "property": "payload",
        "outproperty": "payload",
        "tag": "#tab1 > fieldset > div:nth-child(1) > div:nth-child(5)",
        "ret": "text",
        "as": "single",
        "x": 710,
        "y": 500,
        "wires": [
            [
                "24dbcaf149d206d6"
            ]
        ]
    },
    {
        "id": "24dbcaf149d206d6",
        "type": "debug",
        "z": "b880533a6a0c82df",
        "name": "debug 230",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1010,
        "y": 420,
        "wires": []
    },
    {
        "id": "d6d403539f055ac7",
        "type": "mqtt out",
        "z": "398f438ada7d94cc",
        "name": "",
        "topic": "AP-12-MQTT",
        "qos": "2",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "25287a352362ae63",
        "x": 1150,
        "y": 580,
        "wires": []
    },
    {
        "id": "8902cc317484927f",
        "type": "fs-ops-dir",
        "z": "398f438ada7d94cc",
        "name": "",
        "path": "/mnt/docker_common/scaback",
        "pathType": "str",
        "filter": "*",
        "filterType": "str",
        "dir": "payload",
        "dirType": "msg",
        "x": 260,
        "y": 460,
        "wires": [
            [
                "12b4b1b6d206c3f7"
            ]
        ]
    },
    {
        "id": "a6710ed5d852ca04",
        "type": "file in",
        "z": "398f438ada7d94cc",
        "name": "scaback",
        "filename": "filename",
        "filenameType": "msg",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 560,
        "y": 440,
        "wires": [
            [
                "fbf033d2e739901b"
            ]
        ]
    },
    {
        "id": "fbf033d2e739901b",
        "type": "csv",
        "z": "398f438ada7d94cc",
        "name": "",
        "sep": ",",
        "hdrin": true,
        "hdrout": "once",
        "multi": "mult",
        "ret": "\\n",
        "temp": "",
        "skip": "0",
        "strings": true,
        "include_empty_strings": "",
        "include_null_values": "",
        "x": 690,
        "y": 440,
        "wires": [
            [
                "28491e31f58279af"
            ]
        ]
    },
    {
        "id": "6cbdf6f678a4ec73",
        "type": "template",
        "z": "398f438ada7d94cc",
        "name": "",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "fields,unit\nA.Ms.Watt,kW\nAlimTemperature,DEGC\nAT,DEGC\nAT_15,DEGC\nAT_60,DEGC\nB.Ms.Watt,kW\nBATT,\nBR,V\nCosPhi,\nE-Total,kWh\nEA+,kWh\nEA-,kWh\nEAF+,kWh\nEAF-,kWh\nEP+,kWh\nEP-,kWh\nEQ+lag,kWh\nEQ+lead,kWh\nEQ-lag,kWh\nEQ-lead,kWh\nEQC+,kWh\nEQC-,kWh\nEQI+,kWh\nEQI-,kWh\nES+,kWh\nES-,kWh\nE_DAY,kWh\nE_Month,kWh\nE_partial,kWh\nE_Q,kWh\nE_S,kWh\nE_Total,kWh\nE_Total_G,kWh\nE_Total_RAW,kWh\nE_WEEK,kWh\nE_YEAR,kWh\nFAC,Hz\nFac-delta+,Hz\nFac-delta+Fast,Hz\nFac-delta-,Hz\nFac-delta-Fast,Hz\nFac-Limit,Hz\nFac-Max-Fast-Tm,s\nFac-Max-Tm,s\nFac-Min-Fast-Tm,s\nFac-Min-Tm,s\nFac-Srr,Hz\nFac-Start,Hz\nFAC1,Hz\nFAC2,Hz\nFAC3,Hz\nFactory-Test,\nFAC_10MW,Hz\nFAC_20MW,Hz\nFAC_2MW,Hz\nFAC_MV,Hz\nFanA1Speed,rpm\nFanA2Speed,rpm\nFanA3Speed,rpm\nFanB1Speed,rpm\nFanB2Speed,rpm\nFanB3Speed,rpm\nFanB4Speed,rpm\nFREQ,Hz\nFWDSECONDS,s\nh-on,h\nh-Total,h\nHeatsinkTemperature,DEGC\nIAC,A\nIac-Ist,A\nIac-Soll,A\nIAC1,A\nIAC1_avg5min,A\nIAC2,A\nIAC2_avg5min,A\nIAC3,A\nIAC3_avg5min,A\nIACN,A\nIAC_alarm,A\nIAC_avg5min,A\nIAC_mean,A\nIDC,A\nIDC01,A\nIDC02,A\nIDC03,A\nIDC04,A\nIDC05,A\nIDC06,A\nIDC07,A\nIDC08,A\nIDC09,A\nIDC10,A\nIDC11,A\nIDC12,A\nIDC13,A\nIDC14,A\nIDC15,A\nIDC16,A\nIDC1,A\nIDC1_Alarm,\nIDC1_Alrm,\nIDC1_avg1min,A\nIDC1_avg5min,A\nIDC1_max,A\nIDC2,A\nIDC2_Alarm,\nIDC2_Alrm,\nIDC2_avg1min,A\nIDC2_avg5min,A\nIDC2_max,A\nIDC3,A\nIDC3_Alarm,\nIDC3_Alrm,\nIDC3_avg1min,A\nIDC3_avg5min,A\nIDC4,A\nIDC4_Alarm,\nIDC4_Alrm,\nIDC4_avg1min,A\nIDC4_avg5min,A\nIDC5,A\nIDC5_Alarm,\nIDC5_Alrm,\nIDC5_avg1min,A\nIDC5_avg5min,A\nIDC6,A\nIDC6_Alarm,\nIDC6_Alrm,\nIDC6_avg1min,A\nIDC6_avg5min,A\nIDC7,A\nIDC8,A\nIDC9,A\nIDCTotal,A\nIDC_avg5min,A\nIDC_load,A\nIDC_now,A\nIDC_total_load,A\nIpv,A\nIscr_1,A\nIscr_15,A\nIscr_5,A\nIsc_1,A\nIsc_15,A\nIsc_5,A\nIX_hi,\nIX_lo,\nKVAH,kVAh\nMF_hi,\nMF_lo,\nOpHrs,h\nOpHrs_Day,h\nPAC,kW\nPAC1,kW\nPAC1_MV,kW\nPAC2,kW\nPAC2_MV,kW\nPAC3,kW\nPAC3_MV,kW\nPACA,kW\nPACB,kW\nPACC,kW\nPAC_10,kW\nPAC_avg5min,kW\nPAC_float,kW\nPAC_HIGH,kW\nPAC_IN1_R1,kW\nPAC_IN2_R1,kW\nPAC_LF_10MW,kW\nPAC_LF_20MW,kW\nPAC_LF_2MW,kW\nPAC_LOW,kW\nPAC_MAX,kW\nPAC_MAX_TIME,kW\nPAC_MIN,kW\nPAC_MV,kW\nPAC_OUT_R1,kW\nPAC_STF1_20MW,kW\nPAC_STF2_20MW,kW\nPDC,kW\nPDC1,kW\nPDC2,kW\nPDC3,kW\nPDC_avg5min,kW\nPF,\nPHI1,DEG\nPHI2,DEG\nPHI3,DEG\nPKT,kW\nPX_hi,\nPX_lo,\nQAC,kVAr\nRH,%\nRH_15,%\nRH_60,%\nRUN_HOUR,h\nRY,V\nSAC,kVA\nSac,kVA\nSoilingCalcState_1,\nSoilingCalcState_15,\nSoilingCalcState_5,\nSoilingLoss_1,%\nSoilingLoss_15,%\nSoilingLoss_5,%\nSR1,W/mSQUA\nSR1_15,W/mSQUA\nSR1_60,W/mSQUA\nSR2,W/mSQUA\nSR2_15,W/mSQUA\nSR2_60,W/mSQUA\nSUN_24,h\nSUN_60,h\nT1,DEGC\nT2,DEGC\nT3,DEGC\nT3_300,DEGC\nT3_900,DEGC\nT3_R,DEGC\nT4,DEGC\nTref_1,DEGC\nTref_15,DEGC\nTref_5,DEGC\nTsoil_1,DEGC\nTsoil_15,DEGC\nTsoil_5,DEGC\nTSP,DEGC\nTSP_15,DEGC\nTSP_24,DEGC\nTSP_60,DEGC\nU1,\nU1_300,W/mSQUA\nU1_900,W/mSQUA\nU1_R,W/mSQUA\nU2,V\nU2_300,V\nU2_900,V\nU2_R,V\nU3,V\nU4,V\nU4_300,W/mSQUA\nU4_900,W/mSQUA\nU4_R,W/mSQUA\nUAC,V\nUac-BFR-Fakt,\nUac-Max,V\nUac-Max-Fast,V\nUac-Max-Fast-Tm,V\nUac-Max-Tm,V\nUac-Min-Fast,V\nUac-Min,V\nUac-Min-Fast-Tm,s\nUac-Min-Tm,s\nUac-Srr,V\nUac-SRR-Fakt,V\nUAC1,V\nUAC2,V\nUAC3,V\nUAC12,V\nUAC23,V\nUAC31,V\nUAC_10MW,V\nUAC_20MW,V\nUAC_2MW,V\nUDC,V\nUDC1,V\nUDC2,V\nUDC3,V\nUDC4,V\nUDC_av5min,V\nUDC_avg5min,V\nUpv-Ist,\nVBulk+,V\nVBulk-,V\nVX_hi,\nVX_lo,\nWD,DEG\nWD_15,DEG\nWD_15_Sig,\nWD_60,DEG\nWD_60_Sig,\nWS,m/s\nWS_15,m/s\nWS_15_Max,m/s\nWS_60,m/s\nWS_60_Max,m/s\nYB,V\n\n",
        "output": "str",
        "x": 560,
        "y": 480,
        "wires": [
            [
                "85c2ac8d5c05a323"
            ]
        ]
    },
    {
        "id": "85c2ac8d5c05a323",
        "type": "csv",
        "z": "398f438ada7d94cc",
        "name": "",
        "sep": ",",
        "hdrin": true,
        "hdrout": "once",
        "multi": "mult",
        "ret": "\\n",
        "temp": "",
        "skip": "0",
        "strings": true,
        "include_empty_strings": "",
        "include_null_values": "",
        "x": 690,
        "y": 480,
        "wires": [
            [
                "a8c346d80bb067c3"
            ]
        ]
    },
    {
        "id": "28491e31f58279af",
        "type": "change",
        "z": "398f438ada7d94cc",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "scaback",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 830,
        "y": 440,
        "wires": [
            [
                "cb7c619a7b7beefa",
                "e4b7e534b686566f"
            ]
        ]
    },
    {
        "id": "a8c346d80bb067c3",
        "type": "change",
        "z": "398f438ada7d94cc",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "unit",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 830,
        "y": 480,
        "wires": [
            [
                "cb7c619a7b7beefa"
            ]
        ]
    },
    {
        "id": "cb7c619a7b7beefa",
        "type": "function",
        "z": "398f438ada7d94cc",
        "name": "combine",
        "func": "context.data = context.data || {};\nswitch (msg.topic) {\n    case \"scaback\":\n        context.data.scaback = msg.payload;\n        msg = null;\n        break;\n    case \"unit\":\n        context.data.unit = msg.payload;\n        msg = null;\n        break;\n}\nif (context.data.scaback != null && context.data.unit != null) {\n    var data_combine = {\n        \"scaback\": context.data.scaback,\n        \"unit\": context.data.unit\n\n    }\n    context.data = null\n    return { payload: data_combine };\n}  ",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 980,
        "y": 460,
        "wires": [
            [
                "c5392cf592eece42"
            ]
        ]
    },
    {
        "id": "ef5d9de027ce5860",
        "type": "comment",
        "z": "398f438ada7d94cc",
        "name": "Scaback Data Flow",
        "info": "",
        "x": 230,
        "y": 400,
        "wires": []
    },
    {
        "id": "12b4b1b6d206c3f7",
        "type": "function",
        "z": "398f438ada7d94cc",
        "name": "file to read",
        "func": "const delete_array = flow.get(\"delete_array\")\nvar send_file=msg.payload.filename\nfor (var i = 0; i < msg.payload.length; i++) {\n    for (var j = 0; j < delete_array.length; j++) {\n        if (msg.payload[i] != delete_array[j])\n        {\n          msg.filename = \"/mnt/docker_common/scaback/\" + msg.payload[i]\n          node.send(msg)\n       \n        }\n        return null\n    }\n    return null \n}\nreturn null",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 410,
        "y": 460,
        "wires": [
            [
                "90e6a7c4e8ad4dba",
                "a6710ed5d852ca04",
                "6cbdf6f678a4ec73"
            ]
        ]
    },
    {
        "id": "e79c041a5ced7a6a",
        "type": "tcp request",
        "z": "398f438ada7d94cc",
        "name": "influx status",
        "server": "iplon-pvindia.com",
        "port": "63800",
        "out": "sit",
        "ret": "buffer",
        "splitc": " ",
        "newline": "",
        "trim": false,
        "tls": "",
        "x": 290,
        "y": 280,
        "wires": [
            []
        ]
    },
    {
        "id": "3b038789f40969a1",
        "type": "inject",
        "z": "398f438ada7d94cc",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "0.1",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 110,
        "y": 280,
        "wires": [
            []
        ]
    },
    {
        "id": "c5392cf592eece42",
        "type": "function",
        "z": "398f438ada7d94cc",
        "name": "comparison",
        "func": "var status = flow.get(\"influx-status\")\nif (status.fill == 'green') {\n\n    var mqtt_status = flow.get(\"mqtt-status\")\n    if (mqtt_status.fill == 'green') {\n    var plantobj = []\n    for (var i = 0; i < msg.payload.scaback.length; i++) {\n        if ((msg.payload.scaback[i].value != \"NaN\") && (msg.payload.scaback[i].value != \"nan\") && (msg.payload.scaback[i].value != \"inf\") && (msg.payload.scaback[i].value != \"-inf\") ) {\n            var dateUTC1 = msg.payload.scaback[i].ts *1000//).toISOString().slice(0, 19);\n            var p = \"AP-12\"\n            var b;\n            var bd;\n            var d;\n            var dd;\n            var dt;\n            var f;\n            var fd;\n            var h = \"\"\n            var iid;\n            var value;\n            var text = \"\"\n            var qu = 0\n            var u;\n            for (var j = 0; j < msg.payload.unit.length; j++) {\n                var f_ref = msg.payload.unit[j].fields\n                b = msg.payload.scaback[i].blockname\n                d = msg.payload.scaback[i].dev\n                dd = b + \"_\" + d\n                f = msg.payload.scaback[i].chn\n                fd = msg.payload.scaback[i].chn\n                iid = msg.payload.scaback[i][\"#id\"]\n                value = msg.payload.scaback[i].value\n                if (b.match(\"B\")) { bd = b.replace(/B/g, \"BLOCK_\"); }\n                if (b.match(\"WS\")) { bd = \"WS\" } else { bd = b }\n                if (d.match(\"EM\")) { dt = \"EM\" }\n                if (d.match(\"INV\")) { dt = \"INV\" }\n                if (d.match(\"IO\")) { dt = \"IO\" }\n                if (d.match(\"WS\")) { dt = \"WS\" }\n                if (f == f_ref) { u = msg.payload.unit[j].unit; break; }\n                else { u = \"\" }\n\n            }\n            var obj = {\n                Time: dateUTC1,\n                value,\n                qu,\n                text,\n                b,\n                bd,\n                d,\n                dd,\n                dt,\n                f,\n                fd,\n                h,\n                iid,\n                m: 1,\n                p,\n                u\n            }\n            plantobj.push(obj)\n        }\n    }\n    msg.payload = plantobj\n    return msg;\n}\n}\nelse { return null; }",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1130,
        "y": 460,
        "wires": [
            [
                "d6d403539f055ac7",
                "49b13da4fd9d90f5"
            ]
        ]
    },
    {
        "id": "aecb6737c5b8a5a4",
        "type": "fs-ops-delete",
        "z": "398f438ada7d94cc",
        "name": "",
        "path": "/mnt/docker_common/scaback",
        "pathType": "str",
        "filename": "payload",
        "filenameType": "msg",
        "x": 1130,
        "y": 400,
        "wires": [
            [
                "aa1297fd7c344719"
            ]
        ]
    },
    {
        "id": "90e6a7c4e8ad4dba",
        "type": "debug",
        "z": "398f438ada7d94cc",
        "name": "debug 83",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 560,
        "y": 400,
        "wires": []
    },
    {
        "id": "777d006abfc50537",
        "type": "change",
        "z": "398f438ada7d94cc",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "delete_array",
                "pt": "flow",
                "to": "[\"scabackFast_1690871836559.csv.unsent\"]",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1240,
        "y": 280,
        "wires": [
            []
        ]
    },
    {
        "id": "286dd25f1ae5834d",
        "type": "inject",
        "z": "398f438ada7d94cc",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "60",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1050,
        "y": 280,
        "wires": [
            [
                "777d006abfc50537"
            ]
        ]
    },
    {
        "id": "31c67e144012567c",
        "type": "inject",
        "z": "398f438ada7d94cc",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "5",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 110,
        "y": 460,
        "wires": [
            []
        ]
    },
    {
        "id": "aa1297fd7c344719",
        "type": "function",
        "z": "398f438ada7d94cc",
        "name": "function 130",
        "func": "const delete_array = flow.get(\"delete_array\");\n\ndelete_array.push(msg.payload)\nflow.set(\"delete_array\", delete_array)\n\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1290,
        "y": 400,
        "wires": [
            []
        ]
    },
    {
        "id": "e4b7e534b686566f",
        "type": "function",
        "z": "398f438ada7d94cc",
        "name": "function",
        "func": "\nvar status = flow.get(\"influx-status\")\nif (status.fill == 'green') {\n\n    var mqtt_status = flow.get(\"mqtt-status\")\n    if (mqtt_status.fill == 'green') {\n\nconst str =msg.filename\nconst afterLastSlash = str.slice(str.lastIndexOf('/') + 1);\nconsole.log(afterLastSlash); \n\nmsg.payload = afterLastSlash\nreturn msg;\n}\n}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 980,
        "y": 400,
        "wires": [
            [
                "aecb6737c5b8a5a4"
            ]
        ]
    },
    {
        "id": "7923ba29562ca3b6",
        "type": "status",
        "z": "398f438ada7d94cc",
        "name": "",
        "scope": [
            "e79c041a5ced7a6a"
        ],
        "x": 440,
        "y": 280,
        "wires": [
            [
                "664c6ed49a16dd97"
            ]
        ]
    },
    {
        "id": "664c6ed49a16dd97",
        "type": "change",
        "z": "398f438ada7d94cc",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "influx-status",
                "pt": "flow",
                "to": "status",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 640,
        "y": 280,
        "wires": [
            []
        ]
    },
    {
        "id": "519a0ea8753ef499",
        "type": "catch",
        "z": "398f438ada7d94cc",
        "name": "",
        "scope": [
            "e79c041a5ced7a6a"
        ],
        "uncaught": false,
        "x": 850,
        "y": 280,
        "wires": [
            []
        ]
    },
    {
        "id": "229406a203df6479",
        "type": "comment",
        "z": "398f438ada7d94cc",
        "name": "influxdb status checking and flow setting",
        "info": "",
        "x": 310,
        "y": 220,
        "wires": []
    },
    {
        "id": "caf9c67f12dcf967",
        "type": "comment",
        "z": "398f438ada7d94cc",
        "name": "delete flow creation and deletion",
        "info": "",
        "x": 1090,
        "y": 240,
        "wires": []
    },
    {
        "id": "38f93d542cc977c4",
        "type": "comment",
        "z": "398f438ada7d94cc",
        "name": "file deletion after mqtt publish",
        "info": "",
        "x": 1040,
        "y": 360,
        "wires": []
    },
    {
        "id": "91a3e2923fae5b2c",
        "type": "status",
        "z": "398f438ada7d94cc",
        "name": "",
        "scope": [
            "bd2734836d3ef8a7"
        ],
        "x": 600,
        "y": 140,
        "wires": [
            [
                "b47e82d0f86a4284",
                "a3a2b022180df058"
            ]
        ]
    },
    {
        "id": "b47e82d0f86a4284",
        "type": "change",
        "z": "398f438ada7d94cc",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "mqtt-status",
                "pt": "flow",
                "to": "status",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 830,
        "y": 140,
        "wires": [
            []
        ]
    },
    {
        "id": "36b4500f2d662c3a",
        "type": "comment",
        "z": "398f438ada7d94cc",
        "name": "mqtt status checking and flow setting",
        "info": "",
        "x": 660,
        "y": 100,
        "wires": []
    },
    {
        "id": "bd2734836d3ef8a7",
        "type": "tcp request",
        "z": "398f438ada7d94cc",
        "name": "mqttstatus",
        "server": "iplon-pvindia.com",
        "port": "1883",
        "out": "sit",
        "ret": "buffer",
        "splitc": " ",
        "newline": "",
        "trim": false,
        "tls": "",
        "x": 830,
        "y": 180,
        "wires": [
            []
        ]
    },
    {
        "id": "59bbaa27a9bc67e8",
        "type": "inject",
        "z": "398f438ada7d94cc",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "0.1",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 650,
        "y": 180,
        "wires": [
            [
                "bd2734836d3ef8a7"
            ]
        ]
    },
    {
        "id": "49b13da4fd9d90f5",
        "type": "debug",
        "z": "398f438ada7d94cc",
        "name": "debug 87",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1020,
        "y": 640,
        "wires": []
    },
    {
        "id": "a3a2b022180df058",
        "type": "debug",
        "z": "398f438ada7d94cc",
        "name": "debug 252",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "status",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 910,
        "y": 80,
        "wires": []
    },
    {
        "id": "c32b402ea3f34b49",
        "type": "inject",
        "z": "7bf61b142c5e7182",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 160,
        "y": 80,
        "wires": [
            [
                "c67103dbc8c5189b"
            ]
        ]
    },
    {
        "id": "c67103dbc8c5189b",
        "type": "debug",
        "z": "7bf61b142c5e7182",
        "name": "debug 253",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 390,
        "y": 100,
        "wires": []
    }
]